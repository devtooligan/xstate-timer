{"version":3,"sources":["node_modules/xstate/es/_virtual/_tslib.js","node_modules/xstate/es/constants.js","node_modules/xstate/es/environment.js","node_modules/xstate/es/utils.js","node_modules/xstate/es/mapState.js","node_modules/xstate/es/types.js","node_modules/xstate/es/actionTypes.js","node_modules/xstate/es/actions.js","node_modules/xstate/es/stateUtils.js","node_modules/xstate/es/State.js","node_modules/xstate/es/serviceScope.js","node_modules/xstate/es/Actor.js","node_modules/xstate/es/invokeUtils.js","node_modules/xstate/es/StateNode.js","node_modules/xstate/es/Machine.js","node_modules/xstate/es/scheduler.js","node_modules/xstate/es/registry.js","node_modules/xstate/es/devTools.js","node_modules/xstate/es/interpreter.js","node_modules/xstate/es/match.js","node_modules/xstate/es/index.js","node_modules/xstate/lib/constants.js","node_modules/xstate/lib/environment.js","node_modules/xstate/lib/utils.js","node_modules/@xstate/inspect/es/index.js","../src/utils/errors.ts","../src/utils/common.ts","../src/types/types-internal.ts","../src/utils/plugins.ts","../src/core/scope.ts","../src/core/finalize.ts","../src/core/proxy.ts","../src/core/immerClass.ts","../src/core/current.ts","../src/plugins/es5.ts","../src/plugins/patches.ts","../src/plugins/mapset.ts","../src/plugins/all.ts","../src/immer.ts","../src/utils/env.ts","node_modules/@xstate/immer/lib/index.js","src/types.ts","src/TimerMachine.ts","src/XStateTimer.ts","src/index.ts","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__values","o","m","Symbol","iterator","next","value","done","__read","r","ar","push","error","__spread","concat","STATE_DELIMITER","EMPTY_ACTIVITY_MAP","DEFAULT_GUARD_TYPE","TARGETLESS_KEY","IS_PRODUCTION","keys","matchesState","parentStateId","childStateId","delimiter","parentStateValue","toStateValue","childStateValue","isString","every","key","getEventType","event","type","Error","toStatePath","stateId","isArray","toString","split","isStateLike","state","stateValue","pathToStateValue","statePath","marker","mapValues","collection","iteratee","result","collectionKeys","mapFilterValues","predicate","e_1","_a","_b","_c","item","e_1_1","return","path","props","object","e_2","props_1","props_1_1","prop","e_2_1","nestedPath","accessorProp","e_3","props_2","props_2_1","e_3_1","toStatePaths","flatten","map","subStateValue","subPath","array","toArrayStrict","toArray","undefined","mapContext","mapper","context","_event","e_5","isFunction","data","subMapper","e_5_1","isBuiltInEvent","eventType","test","isPromiseLike","Promise","then","partition","items","e_6","truthy","falsy","items_1","items_1_1","e_6_1","updateHistoryStates","hist","states","subHist","current","updateHistoryValue","updateContext","assignActions","warn","updatedContext","reduce","acc","assignAction","e_7","assignment","meta","action","partialUpdate","propAssignment","e_7_1","condition","message","console","args","Array","toGuard","guardMap","name","isObservable","subscribe","symbolObservable","observable","isMachine","uniqueId","currentId","toEventObject","payload","toSCXMLEvent","scxmlEvent","$$type","eventObject","toTransitionConfigArray","configLike","transitions","transitionLike","target","normalizeTarget","reportUnhandledExceptionOnInvocation","originalError","currentError","id","originalStackTrace","stack","stackTrace","evaluateGuard","machine","guard","guards","options","guardMeta","cond","condFn","toInvokeSource","src","mapState","stateMap","foundStateId","mappedStateId","ActionTypes","SpecialTargets","start","Start","stop","Stop","raise","Raise","send","Send","cancel","Cancel","nullEvent","NullEvent","Assign","after","After","doneState","DoneState","log","Log","init","Init","invoke","Invoke","errorExecution","ErrorExecution","errorPlatform","ErrorPlatform","ErrorCustom","update","Update","choose","Choose","pure","Pure","initEvent","getActionFunction","actionType","actionFunctionMap","toActionObject","actionObject","exec","defineProperty","enumerable","configurable","toActionObjects","actions","subAction","toActivityDefinition","to","Internal","raise$1","resolveRaise","send$1","delay","resolveSend","ctx","delaysMap","resolvedEvent","resolvedDelay","configDelay","resolvedTarget","sendParent","Parent","sendUpdate","respond","_","__","origin","defaultLogExpr","expr","label","log$1","resolveLog","sendId","cancel$1","activity","activityDef","assign$1","delayRef","idSuffix","doneInvoke","DoneInvoke","getActions","get","forwardTo","escalate","errorData","error$1","conds","resolveActions","currentState","currentContext","otherActions","resolvedActions","sendAction","delays","choose$1","chooseAction","matchedActions","find","resolved","pure$1","isLeafNode","stateNode","getChildren","getAllStateNodes","stateNodes","getConfiguration","prevStateNodes","e_4","_d","prevConfiguration","Set","prevAdjList","getAdjList","configuration","configuration_1","configuration_1_1","parent","has","add","adjList","configuration_2","configuration_2_1","forEach","sn","initialStateNodes","_e","_f","child","configuration_3","configuration_3_1","e_4_1","getValueFromAdj","baseNode","childStateNodes","childStateNode","csn","Map","configuration_4","configuration_4_1","set","getValue","rootNode","config","iterable","some","member","nextEvents","ownEvents","isInFinalState","stateValuesEqual","a","b","aKeys","bKeys","isState","bindActionToState","boundAction","State","_this","activities","events","_sessionid","historyValue","history","matches","bind","toStrings","children","from","create","inert","valueKeys","toJSON","jsonValues","serviceStack","provide","service","fn","pop","consume","createNullActor","unsubscribe","createInvocableActor","invokeDefinition","invokeSrc","serviceCreator","services","resolvedData","tempActor","createDeferredActor","entity","deferred","withContext","initialState","isActor","simpleSrc","toInvokeDefinition","invokeConfig","onDone","onError","invokeDef","NULL_EVENT","STATE_IDENTIFIER","WILDCARD","EMPTY_OBJECT","isStateId","str","createDefaultOptions","validateArrayifiedTransitions","hasNonLastUnguardedTarget","slice","transition","eventText","StateNode","order","__xstatenode","__cache","relativeValue","initialStateValue","on","candidates","delayedTransitions","idMap","_parent","_key","join","version","parallel","initial","stateConfig","dfs","_transient","always","strict","onEntry","entry","onExit","exit","doneData","invokeSource","_init","withConfig","definition","getDelayedTransitions","formatTransitions","getCandidates","eventName","transient","filter","sameEventType","afterConfig","mutateEntryExit","configTransition","resolvedTransition","isNaN","delayedTransition","formatTransition","getStateNodes","getStateNode","subStateKeys","subStateNodes","subStateKey","allSubStateNodes","subStateNode","handles","includes","resolveState","resolve","transitionLeafNode","transitionCompoundNode","_transition","transitionParallelNode","transitionMap","stateTransitions","enabledTransitions","st","willTransition","entryNodes","entrySet","exitSet","source","nextStateNodes","selectedTransition","candidate","stateIn","in","resolvedContext","isInState","getStateNodeById","guardPassed","err","allNextStateNodes","getRelativeStateNodes","isInternal","internal","reentryNodes","nodesFromChild","escapes","nodes","prevState","prevConfig","resolvedConfig","resolvedConfig_1","resolvedConfig_1_1","prevConfig_1","prevConfig_1_1","doneEvents","grandparent","parentNode","sort","entryStates","exitStates","entryActions","exitActions","resolvedStateValue","getResolvedPath","stateTransition","resolveTransition","resolveRaisedTransition","originalEvent","currentActions","unshift","actions_1","actions_1_1","start$1","stop$1","raisedEvents","nonRaisedActions","invokeActions","resolvedConfiguration","isDone","nextState","didUpdateContext","changed","maybeNextState","isTransient","raisedEvent","shift","stateKey","resolvedStateId","getStateNodeByPath","arrayStatePath","currentStateNode","stateIdentifier","getInitialState","historyConfig","relativeStateId","resolveHistory","initialStateNodePaths","initialPath","getFromRelativePath","relativePath","childStatePath","relativeStateValue","historyTarget","relativeChildPath","subHistoryValue","subStatePath","childStateIds","stateIds","e_8","event_1","e_8_1","resolveTarget","_target","isInternalTarget","targetStateNode","transitionConfig","normalizedTarget","e_9","onConfig","wildcardConfigs","strictTransitionConfigs_1","transitionConfigArray","eventlessConfig","doneConfig","String","settleTransitions","formattedTransitions","delayedTransitions_1","delayedTransitions_1_1","e_9_1","Machine","initialContext","resolvedInitialContext","createMachine","defaultOptions","deferEvents","Scheduler","processingEvent","queue","initialized","initialize","callback","schedule","process","flushEvents","task","clear","nextCallback","sessionIdIndex","registry","bookId","register","actor","free","delete","getDevTools","w","window","__xstate__","registerService","devTools","DEFAULT_SPAWN_OPTIONS","sync","autoForward","InterpreterStatus","Interpreter","scheduler","delayedEventsMap","listeners","contextListeners","stopListeners","doneListeners","eventListeners","sendListeners","_status","NotStarted","batch","Stopped","JSON","stringify","Running","forward","_state","sendTo","isParent","sessionId","resolvedOptions","clock","logger","resolvedId","_initialState","execute","actionsConfig","listener","_g","_h","_j","_k","contextListener","finalChildStateNode","_l","_m","onTransition","nextListenerOrObserver","completeListener","resolvedCompleteListener","complete","onEvent","onSend","onChange","onStop","off","resolvedState","attachDev","e_10","_o","_p","_q","clearTimeout","e_10_1","e_11","batchChanged","batchedActions","_loop_1","events_1","events_1_1","e_11_1","sender","nextEvent","e_12","e_12_1","defer","setTimeout","actionOrExec","spawnPromise","spawnCallback","spawnObservable","spawnMachine","spawnActivity","stopChild","removeChild","childId","spawn","spawnActor","childService","doneEvent","promise","canceled","response","errorEvent","handleError","unsubscribed","receivers","receive","callbackStop","newListener","receiver","subscription","implementation","dispose","spawnEffect","__REDUX_DEVTOOLS_EXTENSION__","devToolsOptions","connect","autoPause","stateSanitizer","features","jump","skip","global","ms","self","interpret","resolveSpawnOptions","nameOrOptions","isLazyEntity","interpreter","matchState","patterns","defaultValue","patterns_1","patterns_1_1","exports","serviceMap","createDevTools","serviceListeners","unregister","onRegister","inspectMachine","client","pendingConnection","connected","scxmlEventObject","parse","unload","disconnect","globalThis","defaultInspectorOptions","url","iframe","document","querySelector","inspect","resolvedIframe","targetWindow","inspectService","messageHandler","contentWindow","postMessage","addEventListener","open","originalSend","inspectSend","setAttribute","removeEventListener","die","errors","msg","isDraft","DRAFT_STATE","isDraftable","proto","getPrototypeOf","isPlainObject","DRAFTABLE","constructor","isMap","isSet","original","base_","each","obj","iter","enumerableOnly","getArchtype","ownKeys","index","thing","type_","propOrOldValue","is","x","y","hasMap","hasSet","latest","copy_","shallowCopy","base","descriptors","getOwnPropertyDescriptors","desc","writable","freeze","deep","isFrozen","dontMutateFrozenCollections","getPlugin","pluginKey","plugin","plugins","loadPlugin","getCurrentScope","currentScope","usePatchesInScope","scope","patchListener","patches_","inversePatches_","patchListener_","revokeScope","leaveScope","drafts_","revokeDraft","parent_","enterScope","immer","immer_","canAutoFreeze_","unfinalizedDrafts_","draft","revoke_","revoked_","processResult","baseDraft","isReplaced","useProxies_","willFinalizeES5_","modified_","finalize","maybeFreeze","generateReplacementPatches_","NOTHING","rootScope","childValue","finalizeProperty","scope_","finalized_","draft_","generatePatches_","parentState","targetObject","rootPath","res","assigned_","autoFreeze_","peek","getDescriptorFromProto","getOwnPropertyDescriptor","markChanged","prepareCopy","createProxy","proxyMap_","proxySet_","isManual_","traps","objectTraps","arrayTraps","Proxy","revocable","revoke","proxy","createProxyProxy","createES5Proxy_","currentImpl","copy","archType","hasChanges_","copyHelper","enableES5","proxyProperty","this","assertUnrevoked","markChangesSweep","drafts","hasArrayChanges","hasObjectChanges","baseValue","baseIsDraft","descriptor","createES5Draft","markChangesRecursively","min","Math","enablePatches","deepClonePatchValue","entries","cloned","clonePatchValueIfNeeded","ADD","applyPatches_","patches","patch","op","splice","basePath","inversePatches","assignedValue","origValue","generatePatchesFromAssigned","generateArrayPatches","generateSetPatches","rootState","replacement","enableMapSet","__extends","d","extendStatics","prepareMapCopy","prepareSetCopy","setPrototypeOf","__proto__","DraftMap","size","cb","thisArg","_value","values","iteratorSymbol","_this2","_this3","DraftSet","enableAllPlugins","castDraft","castImmutable","hasSymbol","hasProxies","Reflect","for","getOwnPropertyNames","_desc$get","readPropFromProto","deleteProperty","owner","parseInt","Immer","useProxies","setUseProxies","autoFreeze","setAutoFreeze","produce","produceWithPatches","recipe","defaultBase","hasError","arg1","arg2","ip","createDraft","finishDraft","applyPatches","applyPatchesImpl","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","generated","js","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","overlay","createErrorOverlay","body","appendChild","getElementById","remove","createElement","innerText","innerHTML","getParents","modules","parents","k","dep","Function","deps","cached","cache"],"mappings":"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MAAM,EAAEA,eATI;AAUZ8M,EAAAA,KAAK,EAAEA,cAVK;AAWZtL,EAAAA,IAAI,EAAEA,aAXM;AAYZyO,EAAAA,OAAO,EAAEA,gBAZG;AAaZoB,EAAAA,SAAS,EAAEA,kBAbC;AAcZC,EAAAA,QAAQ,EAAEA,iBAdE;AAeZvD,EAAAA,MAAM,EAAEA,eAfI;AAgBZE,EAAAA,IAAI,EAAEA;AAhBM,CAAd;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;;AACAlO,MAAM,CAAC2O,cAAP,CAAsB+e,OAAtB,EAA+B,YAA/B,EAA6C;AAAElsB,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAksB,OAAO,CAACrrB,aAAR,GAAwB,KAAK,CAA7B;AACAqrB,OAAO,CAACrrB,aAAR,GAAwB,kBAAyB,YAAjD;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACxlBA;;AACA;;AAZA,IAAItC,QAAQ,GAAI,UAAQ,SAAKA,QAAd,IAA2B,YAAY;AAClDA,EAAA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","file":"src.f10117fe.js","sourceRoot":"..","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n}\n\nexport { __assign, __read, __rest, __spread, __values };","var STATE_DELIMITER = '.';\nvar EMPTY_ACTIVITY_MAP = {};\nvar DEFAULT_GUARD_TYPE = 'xstate.guard';\nvar TARGETLESS_KEY = '';\nexport { DEFAULT_GUARD_TYPE, EMPTY_ACTIVITY_MAP, STATE_DELIMITER, TARGETLESS_KEY };","var IS_PRODUCTION = process.env.NODE_ENV === 'production';\nexport { IS_PRODUCTION };","import { __spread, __values, __read, __assign } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, TARGETLESS_KEY, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\n\nfunction keys(value) {\n  return Object.keys(value);\n}\n\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\n\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\n\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\n\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\n\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\n\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\n\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\n\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = __values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\n\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\n\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, __spread(array));\n}\n\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\n\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\n\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = __values(Object.keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\n\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\n\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = __read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\n\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\n\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\n\nfunction updateContext(context, _event, assignActions, state) {\n  if (!IS_PRODUCTION) {\n    warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = __values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\n\nvar warn = function () {};\n\nif (!IS_PRODUCTION) {\n  warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\n\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\n\nvar symbolObservable = /*#__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar uniqueId = /*#__PURE__*/function () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\n\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return __assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\n\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return __assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\n\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return __assign(__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\n\nfunction normalizeTarget(target) {\n  if (target === undefined || target === TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\n\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\n\nfunction evaluateGuard(machine, guard, context, _event, state) {\n  var guards = machine.options.guards;\n  var guardMeta = {\n    state: state,\n    cond: guard,\n    _event: _event\n  }; // TODO: do not hardcode!\n\n  if (guard.type === DEFAULT_GUARD_TYPE) {\n    return guard.predicate(context, _event.data, guardMeta);\n  }\n\n  var condFn = guards[guard.type];\n\n  if (!condFn) {\n    throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + machine.id + \"'.\");\n  }\n\n  return condFn(context, _event.data, guardMeta);\n}\n\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    return {\n      type: src\n    };\n  }\n\n  return src;\n}\n\nexport { evaluateGuard, flatten, getEventType, isArray, isBuiltInEvent, isFunction, isMachine, isObservable, isPromiseLike, isStateLike, isString, keys, mapContext, mapFilterValues, mapValues, matchesState, nestedPath, normalizeTarget, partition, path, pathToStateValue, reportUnhandledExceptionOnInvocation, symbolObservable, toArray, toArrayStrict, toEventObject, toGuard, toInvokeSource, toSCXMLEvent, toStatePath, toStatePaths, toStateValue, toTransitionConfigArray, uniqueId, updateContext, updateHistoryStates, updateHistoryValue, warn };","import { __values } from './_virtual/_tslib.js';\nimport { keys, matchesState } from './utils.js';\n\nfunction mapState(stateMap, stateId) {\n  var e_1, _a;\n\n  var foundStateId;\n\n  try {\n    for (var _b = __values(keys(stateMap)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var mappedStateId = _c.value;\n\n      if (matchesState(mappedStateId, stateId) && (!foundStateId || stateId.length > foundStateId.length)) {\n        foundStateId = mappedStateId;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return stateMap[foundStateId];\n}\n\nexport { mapState };","var ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[\"Start\"] = \"xstate.start\";\n  ActionTypes[\"Stop\"] = \"xstate.stop\";\n  ActionTypes[\"Raise\"] = \"xstate.raise\";\n  ActionTypes[\"Send\"] = \"xstate.send\";\n  ActionTypes[\"Cancel\"] = \"xstate.cancel\";\n  ActionTypes[\"NullEvent\"] = \"\";\n  ActionTypes[\"Assign\"] = \"xstate.assign\";\n  ActionTypes[\"After\"] = \"xstate.after\";\n  ActionTypes[\"DoneState\"] = \"done.state\";\n  ActionTypes[\"DoneInvoke\"] = \"done.invoke\";\n  ActionTypes[\"Log\"] = \"xstate.log\";\n  ActionTypes[\"Init\"] = \"xstate.init\";\n  ActionTypes[\"Invoke\"] = \"xstate.invoke\";\n  ActionTypes[\"ErrorExecution\"] = \"error.execution\";\n  ActionTypes[\"ErrorCommunication\"] = \"error.communication\";\n  ActionTypes[\"ErrorPlatform\"] = \"error.platform\";\n  ActionTypes[\"ErrorCustom\"] = \"xstate.error\";\n  ActionTypes[\"Update\"] = \"xstate.update\";\n  ActionTypes[\"Pure\"] = \"xstate.pure\";\n  ActionTypes[\"Choose\"] = \"xstate.choose\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar SpecialTargets;\n\n(function (SpecialTargets) {\n  SpecialTargets[\"Parent\"] = \"#_parent\";\n  SpecialTargets[\"Internal\"] = \"#_internal\";\n})(SpecialTargets || (SpecialTargets = {}));\n\nexport { ActionTypes, SpecialTargets };","import { ActionTypes } from './types.js'; // xstate-specific action types\n\nvar start = ActionTypes.Start;\nvar stop = ActionTypes.Stop;\nvar raise = ActionTypes.Raise;\nvar send = ActionTypes.Send;\nvar cancel = ActionTypes.Cancel;\nvar nullEvent = ActionTypes.NullEvent;\nvar assign = ActionTypes.Assign;\nvar after = ActionTypes.After;\nvar doneState = ActionTypes.DoneState;\nvar log = ActionTypes.Log;\nvar init = ActionTypes.Init;\nvar invoke = ActionTypes.Invoke;\nvar errorExecution = ActionTypes.ErrorExecution;\nvar errorPlatform = ActionTypes.ErrorPlatform;\nvar error = ActionTypes.ErrorCustom;\nvar update = ActionTypes.Update;\nvar choose = ActionTypes.Choose;\nvar pure = ActionTypes.Pure;\nexport { after, assign, cancel, choose, doneState, error, errorExecution, errorPlatform, init, invoke, log, nullEvent, pure, raise, send, start, stop, update };","import { __assign, __read } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { toSCXMLEvent, isFunction, toEventObject, getEventType, isString, partition, updateContext, flatten, toArray, toGuard, evaluateGuard, warn, isArray } from './utils.js';\nimport { SpecialTargets, ActionTypes } from './types.js';\nimport { send as send$1, update, assign as assign$1, init, raise as raise$1, log as log$1, cancel as cancel$1, error as error$1, pure as pure$1, choose as choose$1 } from './actionTypes.js';\nvar initEvent = /*#__PURE__*/toSCXMLEvent({\n  type: init\n});\n\nfunction getActionFunction(actionType, actionFunctionMap) {\n  return actionFunctionMap ? actionFunctionMap[actionType] || undefined : undefined;\n}\n\nfunction toActionObject(action, actionFunctionMap) {\n  var actionObject;\n\n  if (isString(action) || typeof action === 'number') {\n    var exec = getActionFunction(action, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = {\n        type: action,\n        exec: exec\n      };\n    } else if (exec) {\n      actionObject = exec;\n    } else {\n      actionObject = {\n        type: action,\n        exec: undefined\n      };\n    }\n  } else if (isFunction(action)) {\n    actionObject = {\n      // Convert action to string if unnamed\n      type: action.name || action.toString(),\n      exec: action\n    };\n  } else {\n    var exec = getActionFunction(action.type, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = __assign(__assign({}, action), {\n        exec: exec\n      });\n    } else if (exec) {\n      var actionType = exec.type || action.type;\n      actionObject = __assign(__assign(__assign({}, exec), action), {\n        type: actionType\n      });\n    } else {\n      actionObject = action;\n    }\n  }\n\n  Object.defineProperty(actionObject, 'toString', {\n    value: function () {\n      return actionObject.type;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return actionObject;\n}\n\nvar toActionObjects = function (action, actionFunctionMap) {\n  if (!action) {\n    return [];\n  }\n\n  var actions = isArray(action) ? action : [action];\n  return actions.map(function (subAction) {\n    return toActionObject(subAction, actionFunctionMap);\n  });\n};\n\nfunction toActivityDefinition(action) {\n  var actionObject = toActionObject(action);\n  return __assign(__assign({\n    id: isString(action) ? action : actionObject.id\n  }, actionObject), {\n    type: actionObject.type\n  });\n}\n/**\r\n * Raises an event. This places the event in the internal event queue, so that\r\n * the event is immediately consumed by the machine in the current step.\r\n *\r\n * @param eventType The event to raise.\r\n */\n\n\nfunction raise(event) {\n  if (!isString(event)) {\n    return send(event, {\n      to: SpecialTargets.Internal\n    });\n  }\n\n  return {\n    type: raise$1,\n    event: event\n  };\n}\n\nfunction resolveRaise(action) {\n  return {\n    type: raise$1,\n    _event: toSCXMLEvent(action.event)\n  };\n}\n/**\r\n * Sends an event. This returns an action that will be read by an interpreter to\r\n * send the event in the next step, after the current step is finished executing.\r\n *\r\n * @param event The event to send.\r\n * @param options Options to pass into the send event:\r\n *  - `id` - The unique send event identifier (used with `cancel()`).\r\n *  - `delay` - The number of milliseconds to delay the sending of the event.\r\n *  - `to` - The target of this event (by default, the machine the event was sent from).\r\n */\n\n\nfunction send(event, options) {\n  return {\n    to: options ? options.to : undefined,\n    type: send$1,\n    event: isFunction(event) ? event : toEventObject(event),\n    delay: options ? options.delay : undefined,\n    id: options && options.id !== undefined ? options.id : isFunction(event) ? event.name : getEventType(event)\n  };\n}\n\nfunction resolveSend(action, ctx, _event, delaysMap) {\n  var meta = {\n    _event: _event\n  }; // TODO: helper function for resolving Expr\n\n  var resolvedEvent = toSCXMLEvent(isFunction(action.event) ? action.event(ctx, _event.data, meta) : action.event);\n  var resolvedDelay;\n\n  if (isString(action.delay)) {\n    var configDelay = delaysMap && delaysMap[action.delay];\n    resolvedDelay = isFunction(configDelay) ? configDelay(ctx, _event.data, meta) : configDelay;\n  } else {\n    resolvedDelay = isFunction(action.delay) ? action.delay(ctx, _event.data, meta) : action.delay;\n  }\n\n  var resolvedTarget = isFunction(action.to) ? action.to(ctx, _event.data, meta) : action.to;\n  return __assign(__assign({}, action), {\n    to: resolvedTarget,\n    _event: resolvedEvent,\n    event: resolvedEvent.data,\n    delay: resolvedDelay\n  });\n}\n/**\r\n * Sends an event to this machine's parent.\r\n *\r\n * @param event The event to send to the parent machine.\r\n * @param options Options to pass into the send event.\r\n */\n\n\nfunction sendParent(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n/**\r\n * Sends an update event to this machine's parent.\r\n */\n\n\nfunction sendUpdate() {\n  return sendParent(update);\n}\n/**\r\n * Sends an event back to the sender of the original event.\r\n *\r\n * @param event The event to send back to the sender\r\n * @param options Options to pass into the send event\r\n */\n\n\nfunction respond(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: function (_, __, _a) {\n      var _event = _a._event;\n      return _event.origin; // TODO: handle when _event.origin is undefined\n    }\n  }));\n}\n\nvar defaultLogExpr = function (context, event) {\n  return {\n    context: context,\n    event: event\n  };\n};\n/**\r\n *\r\n * @param expr The expression function to evaluate which will be logged.\r\n *  Takes in 2 arguments:\r\n *  - `ctx` - the current state context\r\n *  - `event` - the event that caused this action to be executed.\r\n * @param label The label to give to the logged expression.\r\n */\n\n\nfunction log(expr, label) {\n  if (expr === void 0) {\n    expr = defaultLogExpr;\n  }\n\n  return {\n    type: log$1,\n    label: label,\n    expr: expr\n  };\n}\n\nvar resolveLog = function (action, ctx, _event) {\n  return __assign(__assign({}, action), {\n    value: isString(action.expr) ? action.expr : action.expr(ctx, _event.data, {\n      _event: _event\n    })\n  });\n};\n/**\r\n * Cancels an in-flight `send(...)` action. A canceled sent action will not\r\n * be executed, nor will its event be sent, unless it has already been sent\r\n * (e.g., if `cancel(...)` is called after the `send(...)` action's `delay`).\r\n *\r\n * @param sendId The `id` of the `send(...)` action to cancel.\r\n */\n\n\nvar cancel = function (sendId) {\n  return {\n    type: cancel$1,\n    sendId: sendId\n  };\n};\n/**\r\n * Starts an activity.\r\n *\r\n * @param activity The activity to start.\r\n */\n\n\nfunction start(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Start,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Stops an activity.\r\n *\r\n * @param activity The activity to stop.\r\n */\n\n\nfunction stop(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Stop,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Updates the current context of the machine.\r\n *\r\n * @param assignment An object that represents the partial context to update.\r\n */\n\n\nvar assign = function (assignment) {\n  return {\n    type: assign$1,\n    assignment: assignment\n  };\n};\n/**\r\n * Returns an event type that represents an implicit event that\r\n * is sent after the specified `delay`.\r\n *\r\n * @param delayRef The delay in milliseconds\r\n * @param id The state node ID where this event is handled\r\n */\n\n\nfunction after(delayRef, id) {\n  var idSuffix = id ? \"#\" + id : '';\n  return ActionTypes.After + \"(\" + delayRef + \")\" + idSuffix;\n}\n/**\r\n * Returns an event that represents that a final state node\r\n * has been reached in the parent state node.\r\n *\r\n * @param id The final state node's parent state node `id`\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction done(id, data) {\n  var type = ActionTypes.DoneState + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Returns an event that represents that an invoked service has terminated.\r\n *\r\n * An invoked service is terminated when it has reached a top-level final state node,\r\n * but not when it is canceled.\r\n *\r\n * @param id The final state node ID\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction doneInvoke(id, data) {\n  var type = ActionTypes.DoneInvoke + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction error(id, data) {\n  var type = ActionTypes.ErrorPlatform + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction pure(getActions) {\n  return {\n    type: ActionTypes.Pure,\n    get: getActions\n  };\n}\n/**\r\n * Forwards (sends) an event to a specified service.\r\n *\r\n * @param target The target service to forward the event to.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction forwardTo(target, options) {\n  return send(function (_, event) {\n    return event;\n  }, __assign(__assign({}, options), {\n    to: target\n  }));\n}\n/**\r\n * Escalates an error by sending it as an event to this machine's parent.\r\n *\r\n * @param errorData The error data to send, or the expression function that\r\n * takes in the `context`, `event`, and `meta`, and returns the error data to send.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction escalate(errorData, options) {\n  return sendParent(function (context, event, meta) {\n    return {\n      type: error$1,\n      data: isFunction(errorData) ? errorData(context, event, meta) : errorData\n    };\n  }, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n\nfunction choose(conds) {\n  return {\n    type: ActionTypes.Choose,\n    conds: conds\n  };\n}\n\nfunction resolveActions(machine, currentState, currentContext, _event, actions) {\n  var _a = __read(partition(actions, function (action) {\n    return action.type === assign$1;\n  }), 2),\n      assignActions = _a[0],\n      otherActions = _a[1];\n\n  var updatedContext = assignActions.length ? updateContext(currentContext, _event, assignActions, currentState) : currentContext;\n  var resolvedActions = flatten(otherActions.map(function (actionObject) {\n    var _a;\n\n    switch (actionObject.type) {\n      case raise$1:\n        return resolveRaise(actionObject);\n\n      case send$1:\n        var sendAction = resolveSend(actionObject, updatedContext, _event, machine.options.delays); // TODO: fix ActionTypes.Init\n\n        if (!IS_PRODUCTION) {\n          // warn after resolving as we can create better contextual message here\n          warn(!isString(actionObject.delay) || typeof sendAction.delay === 'number', // tslint:disable-next-line:max-line-length\n          \"No delay reference for delay expression '\" + actionObject.delay + \"' was found on machine '\" + machine.id + \"'\");\n        }\n\n        return sendAction;\n\n      case log$1:\n        return resolveLog(actionObject, updatedContext, _event);\n\n      case choose$1:\n        {\n          var chooseAction = actionObject;\n          var matchedActions = (_a = chooseAction.conds.find(function (condition) {\n            var guard = toGuard(condition.cond, machine.options.guards);\n            return !guard || evaluateGuard(machine, guard, updatedContext, _event, currentState);\n          })) === null || _a === void 0 ? void 0 : _a.actions;\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var resolved = resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions), machine.options.actions));\n          updatedContext = resolved[1];\n          return resolved[0];\n        }\n\n      case pure$1:\n        {\n          var matchedActions = actionObject.get(updatedContext, _event.data);\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var resolved = resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions), machine.options.actions));\n          updatedContext = resolved[1];\n          return resolved[0];\n        }\n\n      default:\n        return toActionObject(actionObject, machine.options.actions);\n    }\n  }));\n  return [resolvedActions, updatedContext];\n}\n\nexport { after, assign, cancel, choose, done, doneInvoke, error, escalate, forwardTo, getActionFunction, initEvent, log, pure, raise, resolveActions, resolveLog, resolveRaise, resolveSend, respond, send, sendParent, sendUpdate, start, stop, toActionObject, toActionObjects, toActivityDefinition };","import { __values, __spread } from './_virtual/_tslib.js';\nimport { keys, flatten } from './utils.js';\n\nvar isLeafNode = function (stateNode) {\n  return stateNode.type === 'atomic' || stateNode.type === 'final';\n};\n\nfunction getChildren(stateNode) {\n  return keys(stateNode.states).map(function (key) {\n    return stateNode.states[key];\n  });\n}\n\nfunction getAllStateNodes(stateNode) {\n  var stateNodes = [stateNode];\n\n  if (isLeafNode(stateNode)) {\n    return stateNodes;\n  }\n\n  return stateNodes.concat(flatten(getChildren(stateNode).map(getAllStateNodes)));\n}\n\nfunction getConfiguration(prevStateNodes, stateNodes) {\n  var e_1, _a, e_2, _b, e_3, _c, e_4, _d;\n\n  var prevConfiguration = new Set(prevStateNodes);\n  var prevAdjList = getAdjList(prevConfiguration);\n  var configuration = new Set(stateNodes);\n\n  try {\n    // add all ancestors\n    for (var configuration_1 = __values(configuration), configuration_1_1 = configuration_1.next(); !configuration_1_1.done; configuration_1_1 = configuration_1.next()) {\n      var s = configuration_1_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (configuration_1_1 && !configuration_1_1.done && (_a = configuration_1.return)) _a.call(configuration_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  var adjList = getAdjList(configuration);\n\n  try {\n    // add descendants\n    for (var configuration_2 = __values(configuration), configuration_2_1 = configuration_2.next(); !configuration_2_1.done; configuration_2_1 = configuration_2.next()) {\n      var s = configuration_2_1.value; // if previously active, add existing child nodes\n\n      if (s.type === 'compound' && (!adjList.get(s) || !adjList.get(s).length)) {\n        if (prevAdjList.get(s)) {\n          prevAdjList.get(s).forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        } else {\n          s.initialStateNodes.forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        }\n      } else {\n        if (s.type === 'parallel') {\n          try {\n            for (var _e = (e_3 = void 0, __values(getChildren(s))), _f = _e.next(); !_f.done; _f = _e.next()) {\n              var child = _f.value;\n\n              if (child.type === 'history') {\n                continue;\n              }\n\n              if (!configuration.has(child)) {\n                configuration.add(child);\n\n                if (prevAdjList.get(child)) {\n                  prevAdjList.get(child).forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                } else {\n                  child.initialStateNodes.forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                }\n              }\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_f && !_f.done && (_c = _e.return)) _c.call(_e);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n        }\n      }\n    }\n  } catch (e_2_1) {\n    e_2 = {\n      error: e_2_1\n    };\n  } finally {\n    try {\n      if (configuration_2_1 && !configuration_2_1.done && (_b = configuration_2.return)) _b.call(configuration_2);\n    } finally {\n      if (e_2) throw e_2.error;\n    }\n  }\n\n  try {\n    // add all ancestors\n    for (var configuration_3 = __values(configuration), configuration_3_1 = configuration_3.next(); !configuration_3_1.done; configuration_3_1 = configuration_3.next()) {\n      var s = configuration_3_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_4_1) {\n    e_4 = {\n      error: e_4_1\n    };\n  } finally {\n    try {\n      if (configuration_3_1 && !configuration_3_1.done && (_d = configuration_3.return)) _d.call(configuration_3);\n    } finally {\n      if (e_4) throw e_4.error;\n    }\n  }\n\n  return configuration;\n}\n\nfunction getValueFromAdj(baseNode, adjList) {\n  var childStateNodes = adjList.get(baseNode);\n\n  if (!childStateNodes) {\n    return {}; // todo: fix?\n  }\n\n  if (baseNode.type === 'compound') {\n    var childStateNode = childStateNodes[0];\n\n    if (childStateNode) {\n      if (isLeafNode(childStateNode)) {\n        return childStateNode.key;\n      }\n    } else {\n      return {};\n    }\n  }\n\n  var stateValue = {};\n  childStateNodes.forEach(function (csn) {\n    stateValue[csn.key] = getValueFromAdj(csn, adjList);\n  });\n  return stateValue;\n}\n\nfunction getAdjList(configuration) {\n  var e_5, _a;\n\n  var adjList = new Map();\n\n  try {\n    for (var configuration_4 = __values(configuration), configuration_4_1 = configuration_4.next(); !configuration_4_1.done; configuration_4_1 = configuration_4.next()) {\n      var s = configuration_4_1.value;\n\n      if (!adjList.has(s)) {\n        adjList.set(s, []);\n      }\n\n      if (s.parent) {\n        if (!adjList.has(s.parent)) {\n          adjList.set(s.parent, []);\n        }\n\n        adjList.get(s.parent).push(s);\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (configuration_4_1 && !configuration_4_1.done && (_a = configuration_4.return)) _a.call(configuration_4);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return adjList;\n}\n\nfunction getValue(rootNode, configuration) {\n  var config = getConfiguration([rootNode], configuration);\n  return getValueFromAdj(rootNode, getAdjList(config));\n}\n\nfunction has(iterable, item) {\n  if (Array.isArray(iterable)) {\n    return iterable.some(function (member) {\n      return member === item;\n    });\n  }\n\n  if (iterable instanceof Set) {\n    return iterable.has(item);\n  }\n\n  return false; // TODO: fix\n}\n\nfunction nextEvents(configuration) {\n  return flatten(__spread(new Set(configuration.map(function (sn) {\n    return sn.ownEvents;\n  }))));\n}\n\nfunction isInFinalState(configuration, stateNode) {\n  if (stateNode.type === 'compound') {\n    return getChildren(stateNode).some(function (s) {\n      return s.type === 'final' && has(configuration, s);\n    });\n  }\n\n  if (stateNode.type === 'parallel') {\n    return getChildren(stateNode).every(function (sn) {\n      return isInFinalState(configuration, sn);\n    });\n  }\n\n  return false;\n}\n\nexport { getAdjList, getAllStateNodes, getChildren, getConfiguration, getValue, has, isInFinalState, isLeafNode, nextEvents };","import { __spread, __rest, __assign } from './_virtual/_tslib.js';\nimport { EMPTY_ACTIVITY_MAP } from './constants.js';\nimport { isString, matchesState, keys } from './utils.js';\nimport { nextEvents } from './stateUtils.js';\nimport { initEvent } from './actions.js';\n\nfunction stateValuesEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a === undefined || b === undefined) {\n    return false;\n  }\n\n  if (isString(a) || isString(b)) {\n    return a === b;\n  }\n\n  var aKeys = keys(a);\n  var bKeys = keys(b);\n  return aKeys.length === bKeys.length && aKeys.every(function (key) {\n    return stateValuesEqual(a[key], b[key]);\n  });\n}\n\nfunction isState(state) {\n  if (isString(state)) {\n    return false;\n  }\n\n  return 'value' in state && 'history' in state;\n}\n\nfunction bindActionToState(action, state) {\n  var exec = action.exec;\n\n  var boundAction = __assign(__assign({}, action), {\n    exec: exec !== undefined ? function () {\n      return exec(state.context, state.event, {\n        action: action,\n        state: state,\n        _event: state._event\n      });\n    } : undefined\n  });\n\n  return boundAction;\n}\n\nvar State =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new State instance.\r\n   * @param value The state value\r\n   * @param context The extended state\r\n   * @param historyValue The tree representing historical values of the state nodes\r\n   * @param history The previous state\r\n   * @param actions An array of action objects to execute as side-effects\r\n   * @param activities A mapping of activities and whether they are started (`true`) or stopped (`false`).\r\n   * @param meta\r\n   * @param events Internal event queue. Should be empty with run-to-completion semantics.\r\n   * @param configuration\r\n   */\n  function State(config) {\n    var _this = this;\n\n    this.actions = [];\n    this.activities = EMPTY_ACTIVITY_MAP;\n    this.meta = {};\n    this.events = [];\n    this.value = config.value;\n    this.context = config.context;\n    this._event = config._event;\n    this._sessionid = config._sessionid;\n    this.event = this._event.data;\n    this.historyValue = config.historyValue;\n    this.history = config.history;\n    this.actions = config.actions || [];\n    this.activities = config.activities || EMPTY_ACTIVITY_MAP;\n    this.meta = config.meta || {};\n    this.events = config.events || [];\n    this.matches = this.matches.bind(this);\n    this.toStrings = this.toStrings.bind(this);\n    this.configuration = config.configuration;\n    this.transitions = config.transitions;\n    this.children = config.children;\n    this.done = !!config.done;\n    Object.defineProperty(this, 'nextEvents', {\n      get: function () {\n        return nextEvents(_this.configuration);\n      }\n    });\n  }\n  /**\r\n   * Creates a new State instance for the given `stateValue` and `context`.\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.from = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (stateValue.context !== context) {\n        return new State({\n          value: stateValue.value,\n          context: context,\n          _event: stateValue._event,\n          _sessionid: null,\n          historyValue: stateValue.historyValue,\n          history: stateValue.history,\n          actions: [],\n          activities: stateValue.activities,\n          meta: {},\n          events: [],\n          configuration: [],\n          transitions: [],\n          children: {}\n        });\n      }\n\n      return stateValue;\n    }\n\n    var _event = initEvent;\n    return new State({\n      value: stateValue,\n      context: context,\n      _event: _event,\n      _sessionid: null,\n      historyValue: undefined,\n      history: undefined,\n      actions: [],\n      activities: undefined,\n      meta: undefined,\n      events: [],\n      configuration: [],\n      transitions: [],\n      children: {}\n    });\n  };\n  /**\r\n   * Creates a new State instance for the given `config`.\r\n   * @param config The state config\r\n   */\n\n\n  State.create = function (config) {\n    return new State(config);\n  };\n  /**\r\n   * Creates a new `State` instance for the given `stateValue` and `context` with no actions (side-effects).\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.inert = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (!stateValue.actions.length) {\n        return stateValue;\n      }\n\n      var _event = initEvent;\n      return new State({\n        value: stateValue.value,\n        context: context,\n        _event: _event,\n        _sessionid: null,\n        historyValue: stateValue.historyValue,\n        history: stateValue.history,\n        activities: stateValue.activities,\n        configuration: stateValue.configuration,\n        transitions: [],\n        children: {}\n      });\n    }\n\n    return State.from(stateValue, context);\n  };\n  /**\r\n   * Returns an array of all the string leaf state node paths.\r\n   * @param stateValue\r\n   * @param delimiter The character(s) that separate each subpath in the string state node path.\r\n   */\n\n\n  State.prototype.toStrings = function (stateValue, delimiter) {\n    var _this = this;\n\n    if (stateValue === void 0) {\n      stateValue = this.value;\n    }\n\n    if (delimiter === void 0) {\n      delimiter = '.';\n    }\n\n    if (isString(stateValue)) {\n      return [stateValue];\n    }\n\n    var valueKeys = keys(stateValue);\n    return valueKeys.concat.apply(valueKeys, __spread(valueKeys.map(function (key) {\n      return _this.toStrings(stateValue[key], delimiter).map(function (s) {\n        return key + delimiter + s;\n      });\n    })));\n  };\n\n  State.prototype.toJSON = function () {\n    var _a = this,\n        configuration = _a.configuration,\n        transitions = _a.transitions,\n        jsonValues = __rest(_a, [\"configuration\", \"transitions\"]);\n\n    return jsonValues;\n  };\n  /**\r\n   * Whether the current state value is a subset of the given parent state value.\r\n   * @param parentStateValue\r\n   */\n\n\n  State.prototype.matches = function (parentStateValue) {\n    return matchesState(parentStateValue, this.value);\n  };\n\n  return State;\n}();\n\nexport { State, bindActionToState, isState, stateValuesEqual };","/**\r\n * Maintains a stack of the current service in scope.\r\n * This is used to provide the correct service to spawn().\r\n */\nvar serviceStack = [];\n\nvar provide = function (service, fn) {\n  serviceStack.push(service);\n  var result = fn(service);\n  serviceStack.pop();\n  return result;\n};\n\nvar consume = function (fn) {\n  return fn(serviceStack[serviceStack.length - 1]);\n};\n\nexport { consume, provide };","import { toInvokeSource, mapContext, isMachine } from './utils.js';\nimport { provide } from './serviceScope.js';\n\nfunction createNullActor(id) {\n  return {\n    id: id,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    },\n    toJSON: function () {\n      return {\n        id: id\n      };\n    }\n  };\n}\n/**\r\n * Creates a deferred actor that is able to be invoked given the provided\r\n * invocation information in its `.meta` value.\r\n *\r\n * @param invokeDefinition The meta information needed to invoke the actor.\r\n */\n\n\nfunction createInvocableActor(invokeDefinition, machine, context, _event) {\n  var _a;\n\n  var invokeSrc = toInvokeSource(invokeDefinition.src);\n  var serviceCreator = (_a = machine === null || machine === void 0 ? void 0 : machine.options.services) === null || _a === void 0 ? void 0 : _a[invokeSrc.type];\n  var resolvedData = invokeDefinition.data ? mapContext(invokeDefinition.data, context, _event) : undefined;\n  var tempActor = serviceCreator ? createDeferredActor(serviceCreator, invokeDefinition.id, resolvedData) : createNullActor(invokeDefinition.id);\n  tempActor.meta = invokeDefinition;\n  return tempActor;\n}\n\nfunction createDeferredActor(entity, id, data) {\n  var tempActor = createNullActor(id);\n  tempActor.deferred = true;\n\n  if (isMachine(entity)) {\n    // \"mute\" the existing service scope so potential spawned actors within the `.initialState` stay deferred here\n    tempActor.state = provide(undefined, function () {\n      return (data ? entity.withContext(data) : entity).initialState;\n    });\n  }\n\n  return tempActor;\n}\n\nfunction isActor(item) {\n  try {\n    return typeof item.send === 'function';\n  } catch (e) {\n    return false;\n  }\n}\n\nexport { createDeferredActor, createInvocableActor, createNullActor, isActor };","import { __assign, __rest } from './_virtual/_tslib.js';\nimport { invoke } from './actionTypes.js';\nimport './actions.js';\n\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    var simpleSrc = {\n      type: src\n    };\n\n    simpleSrc.toString = function () {\n      return src;\n    }; // v4 compat - TODO: remove in v5\n\n\n    return simpleSrc;\n  }\n\n  return src;\n}\n\nfunction toInvokeDefinition(invokeConfig) {\n  return __assign(__assign({\n    type: invoke\n  }, invokeConfig), {\n    toJSON: function () {\n      var onDone = invokeConfig.onDone,\n          onError = invokeConfig.onError,\n          invokeDef = __rest(invokeConfig, [\"onDone\", \"onError\"]);\n\n      return __assign(__assign({}, invokeDef), {\n        type: invoke,\n        src: toInvokeSource(invokeConfig.src)\n      });\n    }\n  });\n}\n\nexport { toInvokeDefinition, toInvokeSource };","import { __assign, __values, __spread, __read, __rest } from './_virtual/_tslib.js';\nimport { STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { mapValues, isArray, flatten, keys, toArray, toStateValue, isString, getEventType, matchesState, path, evaluateGuard, mapContext, toSCXMLEvent, pathToStateValue, isBuiltInEvent, partition, updateHistoryValue, toStatePath, mapFilterValues, warn, toStatePaths, nestedPath, normalizeTarget, toGuard, toTransitionConfigArray, isMachine, isFunction } from './utils.js';\nimport { SpecialTargets } from './types.js';\nimport { getAllStateNodes, getConfiguration, has, getChildren, isInFinalState, getValue, isLeafNode } from './stateUtils.js';\nimport { start as start$1, stop as stop$1, invoke, update, nullEvent, raise as raise$1, send as send$1 } from './actionTypes.js';\nimport { done, start, raise, stop, toActionObjects, resolveActions, doneInvoke, error, toActionObject, toActivityDefinition, after, send, cancel, initEvent } from './actions.js';\nimport { State, stateValuesEqual } from './State.js';\nimport { createInvocableActor } from './Actor.js';\nimport { toInvokeDefinition } from './invokeUtils.js';\nvar NULL_EVENT = '';\nvar STATE_IDENTIFIER = '#';\nvar WILDCARD = '*';\nvar EMPTY_OBJECT = {};\n\nvar isStateId = function (str) {\n  return str[0] === STATE_IDENTIFIER;\n};\n\nvar createDefaultOptions = function () {\n  return {\n    actions: {},\n    guards: {},\n    services: {},\n    activities: {},\n    delays: {}\n  };\n};\n\nvar validateArrayifiedTransitions = function (stateNode, event, transitions) {\n  var hasNonLastUnguardedTarget = transitions.slice(0, -1).some(function (transition) {\n    return !('cond' in transition) && !('in' in transition) && (isString(transition.target) || isMachine(transition.target));\n  });\n  var eventText = event === NULL_EVENT ? 'the transient event' : \"event '\" + event + \"'\";\n  warn(!hasNonLastUnguardedTarget, \"One or more transitions for \" + eventText + \" on state '\" + stateNode.id + \"' are unreachable. \" + \"Make sure that the default transition is the last one defined.\");\n};\n\nvar StateNode =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function StateNode(\n  /**\r\n   * The raw config used to create the machine.\r\n   */\n  config, options,\n  /**\r\n   * The initial extended state\r\n   */\n  context) {\n    var _this = this;\n\n    this.config = config;\n    this.context = context;\n    /**\r\n     * The order this state node appears. Corresponds to the implicit SCXML document order.\r\n     */\n\n    this.order = -1;\n    this.__xstatenode = true;\n    this.__cache = {\n      events: undefined,\n      relativeValue: new Map(),\n      initialStateValue: undefined,\n      initialState: undefined,\n      on: undefined,\n      transitions: undefined,\n      candidates: {},\n      delayedTransitions: undefined\n    };\n    this.idMap = {};\n    this.options = Object.assign(createDefaultOptions(), options);\n    this.parent = this.options._parent;\n    this.key = this.config.key || this.options._key || this.config.id || '(machine)';\n    this.machine = this.parent ? this.parent.machine : this;\n    this.path = this.parent ? this.parent.path.concat(this.key) : [];\n    this.delimiter = this.config.delimiter || (this.parent ? this.parent.delimiter : STATE_DELIMITER);\n    this.id = this.config.id || __spread([this.machine.key], this.path).join(this.delimiter);\n    this.version = this.parent ? this.parent.version : this.config.version;\n    this.type = this.config.type || (this.config.parallel ? 'parallel' : this.config.states && keys(this.config.states).length ? 'compound' : this.config.history ? 'history' : 'atomic');\n\n    if (!IS_PRODUCTION) {\n      warn(!('parallel' in this.config), \"The \\\"parallel\\\" property is deprecated and will be removed in version 4.1. \" + (this.config.parallel ? \"Replace with `type: 'parallel'`\" : \"Use `type: '\" + this.type + \"'`\") + \" in the config for state node '\" + this.id + \"' instead.\");\n    }\n\n    this.initial = this.config.initial;\n    this.states = this.config.states ? mapValues(this.config.states, function (stateConfig, key) {\n      var _a;\n\n      var stateNode = new StateNode(stateConfig, {\n        _parent: _this,\n        _key: key\n      });\n      Object.assign(_this.idMap, __assign((_a = {}, _a[stateNode.id] = stateNode, _a), stateNode.idMap));\n      return stateNode;\n    }) : EMPTY_OBJECT; // Document order\n\n    var order = 0;\n\n    function dfs(stateNode) {\n      var e_1, _a;\n\n      stateNode.order = order++;\n\n      try {\n        for (var _b = __values(getChildren(stateNode)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n          dfs(child);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n\n    dfs(this); // History config\n\n    this.history = this.config.history === true ? 'shallow' : this.config.history || false;\n    this._transient = !!this.config.always || (!this.config.on ? false : Array.isArray(this.config.on) ? this.config.on.some(function (_a) {\n      var event = _a.event;\n      return event === NULL_EVENT;\n    }) : NULL_EVENT in this.config.on);\n    this.strict = !!this.config.strict; // TODO: deprecate (entry)\n\n    this.onEntry = toArray(this.config.entry || this.config.onEntry).map(function (action) {\n      return toActionObject(action);\n    }); // TODO: deprecate (exit)\n\n    this.onExit = toArray(this.config.exit || this.config.onExit).map(function (action) {\n      return toActionObject(action);\n    });\n    this.meta = this.config.meta;\n    this.doneData = this.type === 'final' ? this.config.data : undefined;\n    this.invoke = toArray(this.config.invoke).map(function (invokeConfig, i) {\n      var _a, _b;\n\n      if (isMachine(invokeConfig)) {\n        _this.machine.options.services = __assign((_a = {}, _a[invokeConfig.id] = invokeConfig, _a), _this.machine.options.services);\n        return toInvokeDefinition({\n          src: invokeConfig.id,\n          id: invokeConfig.id\n        });\n      } else if (isString(invokeConfig.src)) {\n        return toInvokeDefinition(__assign(__assign({}, invokeConfig), {\n          id: invokeConfig.id || invokeConfig.src,\n          src: invokeConfig.src\n        }));\n      } else if (isMachine(invokeConfig.src) || isFunction(invokeConfig.src)) {\n        var invokeSrc = _this.id + \":invocation[\" + i + \"]\"; // TODO: util function\n\n        _this.machine.options.services = __assign((_b = {}, _b[invokeSrc] = invokeConfig.src, _b), _this.machine.options.services);\n        return toInvokeDefinition(__assign(__assign({\n          id: invokeSrc\n        }, invokeConfig), {\n          src: invokeSrc\n        }));\n      } else {\n        var invokeSource = invokeConfig.src;\n        return toInvokeDefinition(__assign(__assign({\n          id: invokeSource.type\n        }, invokeConfig), {\n          src: invokeSource\n        }));\n      }\n    });\n    this.activities = toArray(this.config.activities).concat(this.invoke).map(function (activity) {\n      return toActivityDefinition(activity);\n    });\n    this.transition = this.transition.bind(this); // TODO: this is the real fix for initialization once\n    // state node getters are deprecated\n    // if (!this.parent) {\n    //   this._init();\n    // }\n  }\n\n  StateNode.prototype._init = function () {\n    if (this.__cache.transitions) {\n      return;\n    }\n\n    getAllStateNodes(this).forEach(function (stateNode) {\n      return stateNode.on;\n    });\n  };\n  /**\r\n   * Clones this state machine with custom options and context.\r\n   *\r\n   * @param options Options (actions, guards, activities, services) to recursively merge with the existing options.\r\n   * @param context Custom context (will override predefined context)\r\n   */\n\n\n  StateNode.prototype.withConfig = function (options, context) {\n    if (context === void 0) {\n      context = this.context;\n    }\n\n    var _a = this.options,\n        actions = _a.actions,\n        activities = _a.activities,\n        guards = _a.guards,\n        services = _a.services,\n        delays = _a.delays;\n    return new StateNode(this.config, {\n      actions: __assign(__assign({}, actions), options.actions),\n      activities: __assign(__assign({}, activities), options.activities),\n      guards: __assign(__assign({}, guards), options.guards),\n      services: __assign(__assign({}, services), options.services),\n      delays: __assign(__assign({}, delays), options.delays)\n    }, context);\n  };\n  /**\r\n   * Clones this state machine with custom context.\r\n   *\r\n   * @param context Custom context (will override predefined context, not recursive)\r\n   */\n\n\n  StateNode.prototype.withContext = function (context) {\n    return new StateNode(this.config, this.options, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"definition\", {\n    /**\r\n     * The well-structured state node definition.\r\n     */\n    get: function () {\n      return {\n        id: this.id,\n        key: this.key,\n        version: this.version,\n        context: this.context,\n        type: this.type,\n        initial: this.initial,\n        history: this.history,\n        states: mapValues(this.states, function (state) {\n          return state.definition;\n        }),\n        on: this.on,\n        transitions: this.transitions,\n        entry: this.onEntry,\n        exit: this.onExit,\n        activities: this.activities || [],\n        meta: this.meta,\n        order: this.order || -1,\n        data: this.doneData,\n        invoke: this.invoke\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.toJSON = function () {\n    return this.definition;\n  };\n\n  Object.defineProperty(StateNode.prototype, \"on\", {\n    /**\r\n     * The mapping of events to transitions.\r\n     */\n    get: function () {\n      if (this.__cache.on) {\n        return this.__cache.on;\n      }\n\n      var transitions = this.transitions;\n      return this.__cache.on = transitions.reduce(function (map, transition) {\n        map[transition.eventType] = map[transition.eventType] || [];\n        map[transition.eventType].push(transition);\n        return map;\n      }, {});\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"after\", {\n    get: function () {\n      return this.__cache.delayedTransitions || (this.__cache.delayedTransitions = this.getDelayedTransitions(), this.__cache.delayedTransitions);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"transitions\", {\n    /**\r\n     * All the transitions that can be taken from this state node.\r\n     */\n    get: function () {\n      return this.__cache.transitions || (this.__cache.transitions = this.formatTransitions(), this.__cache.transitions);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.getCandidates = function (eventName) {\n    if (this.__cache.candidates[eventName]) {\n      return this.__cache.candidates[eventName];\n    }\n\n    var transient = eventName === NULL_EVENT;\n    var candidates = this.transitions.filter(function (transition) {\n      var sameEventType = transition.eventType === eventName; // null events should only match against eventless transitions\n\n      return transient ? sameEventType : sameEventType || transition.eventType === WILDCARD;\n    });\n    this.__cache.candidates[eventName] = candidates;\n    return candidates;\n  };\n  /**\r\n   * All delayed transitions from the config.\r\n   */\n\n\n  StateNode.prototype.getDelayedTransitions = function () {\n    var _this = this;\n\n    var afterConfig = this.config.after;\n\n    if (!afterConfig) {\n      return [];\n    }\n\n    var mutateEntryExit = function (delay, i) {\n      var delayRef = isFunction(delay) ? _this.id + \":delay[\" + i + \"]\" : delay;\n      var eventType = after(delayRef, _this.id);\n\n      _this.onEntry.push(send(eventType, {\n        delay: delay\n      }));\n\n      _this.onExit.push(cancel(eventType));\n\n      return eventType;\n    };\n\n    var delayedTransitions = isArray(afterConfig) ? afterConfig.map(function (transition, i) {\n      var eventType = mutateEntryExit(transition.delay, i);\n      return __assign(__assign({}, transition), {\n        event: eventType\n      });\n    }) : flatten(keys(afterConfig).map(function (delay, i) {\n      var configTransition = afterConfig[delay];\n      var resolvedTransition = isString(configTransition) ? {\n        target: configTransition\n      } : configTransition;\n      var resolvedDelay = !isNaN(+delay) ? +delay : delay;\n      var eventType = mutateEntryExit(resolvedDelay, i);\n      return toArray(resolvedTransition).map(function (transition) {\n        return __assign(__assign({}, transition), {\n          event: eventType,\n          delay: resolvedDelay\n        });\n      });\n    }));\n    return delayedTransitions.map(function (delayedTransition) {\n      var delay = delayedTransition.delay;\n      return __assign(__assign({}, _this.formatTransition(delayedTransition)), {\n        delay: delay\n      });\n    });\n  };\n  /**\r\n   * Returns the state nodes represented by the current state value.\r\n   *\r\n   * @param state The state value or State instance\r\n   */\n\n\n  StateNode.prototype.getStateNodes = function (state) {\n    var _a;\n\n    var _this = this;\n\n    if (!state) {\n      return [];\n    }\n\n    var stateValue = state instanceof State ? state.value : toStateValue(state, this.delimiter);\n\n    if (isString(stateValue)) {\n      var initialStateValue = this.getStateNode(stateValue).initial;\n      return initialStateValue !== undefined ? this.getStateNodes((_a = {}, _a[stateValue] = initialStateValue, _a)) : [this.states[stateValue]];\n    }\n\n    var subStateKeys = keys(stateValue);\n    var subStateNodes = subStateKeys.map(function (subStateKey) {\n      return _this.getStateNode(subStateKey);\n    });\n    return subStateNodes.concat(subStateKeys.reduce(function (allSubStateNodes, subStateKey) {\n      var subStateNode = _this.getStateNode(subStateKey).getStateNodes(stateValue[subStateKey]);\n\n      return allSubStateNodes.concat(subStateNode);\n    }, []));\n  };\n  /**\r\n   * Returns `true` if this state node explicitly handles the given event.\r\n   *\r\n   * @param event The event in question\r\n   */\n\n\n  StateNode.prototype.handles = function (event) {\n    var eventType = getEventType(event);\n    return this.events.includes(eventType);\n  };\n  /**\r\n   * Resolves the given `state` to a new `State` instance relative to this machine.\r\n   *\r\n   * This ensures that `.events` and `.nextEvents` represent the correct values.\r\n   *\r\n   * @param state The state to resolve\r\n   */\n\n\n  StateNode.prototype.resolveState = function (state) {\n    var configuration = Array.from(getConfiguration([], this.getStateNodes(state.value)));\n    return new State(__assign(__assign({}, state), {\n      value: this.resolve(state.value),\n      configuration: configuration\n    }));\n  };\n\n  StateNode.prototype.transitionLeafNode = function (stateValue, state, _event) {\n    var stateNode = this.getStateNode(stateValue);\n    var next = stateNode.next(state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionCompoundNode = function (stateValue, state, _event) {\n    var subStateKeys = keys(stateValue);\n    var stateNode = this.getStateNode(subStateKeys[0]);\n\n    var next = stateNode._transition(stateValue[subStateKeys[0]], state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionParallelNode = function (stateValue, state, _event) {\n    var e_2, _a;\n\n    var transitionMap = {};\n\n    try {\n      for (var _b = __values(keys(stateValue)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var subStateKey = _c.value;\n        var subStateValue = stateValue[subStateKey];\n\n        if (!subStateValue) {\n          continue;\n        }\n\n        var subStateNode = this.getStateNode(subStateKey);\n\n        var next = subStateNode._transition(subStateValue, state, _event);\n\n        if (next) {\n          transitionMap[subStateKey] = next;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var stateTransitions = keys(transitionMap).map(function (key) {\n      return transitionMap[key];\n    });\n    var enabledTransitions = flatten(stateTransitions.map(function (st) {\n      return st.transitions;\n    }));\n    var willTransition = stateTransitions.some(function (st) {\n      return st.transitions.length > 0;\n    });\n\n    if (!willTransition) {\n      return this.next(state, _event);\n    }\n\n    var entryNodes = flatten(stateTransitions.map(function (t) {\n      return t.entrySet;\n    }));\n    var configuration = flatten(keys(transitionMap).map(function (key) {\n      return transitionMap[key].configuration;\n    }));\n    return {\n      transitions: enabledTransitions,\n      entrySet: entryNodes,\n      exitSet: flatten(stateTransitions.map(function (t) {\n        return t.exitSet;\n      })),\n      configuration: configuration,\n      source: state,\n      actions: flatten(keys(transitionMap).map(function (key) {\n        return transitionMap[key].actions;\n      }))\n    };\n  };\n\n  StateNode.prototype._transition = function (stateValue, state, _event) {\n    // leaf node\n    if (isString(stateValue)) {\n      return this.transitionLeafNode(stateValue, state, _event);\n    } // hierarchical node\n\n\n    if (keys(stateValue).length === 1) {\n      return this.transitionCompoundNode(stateValue, state, _event);\n    } // orthogonal node\n\n\n    return this.transitionParallelNode(stateValue, state, _event);\n  };\n\n  StateNode.prototype.next = function (state, _event) {\n    var e_3, _a;\n\n    var _this = this;\n\n    var eventName = _event.name;\n    var actions = [];\n    var nextStateNodes = [];\n    var selectedTransition;\n\n    try {\n      for (var _b = __values(this.getCandidates(eventName)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var candidate = _c.value;\n        var cond = candidate.cond,\n            stateIn = candidate.in;\n        var resolvedContext = state.context;\n        var isInState = stateIn ? isString(stateIn) && isStateId(stateIn) ? // Check if in state by ID\n        state.matches(toStateValue(this.getStateNodeById(stateIn).path, this.delimiter)) : // Check if in state by relative grandparent\n        matchesState(toStateValue(stateIn, this.delimiter), path(this.path.slice(0, -2))(state.value)) : true;\n        var guardPassed = false;\n\n        try {\n          guardPassed = !cond || evaluateGuard(this.machine, cond, resolvedContext, _event, state);\n        } catch (err) {\n          throw new Error(\"Unable to evaluate guard '\" + (cond.name || cond.type) + \"' in transition for event '\" + eventName + \"' in state node '\" + this.id + \"':\\n\" + err.message);\n        }\n\n        if (guardPassed && isInState) {\n          if (candidate.target !== undefined) {\n            nextStateNodes = candidate.target;\n          }\n\n          actions.push.apply(actions, __spread(candidate.actions));\n          selectedTransition = candidate;\n          break;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    if (!selectedTransition) {\n      return undefined;\n    }\n\n    if (!nextStateNodes.length) {\n      return {\n        transitions: [selectedTransition],\n        entrySet: [],\n        exitSet: [],\n        configuration: state.value ? [this] : [],\n        source: state,\n        actions: actions\n      };\n    }\n\n    var allNextStateNodes = flatten(nextStateNodes.map(function (stateNode) {\n      return _this.getRelativeStateNodes(stateNode, state.historyValue);\n    }));\n    var isInternal = !!selectedTransition.internal;\n    var reentryNodes = isInternal ? [] : flatten(allNextStateNodes.map(function (n) {\n      return _this.nodesFromChild(n);\n    }));\n    return {\n      transitions: [selectedTransition],\n      entrySet: reentryNodes,\n      exitSet: isInternal ? [] : [this],\n      configuration: allNextStateNodes,\n      source: state,\n      actions: actions\n    };\n  };\n\n  StateNode.prototype.nodesFromChild = function (childStateNode) {\n    if (childStateNode.escapes(this)) {\n      return [];\n    }\n\n    var nodes = [];\n    var marker = childStateNode;\n\n    while (marker && marker !== this) {\n      nodes.push(marker);\n      marker = marker.parent;\n    }\n\n    nodes.push(this); // inclusive\n\n    return nodes;\n  };\n  /**\r\n   * Whether the given state node \"escapes\" this state node. If the `stateNode` is equal to or the parent of\r\n   * this state node, it does not escape.\r\n   */\n\n\n  StateNode.prototype.escapes = function (stateNode) {\n    if (this === stateNode) {\n      return false;\n    }\n\n    var parent = this.parent;\n\n    while (parent) {\n      if (parent === stateNode) {\n        return false;\n      }\n\n      parent = parent.parent;\n    }\n\n    return true;\n  };\n\n  StateNode.prototype.getActions = function (transition, currentContext, _event, prevState) {\n    var e_4, _a, e_5, _b;\n\n    var prevConfig = getConfiguration([], prevState ? this.getStateNodes(prevState.value) : [this]);\n    var resolvedConfig = transition.configuration.length ? getConfiguration(prevConfig, transition.configuration) : prevConfig;\n\n    try {\n      for (var resolvedConfig_1 = __values(resolvedConfig), resolvedConfig_1_1 = resolvedConfig_1.next(); !resolvedConfig_1_1.done; resolvedConfig_1_1 = resolvedConfig_1.next()) {\n        var sn = resolvedConfig_1_1.value;\n\n        if (!has(prevConfig, sn)) {\n          transition.entrySet.push(sn);\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (resolvedConfig_1_1 && !resolvedConfig_1_1.done && (_a = resolvedConfig_1.return)) _a.call(resolvedConfig_1);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    try {\n      for (var prevConfig_1 = __values(prevConfig), prevConfig_1_1 = prevConfig_1.next(); !prevConfig_1_1.done; prevConfig_1_1 = prevConfig_1.next()) {\n        var sn = prevConfig_1_1.value;\n\n        if (!has(resolvedConfig, sn) || has(transition.exitSet, sn.parent)) {\n          transition.exitSet.push(sn);\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (prevConfig_1_1 && !prevConfig_1_1.done && (_b = prevConfig_1.return)) _b.call(prevConfig_1);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    if (!transition.source) {\n      transition.exitSet = []; // Ensure that root StateNode (machine) is entered\n\n      transition.entrySet.push(this);\n    }\n\n    var doneEvents = flatten(transition.entrySet.map(function (sn) {\n      var events = [];\n\n      if (sn.type !== 'final') {\n        return events;\n      }\n\n      var parent = sn.parent;\n\n      if (!parent.parent) {\n        return events;\n      }\n\n      events.push(done(sn.id, sn.doneData), // TODO: deprecate - final states should not emit done events for their own state.\n      done(parent.id, sn.doneData ? mapContext(sn.doneData, currentContext, _event) : undefined));\n      var grandparent = parent.parent;\n\n      if (grandparent.type === 'parallel') {\n        if (getChildren(grandparent).every(function (parentNode) {\n          return isInFinalState(transition.configuration, parentNode);\n        })) {\n          events.push(done(grandparent.id));\n        }\n      }\n\n      return events;\n    }));\n    transition.exitSet.sort(function (a, b) {\n      return b.order - a.order;\n    });\n    transition.entrySet.sort(function (a, b) {\n      return a.order - b.order;\n    });\n    var entryStates = new Set(transition.entrySet);\n    var exitStates = new Set(transition.exitSet);\n\n    var _c = __read([flatten(Array.from(entryStates).map(function (stateNode) {\n      return __spread(stateNode.activities.map(function (activity) {\n        return start(activity);\n      }), stateNode.onEntry);\n    })).concat(doneEvents.map(raise)), flatten(Array.from(exitStates).map(function (stateNode) {\n      return __spread(stateNode.onExit, stateNode.activities.map(function (activity) {\n        return stop(activity);\n      }));\n    }))], 2),\n        entryActions = _c[0],\n        exitActions = _c[1];\n\n    var actions = toActionObjects(exitActions.concat(transition.actions).concat(entryActions), this.machine.options.actions);\n    return actions;\n  };\n  /**\r\n   * Determines the next state given the current `state` and sent `event`.\r\n   *\r\n   * @param state The current State instance or state value\r\n   * @param event The event that was sent at the current state\r\n   * @param context The current context (extended state) of the current state\r\n   */\n\n\n  StateNode.prototype.transition = function (state, event, context) {\n    if (state === void 0) {\n      state = this.initialState;\n    }\n\n    var _event = toSCXMLEvent(event);\n\n    var currentState;\n\n    if (state instanceof State) {\n      currentState = context === undefined ? state : this.resolveState(State.from(state, context));\n    } else {\n      var resolvedStateValue = isString(state) ? this.resolve(pathToStateValue(this.getResolvedPath(state))) : this.resolve(state);\n      var resolvedContext = context ? context : this.machine.context;\n      currentState = this.resolveState(State.from(resolvedStateValue, resolvedContext));\n    }\n\n    if (!IS_PRODUCTION && _event.name === WILDCARD) {\n      throw new Error(\"An event cannot have the wildcard type ('\" + WILDCARD + \"')\");\n    }\n\n    if (this.strict) {\n      if (!this.events.includes(_event.name) && !isBuiltInEvent(_event.name)) {\n        throw new Error(\"Machine '\" + this.id + \"' does not accept event '\" + _event.name + \"'\");\n      }\n    }\n\n    var stateTransition = this._transition(currentState.value, currentState, _event) || {\n      transitions: [],\n      configuration: [],\n      entrySet: [],\n      exitSet: [],\n      source: currentState,\n      actions: []\n    };\n    var prevConfig = getConfiguration([], this.getStateNodes(currentState.value));\n    var resolvedConfig = stateTransition.configuration.length ? getConfiguration(prevConfig, stateTransition.configuration) : prevConfig;\n    stateTransition.configuration = __spread(resolvedConfig);\n    return this.resolveTransition(stateTransition, currentState, _event);\n  };\n\n  StateNode.prototype.resolveRaisedTransition = function (state, _event, originalEvent) {\n    var _a;\n\n    var currentActions = state.actions;\n    state = this.transition(state, _event); // Save original event to state\n    // TODO: this should be the raised event! Delete in V5 (breaking)\n\n    state._event = originalEvent;\n    state.event = originalEvent.data;\n\n    (_a = state.actions).unshift.apply(_a, __spread(currentActions));\n\n    return state;\n  };\n\n  StateNode.prototype.resolveTransition = function (stateTransition, currentState, _event, context) {\n    var e_6, _a;\n\n    var _this = this;\n\n    if (_event === void 0) {\n      _event = initEvent;\n    }\n\n    if (context === void 0) {\n      context = this.machine.context;\n    }\n\n    var configuration = stateTransition.configuration; // Transition will \"apply\" if:\n    // - this is the initial state (there is no current state)\n    // - OR there are transitions\n\n    var willTransition = !currentState || stateTransition.transitions.length > 0;\n    var resolvedStateValue = willTransition ? getValue(this.machine, configuration) : undefined;\n    var historyValue = currentState ? currentState.historyValue ? currentState.historyValue : stateTransition.source ? this.machine.historyValue(currentState.value) : undefined : undefined;\n    var currentContext = currentState ? currentState.context : context;\n    var actions = this.getActions(stateTransition, currentContext, _event, currentState);\n    var activities = currentState ? __assign({}, currentState.activities) : {};\n\n    try {\n      for (var actions_1 = __values(actions), actions_1_1 = actions_1.next(); !actions_1_1.done; actions_1_1 = actions_1.next()) {\n        var action = actions_1_1.value;\n\n        if (action.type === start$1) {\n          activities[action.activity.id || action.activity.type] = action;\n        } else if (action.type === stop$1) {\n          activities[action.activity.id || action.activity.type] = false;\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (actions_1_1 && !actions_1_1.done && (_a = actions_1.return)) _a.call(actions_1);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    var _b = __read(resolveActions(this, currentState, currentContext, _event, actions), 2),\n        resolvedActions = _b[0],\n        updatedContext = _b[1];\n\n    var _c = __read(partition(resolvedActions, function (action) {\n      return action.type === raise$1 || action.type === send$1 && action.to === SpecialTargets.Internal;\n    }), 2),\n        raisedEvents = _c[0],\n        nonRaisedActions = _c[1];\n\n    var invokeActions = resolvedActions.filter(function (action) {\n      return action.type === start$1 && action.activity.type === invoke;\n    });\n    var children = invokeActions.reduce(function (acc, action) {\n      acc[action.activity.id] = createInvocableActor(action.activity, _this.machine, updatedContext, _event);\n      return acc;\n    }, currentState ? __assign({}, currentState.children) : {});\n    var resolvedConfiguration = resolvedStateValue ? stateTransition.configuration : currentState ? currentState.configuration : [];\n    var meta = resolvedConfiguration.reduce(function (acc, stateNode) {\n      if (stateNode.meta !== undefined) {\n        acc[stateNode.id] = stateNode.meta;\n      }\n\n      return acc;\n    }, {});\n    var isDone = isInFinalState(resolvedConfiguration, this);\n    var nextState = new State({\n      value: resolvedStateValue || currentState.value,\n      context: updatedContext,\n      _event: _event,\n      // Persist _sessionid between states\n      _sessionid: currentState ? currentState._sessionid : null,\n      historyValue: resolvedStateValue ? historyValue ? updateHistoryValue(historyValue, resolvedStateValue) : undefined : currentState ? currentState.historyValue : undefined,\n      history: !resolvedStateValue || stateTransition.source ? currentState : undefined,\n      actions: resolvedStateValue ? nonRaisedActions : [],\n      activities: resolvedStateValue ? activities : currentState ? currentState.activities : {},\n      meta: resolvedStateValue ? meta : currentState ? currentState.meta : undefined,\n      events: [],\n      configuration: resolvedConfiguration,\n      transitions: stateTransition.transitions,\n      children: children,\n      done: isDone\n    });\n    var didUpdateContext = currentContext !== updatedContext;\n    nextState.changed = _event.name === update || didUpdateContext; // Dispose of penultimate histories to prevent memory leaks\n\n    var history = nextState.history;\n\n    if (history) {\n      delete history.history;\n    }\n\n    if (!resolvedStateValue) {\n      return nextState;\n    }\n\n    var maybeNextState = nextState;\n\n    if (!isDone) {\n      var isTransient = this._transient || configuration.some(function (stateNode) {\n        return stateNode._transient;\n      });\n\n      if (isTransient) {\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, {\n          type: nullEvent\n        }, _event);\n      }\n\n      while (raisedEvents.length) {\n        var raisedEvent = raisedEvents.shift();\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, raisedEvent._event, _event);\n      }\n    } // Detect if state changed\n\n\n    var changed = maybeNextState.changed || (history ? !!maybeNextState.actions.length || didUpdateContext || typeof history.value !== typeof maybeNextState.value || !stateValuesEqual(maybeNextState.value, history.value) : undefined);\n    maybeNextState.changed = changed; // Preserve original history after raised events\n\n    maybeNextState.historyValue = nextState.historyValue;\n    maybeNextState.history = history;\n    return maybeNextState;\n  };\n  /**\r\n   * Returns the child state node from its relative `stateKey`, or throws.\r\n   */\n\n\n  StateNode.prototype.getStateNode = function (stateKey) {\n    if (isStateId(stateKey)) {\n      return this.machine.getStateNodeById(stateKey);\n    }\n\n    if (!this.states) {\n      throw new Error(\"Unable to retrieve child state '\" + stateKey + \"' from '\" + this.id + \"'; no child states exist.\");\n    }\n\n    var result = this.states[stateKey];\n\n    if (!result) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return result;\n  };\n  /**\r\n   * Returns the state node with the given `stateId`, or throws.\r\n   *\r\n   * @param stateId The state ID. The prefix \"#\" is removed.\r\n   */\n\n\n  StateNode.prototype.getStateNodeById = function (stateId) {\n    var resolvedStateId = isStateId(stateId) ? stateId.slice(STATE_IDENTIFIER.length) : stateId;\n\n    if (resolvedStateId === this.id) {\n      return this;\n    }\n\n    var stateNode = this.machine.idMap[resolvedStateId];\n\n    if (!stateNode) {\n      throw new Error(\"Child state node '#\" + resolvedStateId + \"' does not exist on machine '\" + this.id + \"'\");\n    }\n\n    return stateNode;\n  };\n  /**\r\n   * Returns the relative state node from the given `statePath`, or throws.\r\n   *\r\n   * @param statePath The string or string array relative path to the state node.\r\n   */\n\n\n  StateNode.prototype.getStateNodeByPath = function (statePath) {\n    if (typeof statePath === 'string' && isStateId(statePath)) {\n      try {\n        return this.getStateNodeById(statePath.slice(1));\n      } catch (e) {// try individual paths\n        // throw e;\n      }\n    }\n\n    var arrayStatePath = toStatePath(statePath, this.delimiter).slice();\n    var currentStateNode = this;\n\n    while (arrayStatePath.length) {\n      var key = arrayStatePath.shift();\n\n      if (!key.length) {\n        break;\n      }\n\n      currentStateNode = currentStateNode.getStateNode(key);\n    }\n\n    return currentStateNode;\n  };\n  /**\r\n   * Resolves a partial state value with its full representation in this machine.\r\n   *\r\n   * @param stateValue The partial state value to resolve.\r\n   */\n\n\n  StateNode.prototype.resolve = function (stateValue) {\n    var _a;\n\n    var _this = this;\n\n    if (!stateValue) {\n      return this.initialStateValue || EMPTY_OBJECT; // TODO: type-specific properties\n    }\n\n    switch (this.type) {\n      case 'parallel':\n        return mapValues(this.initialStateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(stateValue[subStateKey] || subStateValue) : EMPTY_OBJECT;\n        });\n\n      case 'compound':\n        if (isString(stateValue)) {\n          var subStateNode = this.getStateNode(stateValue);\n\n          if (subStateNode.type === 'parallel' || subStateNode.type === 'compound') {\n            return _a = {}, _a[stateValue] = subStateNode.initialStateValue, _a;\n          }\n\n          return stateValue;\n        }\n\n        if (!keys(stateValue).length) {\n          return this.initialStateValue || {};\n        }\n\n        return mapValues(stateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(subStateValue) : EMPTY_OBJECT;\n        });\n\n      default:\n        return stateValue || EMPTY_OBJECT;\n    }\n  };\n\n  StateNode.prototype.getResolvedPath = function (stateIdentifier) {\n    if (isStateId(stateIdentifier)) {\n      var stateNode = this.machine.idMap[stateIdentifier.slice(STATE_IDENTIFIER.length)];\n\n      if (!stateNode) {\n        throw new Error(\"Unable to find state node '\" + stateIdentifier + \"'\");\n      }\n\n      return stateNode.path;\n    }\n\n    return toStatePath(stateIdentifier, this.delimiter);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateValue\", {\n    get: function () {\n      var _a;\n\n      if (this.__cache.initialStateValue) {\n        return this.__cache.initialStateValue;\n      }\n\n      var initialStateValue;\n\n      if (this.type === 'parallel') {\n        initialStateValue = mapFilterValues(this.states, function (state) {\n          return state.initialStateValue || EMPTY_OBJECT;\n        }, function (stateNode) {\n          return !(stateNode.type === 'history');\n        });\n      } else if (this.initial !== undefined) {\n        if (!this.states[this.initial]) {\n          throw new Error(\"Initial state '\" + this.initial + \"' not found on '\" + this.key + \"'\");\n        }\n\n        initialStateValue = isLeafNode(this.states[this.initial]) ? this.initial : (_a = {}, _a[this.initial] = this.states[this.initial].initialStateValue, _a);\n      }\n\n      this.__cache.initialStateValue = initialStateValue;\n      return this.__cache.initialStateValue;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.getInitialState = function (stateValue, context) {\n    var configuration = this.getStateNodes(stateValue);\n    return this.resolveTransition({\n      configuration: configuration,\n      entrySet: configuration,\n      exitSet: [],\n      transitions: [],\n      source: undefined,\n      actions: []\n    }, undefined, undefined, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialState\", {\n    /**\r\n     * The initial State instance, which includes all actions to be executed from\r\n     * entering the initial state.\r\n     */\n    get: function () {\n      this._init(); // TODO: this should be in the constructor (see note in constructor)\n\n\n      var initialStateValue = this.initialStateValue;\n\n      if (!initialStateValue) {\n        throw new Error(\"Cannot retrieve initial state from simple state '\" + this.id + \"'.\");\n      }\n\n      return this.getInitialState(initialStateValue);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"target\", {\n    /**\r\n     * The target state value of the history state node, if it exists. This represents the\r\n     * default state value to transition to if no history value exists yet.\r\n     */\n    get: function () {\n      var target;\n\n      if (this.type === 'history') {\n        var historyConfig = this.config;\n\n        if (isString(historyConfig.target)) {\n          target = isStateId(historyConfig.target) ? pathToStateValue(this.machine.getStateNodeById(historyConfig.target).path.slice(this.path.length - 1)) : historyConfig.target;\n        } else {\n          target = historyConfig.target;\n        }\n      }\n\n      return target;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Returns the leaf nodes from a state path relative to this state node.\r\n   *\r\n   * @param relativeStateId The relative state path to retrieve the state nodes\r\n   * @param history The previous state to retrieve history\r\n   * @param resolve Whether state nodes should resolve to initial child state nodes\r\n   */\n\n  StateNode.prototype.getRelativeStateNodes = function (relativeStateId, historyValue, resolve) {\n    if (resolve === void 0) {\n      resolve = true;\n    }\n\n    return resolve ? relativeStateId.type === 'history' ? relativeStateId.resolveHistory(historyValue) : relativeStateId.initialStateNodes : [relativeStateId];\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateNodes\", {\n    get: function () {\n      var _this = this;\n\n      if (isLeafNode(this)) {\n        return [this];\n      } // Case when state node is compound but no initial state is defined\n\n\n      if (this.type === 'compound' && !this.initial) {\n        if (!IS_PRODUCTION) {\n          warn(false, \"Compound state node '\" + this.id + \"' has no initial state.\");\n        }\n\n        return [this];\n      }\n\n      var initialStateNodePaths = toStatePaths(this.initialStateValue);\n      return flatten(initialStateNodePaths.map(function (initialPath) {\n        return _this.getFromRelativePath(initialPath);\n      }));\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Retrieves state nodes from a relative path to this state node.\r\n   *\r\n   * @param relativePath The relative path from this state node\r\n   * @param historyValue\r\n   */\n\n  StateNode.prototype.getFromRelativePath = function (relativePath) {\n    if (!relativePath.length) {\n      return [this];\n    }\n\n    var _a = __read(relativePath),\n        stateKey = _a[0],\n        childStatePath = _a.slice(1);\n\n    if (!this.states) {\n      throw new Error(\"Cannot retrieve subPath '\" + stateKey + \"' from node with no states\");\n    }\n\n    var childStateNode = this.getStateNode(stateKey);\n\n    if (childStateNode.type === 'history') {\n      return childStateNode.resolveHistory();\n    }\n\n    if (!this.states[stateKey]) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return this.states[stateKey].getFromRelativePath(childStatePath);\n  };\n\n  StateNode.prototype.historyValue = function (relativeStateValue) {\n    if (!keys(this.states).length) {\n      return undefined;\n    }\n\n    return {\n      current: relativeStateValue || this.initialStateValue,\n      states: mapFilterValues(this.states, function (stateNode, key) {\n        if (!relativeStateValue) {\n          return stateNode.historyValue();\n        }\n\n        var subStateValue = isString(relativeStateValue) ? undefined : relativeStateValue[key];\n        return stateNode.historyValue(subStateValue || stateNode.initialStateValue);\n      }, function (stateNode) {\n        return !stateNode.history;\n      })\n    };\n  };\n  /**\r\n   * Resolves to the historical value(s) of the parent state node,\r\n   * represented by state nodes.\r\n   *\r\n   * @param historyValue\r\n   */\n\n\n  StateNode.prototype.resolveHistory = function (historyValue) {\n    var _this = this;\n\n    if (this.type !== 'history') {\n      return [this];\n    }\n\n    var parent = this.parent;\n\n    if (!historyValue) {\n      var historyTarget = this.target;\n      return historyTarget ? flatten(toStatePaths(historyTarget).map(function (relativeChildPath) {\n        return parent.getFromRelativePath(relativeChildPath);\n      })) : parent.initialStateNodes;\n    }\n\n    var subHistoryValue = nestedPath(parent.path, 'states')(historyValue).current;\n\n    if (isString(subHistoryValue)) {\n      return [parent.getStateNode(subHistoryValue)];\n    }\n\n    return flatten(toStatePaths(subHistoryValue).map(function (subStatePath) {\n      return _this.history === 'deep' ? parent.getFromRelativePath(subStatePath) : [parent.states[subStatePath[0]]];\n    }));\n  };\n\n  Object.defineProperty(StateNode.prototype, \"stateIds\", {\n    /**\r\n     * All the state node IDs of this state node and its descendant state nodes.\r\n     */\n    get: function () {\n      var _this = this;\n\n      var childStateIds = flatten(keys(this.states).map(function (stateKey) {\n        return _this.states[stateKey].stateIds;\n      }));\n      return [this.id].concat(childStateIds);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"events\", {\n    /**\r\n     * All the event types accepted by this state node and its descendants.\r\n     */\n    get: function () {\n      var e_7, _a, e_8, _b;\n\n      if (this.__cache.events) {\n        return this.__cache.events;\n      }\n\n      var states = this.states;\n      var events = new Set(this.ownEvents);\n\n      if (states) {\n        try {\n          for (var _c = __values(keys(states)), _d = _c.next(); !_d.done; _d = _c.next()) {\n            var stateId = _d.value;\n            var state = states[stateId];\n\n            if (state.states) {\n              try {\n                for (var _e = (e_8 = void 0, __values(state.events)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                  var event_1 = _f.value;\n                  events.add(\"\" + event_1);\n                }\n              } catch (e_8_1) {\n                e_8 = {\n                  error: e_8_1\n                };\n              } finally {\n                try {\n                  if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                } finally {\n                  if (e_8) throw e_8.error;\n                }\n              }\n            }\n          }\n        } catch (e_7_1) {\n          e_7 = {\n            error: e_7_1\n          };\n        } finally {\n          try {\n            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n          } finally {\n            if (e_7) throw e_7.error;\n          }\n        }\n      }\n\n      return this.__cache.events = Array.from(events);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"ownEvents\", {\n    /**\r\n     * All the events that have transitions directly from this state node.\r\n     *\r\n     * Excludes any inert events.\r\n     */\n    get: function () {\n      var events = new Set(this.transitions.filter(function (transition) {\n        return !(!transition.target && !transition.actions.length && transition.internal);\n      }).map(function (transition) {\n        return transition.eventType;\n      }));\n      return Array.from(events);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.resolveTarget = function (_target) {\n    var _this = this;\n\n    if (_target === undefined) {\n      // an undefined target signals that the state node should not transition from that state when receiving that event\n      return undefined;\n    }\n\n    return _target.map(function (target) {\n      if (!isString(target)) {\n        return target;\n      }\n\n      var isInternalTarget = target[0] === _this.delimiter; // If internal target is defined on machine,\n      // do not include machine key on target\n\n      if (isInternalTarget && !_this.parent) {\n        return _this.getStateNodeByPath(target.slice(1));\n      }\n\n      var resolvedTarget = isInternalTarget ? _this.key + target : target;\n\n      if (_this.parent) {\n        try {\n          var targetStateNode = _this.parent.getStateNodeByPath(resolvedTarget);\n\n          return targetStateNode;\n        } catch (err) {\n          throw new Error(\"Invalid transition definition for state node '\" + _this.id + \"':\\n\" + err.message);\n        }\n      } else {\n        return _this.getStateNodeByPath(resolvedTarget);\n      }\n    });\n  };\n\n  StateNode.prototype.formatTransition = function (transitionConfig) {\n    var _this = this;\n\n    var normalizedTarget = normalizeTarget(transitionConfig.target);\n    var internal = 'internal' in transitionConfig ? transitionConfig.internal : normalizedTarget ? normalizedTarget.some(function (_target) {\n      return isString(_target) && _target[0] === _this.delimiter;\n    }) : true;\n    var guards = this.machine.options.guards;\n    var target = this.resolveTarget(normalizedTarget);\n\n    var transition = __assign(__assign({}, transitionConfig), {\n      actions: toActionObjects(toArray(transitionConfig.actions)),\n      cond: toGuard(transitionConfig.cond, guards),\n      target: target,\n      source: this,\n      internal: internal,\n      eventType: transitionConfig.event,\n      toJSON: function () {\n        return __assign(__assign({}, transition), {\n          target: transition.target ? transition.target.map(function (t) {\n            return \"#\" + t.id;\n          }) : undefined,\n          source: \"#\" + _this.id\n        });\n      }\n    });\n\n    return transition;\n  };\n\n  StateNode.prototype.formatTransitions = function () {\n    var e_9, _a;\n\n    var _this = this;\n\n    var onConfig;\n\n    if (!this.config.on) {\n      onConfig = [];\n    } else if (Array.isArray(this.config.on)) {\n      onConfig = this.config.on;\n    } else {\n      var _b = this.config.on,\n          _c = WILDCARD,\n          _d = _b[_c],\n          wildcardConfigs = _d === void 0 ? [] : _d,\n          strictTransitionConfigs_1 = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n      onConfig = flatten(keys(strictTransitionConfigs_1).map(function (key) {\n        if (!IS_PRODUCTION && key === NULL_EVENT) {\n          warn(false, \"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. \" + (\"Please check the `on` configuration for \\\"#\" + _this.id + \"\\\".\"));\n        }\n\n        var transitionConfigArray = toTransitionConfigArray(key, strictTransitionConfigs_1[key]);\n\n        if (!IS_PRODUCTION) {\n          validateArrayifiedTransitions(_this, key, transitionConfigArray);\n        }\n\n        return transitionConfigArray;\n      }).concat(toTransitionConfigArray(WILDCARD, wildcardConfigs)));\n    }\n\n    var eventlessConfig = this.config.always ? toTransitionConfigArray('', this.config.always) : [];\n    var doneConfig = this.config.onDone ? toTransitionConfigArray(String(done(this.id)), this.config.onDone) : [];\n\n    if (!IS_PRODUCTION) {\n      warn(!(this.config.onDone && !this.parent), \"Root nodes cannot have an \\\".onDone\\\" transition. Please check the config of \\\"\" + this.id + \"\\\".\");\n    }\n\n    var invokeConfig = flatten(this.invoke.map(function (invokeDef) {\n      var settleTransitions = [];\n\n      if (invokeDef.onDone) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(doneInvoke(invokeDef.id)), invokeDef.onDone)));\n      }\n\n      if (invokeDef.onError) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(error(invokeDef.id)), invokeDef.onError)));\n      }\n\n      return settleTransitions;\n    }));\n    var delayedTransitions = this.after;\n    var formattedTransitions = flatten(__spread(doneConfig, invokeConfig, onConfig, eventlessConfig).map(function (transitionConfig) {\n      return toArray(transitionConfig).map(function (transition) {\n        return _this.formatTransition(transition);\n      });\n    }));\n\n    try {\n      for (var delayedTransitions_1 = __values(delayedTransitions), delayedTransitions_1_1 = delayedTransitions_1.next(); !delayedTransitions_1_1.done; delayedTransitions_1_1 = delayedTransitions_1.next()) {\n        var delayedTransition = delayedTransitions_1_1.value;\n        formattedTransitions.push(delayedTransition);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (delayedTransitions_1_1 && !delayedTransitions_1_1.done && (_a = delayedTransitions_1.return)) _a.call(delayedTransitions_1);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    return formattedTransitions;\n  };\n\n  return StateNode;\n}();\n\nexport { StateNode };","import { StateNode } from './StateNode.js';\n\nfunction Machine(config, options, initialContext) {\n  if (initialContext === void 0) {\n    initialContext = config.context;\n  }\n\n  var resolvedInitialContext = typeof initialContext === 'function' ? initialContext() : initialContext;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nfunction createMachine(config, options) {\n  var resolvedInitialContext = typeof config.context === 'function' ? config.context() : config.context;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nexport { Machine, createMachine };","import { __assign } from './_virtual/_tslib.js';\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };","var children = /*#__PURE__*/new Map();\nvar sessionIdIndex = 0;\nvar registry = {\n  bookId: function () {\n    return \"x:\" + sessionIdIndex++;\n  },\n  register: function (id, actor) {\n    children.set(id, actor);\n    return id;\n  },\n  get: function (id) {\n    return children.get(id);\n  },\n  free: function (id) {\n    children.delete(id);\n  }\n};\nexport { registry };","import { IS_PRODUCTION } from './environment.js';\n\nfunction getDevTools() {\n  var w = window;\n\n  if (!!w.__xstate__) {\n    return w.__xstate__;\n  }\n\n  return undefined;\n}\n\nfunction registerService(service) {\n  if (IS_PRODUCTION || typeof window === 'undefined') {\n    return;\n  }\n\n  var devTools = getDevTools();\n\n  if (devTools) {\n    devTools.register(service);\n  }\n}\n\nexport { registerService };","import { __values, __assign, __spread } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { warn, mapContext, isFunction, keys, toSCXMLEvent, toInvokeSource, isPromiseLike, isObservable, isMachine, reportUnhandledExceptionOnInvocation, symbolObservable, isArray, toEventObject, isString, uniqueId } from './utils.js';\nimport { ActionTypes, SpecialTargets } from './types.js';\nimport { isInFinalState } from './stateUtils.js';\nimport { errorPlatform, log, stop, start, cancel, send, update, error as error$1 } from './actionTypes.js';\nimport { doneInvoke, initEvent, getActionFunction, error } from './actions.js';\nimport { isState, State, bindActionToState } from './State.js';\nimport { provide, consume } from './serviceScope.js';\nimport { isActor, createDeferredActor } from './Actor.js';\nimport { Scheduler } from './scheduler.js';\nimport { registry } from './registry.js';\nimport { registerService } from './devTools.js';\nvar DEFAULT_SPAWN_OPTIONS = {\n  sync: false,\n  autoForward: false\n};\nvar InterpreterStatus;\n\n(function (InterpreterStatus) {\n  InterpreterStatus[InterpreterStatus[\"NotStarted\"] = 0] = \"NotStarted\";\n  InterpreterStatus[InterpreterStatus[\"Running\"] = 1] = \"Running\";\n  InterpreterStatus[InterpreterStatus[\"Stopped\"] = 2] = \"Stopped\";\n})(InterpreterStatus || (InterpreterStatus = {}));\n\nvar Interpreter =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new Interpreter instance (i.e., service) for the given machine with the provided options, if any.\r\n   *\r\n   * @param machine The machine to be interpreted\r\n   * @param options Interpreter options\r\n   */\n  function Interpreter(machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = Interpreter.defaultOptions;\n    }\n\n    this.machine = machine;\n    this.scheduler = new Scheduler();\n    this.delayedEventsMap = {};\n    this.listeners = new Set();\n    this.contextListeners = new Set();\n    this.stopListeners = new Set();\n    this.doneListeners = new Set();\n    this.eventListeners = new Set();\n    this.sendListeners = new Set();\n    /**\r\n     * Whether the service is started.\r\n     */\n\n    this.initialized = false;\n    this._status = InterpreterStatus.NotStarted;\n    this.children = new Map();\n    this.forwardTo = new Set();\n    /**\r\n     * Alias for Interpreter.prototype.start\r\n     */\n\n    this.init = this.start;\n    /**\r\n     * Sends an event to the running interpreter to trigger a transition.\r\n     *\r\n     * An array of events (batched) can be sent as well, which will send all\r\n     * batched events to the running interpreter. The listeners will be\r\n     * notified only **once** when all events are processed.\r\n     *\r\n     * @param event The event(s) to send\r\n     */\n\n    this.send = function (event, payload) {\n      if (isArray(event)) {\n        _this.batch(event);\n\n        return _this.state;\n      }\n\n      var _event = toSCXMLEvent(toEventObject(event, payload));\n\n      if (_this._status === InterpreterStatus.Stopped) {\n        // do nothing\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to stopped service \\\"\" + _this.machine.id + \"\\\". This service has already reached its final state, and will not transition.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n\n        return _this.state;\n      }\n\n      if (_this._status === InterpreterStatus.NotStarted && _this.options.deferEvents) {\n        // tslint:disable-next-line:no-console\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\" and is deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n      } else if (_this._status !== InterpreterStatus.Running) {\n        throw new Error(\"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\\nEvent: \" + JSON.stringify(_event.data));\n      }\n\n      _this.scheduler.schedule(function () {\n        // Forward copy of event to child actors\n        _this.forward(_event);\n\n        var nextState = _this.nextState(_event);\n\n        _this.update(nextState, _event);\n      });\n\n      return _this._state; // TODO: deprecate (should return void)\n      // tslint:disable-next-line:semicolon\n    };\n\n    this.sendTo = function (event, to) {\n      var isParent = _this.parent && (to === SpecialTargets.Parent || _this.parent.id === to);\n      var target = isParent ? _this.parent : isActor(to) ? to : _this.children.get(to) || registry.get(to);\n\n      if (!target) {\n        if (!isParent) {\n          throw new Error(\"Unable to send event to child '\" + to + \"' from service '\" + _this.id + \"'.\");\n        } // tslint:disable-next-line:no-console\n\n\n        if (!IS_PRODUCTION) {\n          warn(false, \"Service '\" + _this.id + \"' has no parent: unable to send event \" + event.type);\n        }\n\n        return;\n      }\n\n      if ('machine' in target) {\n        // Send SCXML events to machines\n        target.send(__assign(__assign({}, event), {\n          name: event.name === error$1 ? \"\" + error(_this.id) : event.name,\n          origin: _this.sessionId\n        }));\n      } else {\n        // Send normal events to other targets\n        target.send(event.data);\n      }\n    };\n\n    var resolvedOptions = __assign(__assign({}, Interpreter.defaultOptions), options);\n\n    var clock = resolvedOptions.clock,\n        logger = resolvedOptions.logger,\n        parent = resolvedOptions.parent,\n        id = resolvedOptions.id;\n    var resolvedId = id !== undefined ? id : machine.id;\n    this.id = resolvedId;\n    this.logger = logger;\n    this.clock = clock;\n    this.parent = parent;\n    this.options = resolvedOptions;\n    this.scheduler = new Scheduler({\n      deferEvents: this.options.deferEvents\n    });\n    this.sessionId = registry.bookId();\n  }\n\n  Object.defineProperty(Interpreter.prototype, \"initialState\", {\n    get: function () {\n      var _this = this;\n\n      if (this._initialState) {\n        return this._initialState;\n      }\n\n      return provide(this, function () {\n        _this._initialState = _this.machine.initialState;\n        return _this._initialState;\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Interpreter.prototype, \"state\", {\n    get: function () {\n      if (!IS_PRODUCTION) {\n        warn(this._status !== InterpreterStatus.NotStarted, \"Attempted to read state from uninitialized service '\" + this.id + \"'. Make sure the service is started first.\");\n      }\n\n      return this._state;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Executes the actions of the given state, with that state's `context` and `event`.\r\n   *\r\n   * @param state The state whose actions will be executed\r\n   * @param actionsConfig The action implementations to use\r\n   */\n\n  Interpreter.prototype.execute = function (state, actionsConfig) {\n    var e_1, _a;\n\n    try {\n      for (var _b = __values(state.actions), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var action = _c.value;\n        this.exec(action, state, actionsConfig);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.update = function (state, _event) {\n    var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\n\n    var _this = this; // Attach session ID to state\n\n\n    state._sessionid = this.sessionId; // Update state\n\n    this._state = state; // Execute actions\n\n    if (this.options.execute) {\n      this.execute(this.state);\n    } // Dev tools\n\n\n    if (this.devTools) {\n      this.devTools.send(_event.data, state);\n    } // Execute listeners\n\n\n    if (state.event) {\n      try {\n        for (var _e = __values(this.eventListeners), _f = _e.next(); !_f.done; _f = _e.next()) {\n          var listener = _f.value;\n          listener(state.event);\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    try {\n      for (var _g = __values(this.listeners), _h = _g.next(); !_h.done; _h = _g.next()) {\n        var listener = _h.value;\n        listener(state, state.event);\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    try {\n      for (var _j = __values(this.contextListeners), _k = _j.next(); !_k.done; _k = _j.next()) {\n        var contextListener = _k.value;\n        contextListener(this.state.context, this.state.history ? this.state.history.context : undefined);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_k && !_k.done && (_c = _j.return)) _c.call(_j);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    var isDone = isInFinalState(state.configuration || [], this.machine);\n\n    if (this.state.configuration && isDone) {\n      // get final child state node\n      var finalChildStateNode = state.configuration.find(function (sn) {\n        return sn.type === 'final' && sn.parent === _this.machine;\n      });\n      var doneData = finalChildStateNode && finalChildStateNode.doneData ? mapContext(finalChildStateNode.doneData, state.context, _event) : undefined;\n\n      try {\n        for (var _l = __values(this.doneListeners), _m = _l.next(); !_m.done; _m = _l.next()) {\n          var listener = _m.value;\n          listener(doneInvoke(this.id, doneData));\n        }\n      } catch (e_5_1) {\n        e_5 = {\n          error: e_5_1\n        };\n      } finally {\n        try {\n          if (_m && !_m.done && (_d = _l.return)) _d.call(_l);\n        } finally {\n          if (e_5) throw e_5.error;\n        }\n      }\n\n      this.stop();\n    }\n  };\n  /*\r\n   * Adds a listener that is notified whenever a state transition happens. The listener is called with\r\n   * the next state and the event object that caused the state transition.\r\n   *\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onTransition = function (listener) {\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state, this.state.event);\n    }\n\n    return this;\n  };\n\n  Interpreter.prototype.subscribe = function (nextListenerOrObserver, _, // TODO: error listener\n  completeListener) {\n    var _this = this;\n\n    if (!nextListenerOrObserver) {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    }\n\n    var listener;\n    var resolvedCompleteListener = completeListener;\n\n    if (typeof nextListenerOrObserver === 'function') {\n      listener = nextListenerOrObserver;\n    } else {\n      listener = nextListenerOrObserver.next.bind(nextListenerOrObserver);\n      resolvedCompleteListener = nextListenerOrObserver.complete.bind(nextListenerOrObserver);\n    }\n\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state);\n    }\n\n    if (resolvedCompleteListener) {\n      this.onDone(resolvedCompleteListener);\n    }\n\n    return {\n      unsubscribe: function () {\n        listener && _this.listeners.delete(listener);\n        resolvedCompleteListener && _this.doneListeners.delete(resolvedCompleteListener);\n      }\n    };\n  };\n  /**\r\n   * Adds an event listener that is notified whenever an event is sent to the running interpreter.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onEvent = function (listener) {\n    this.eventListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds an event listener that is notified whenever a `send` event occurs.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onSend = function (listener) {\n    this.sendListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a context listener that is notified whenever the state context changes.\r\n   * @param listener The context listener\r\n   */\n\n\n  Interpreter.prototype.onChange = function (listener) {\n    this.contextListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a listener that is notified when the machine is stopped.\r\n   * @param listener The listener\r\n   */\n\n\n  Interpreter.prototype.onStop = function (listener) {\n    this.stopListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a state listener that is notified when the statechart has reached its final state.\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onDone = function (listener) {\n    this.doneListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Removes a listener.\r\n   * @param listener The listener to remove\r\n   */\n\n\n  Interpreter.prototype.off = function (listener) {\n    this.listeners.delete(listener);\n    this.eventListeners.delete(listener);\n    this.sendListeners.delete(listener);\n    this.stopListeners.delete(listener);\n    this.doneListeners.delete(listener);\n    this.contextListeners.delete(listener);\n    return this;\n  };\n  /**\r\n   * Starts the interpreter from the given state, or the initial state.\r\n   * @param initialState The state to start the statechart from\r\n   */\n\n\n  Interpreter.prototype.start = function (initialState) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.Running) {\n      // Do not restart the service if it is already started\n      return this;\n    }\n\n    registry.register(this.sessionId, this);\n    this.initialized = true;\n    this._status = InterpreterStatus.Running;\n    var resolvedState = initialState === undefined ? this.initialState : provide(this, function () {\n      return isState(initialState) ? _this.machine.resolveState(initialState) : _this.machine.resolveState(State.from(initialState, _this.machine.context));\n    });\n\n    if (this.options.devTools) {\n      this.attachDev();\n    }\n\n    this.scheduler.initialize(function () {\n      _this.update(resolvedState, initEvent);\n    });\n    return this;\n  };\n  /**\r\n   * Stops the interpreter and unsubscribe all listeners.\r\n   *\r\n   * This will also notify the `onStop` listeners.\r\n   */\n\n\n  Interpreter.prototype.stop = function () {\n    var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;\n\n    try {\n      for (var _f = __values(this.listeners), _g = _f.next(); !_g.done; _g = _f.next()) {\n        var listener = _g.value;\n        this.listeners.delete(listener);\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_g && !_g.done && (_a = _f.return)) _a.call(_f);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    try {\n      for (var _h = __values(this.stopListeners), _j = _h.next(); !_j.done; _j = _h.next()) {\n        var listener = _j.value; // call listener, then remove\n\n        listener();\n        this.stopListeners.delete(listener);\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    try {\n      for (var _k = __values(this.contextListeners), _l = _k.next(); !_l.done; _l = _k.next()) {\n        var listener = _l.value;\n        this.contextListeners.delete(listener);\n      }\n    } catch (e_8_1) {\n      e_8 = {\n        error: e_8_1\n      };\n    } finally {\n      try {\n        if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n      } finally {\n        if (e_8) throw e_8.error;\n      }\n    }\n\n    try {\n      for (var _m = __values(this.doneListeners), _o = _m.next(); !_o.done; _o = _m.next()) {\n        var listener = _o.value;\n        this.doneListeners.delete(listener);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (_o && !_o.done && (_d = _m.return)) _d.call(_m);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    } // Stop all children\n\n\n    this.children.forEach(function (child) {\n      if (isFunction(child.stop)) {\n        child.stop();\n      }\n    });\n\n    try {\n      // Cancel all delayed events\n      for (var _p = __values(keys(this.delayedEventsMap)), _q = _p.next(); !_q.done; _q = _p.next()) {\n        var key = _q.value;\n        this.clock.clearTimeout(this.delayedEventsMap[key]);\n      }\n    } catch (e_10_1) {\n      e_10 = {\n        error: e_10_1\n      };\n    } finally {\n      try {\n        if (_q && !_q.done && (_e = _p.return)) _e.call(_p);\n      } finally {\n        if (e_10) throw e_10.error;\n      }\n    }\n\n    this.scheduler.clear();\n    this.initialized = false;\n    this._status = InterpreterStatus.Stopped;\n    registry.free(this.sessionId);\n    return this;\n  };\n\n  Interpreter.prototype.batch = function (events) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.NotStarted && this.options.deferEvents) {\n      // tslint:disable-next-line:no-console\n      if (!IS_PRODUCTION) {\n        warn(false, events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\" and are deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(event));\n      }\n    } else if (this._status !== InterpreterStatus.Running) {\n      throw new Error( // tslint:disable-next-line:max-line-length\n      events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\");\n    }\n\n    this.scheduler.schedule(function () {\n      var e_11, _a;\n\n      var nextState = _this.state;\n      var batchChanged = false;\n      var batchedActions = [];\n\n      var _loop_1 = function (event_1) {\n        var _event = toSCXMLEvent(event_1);\n\n        _this.forward(_event);\n\n        nextState = provide(_this, function () {\n          return _this.machine.transition(nextState, _event);\n        });\n        batchedActions.push.apply(batchedActions, __spread(nextState.actions.map(function (a) {\n          return bindActionToState(a, nextState);\n        })));\n        batchChanged = batchChanged || !!nextState.changed;\n      };\n\n      try {\n        for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {\n          var event_1 = events_1_1.value;\n\n          _loop_1(event_1);\n        }\n      } catch (e_11_1) {\n        e_11 = {\n          error: e_11_1\n        };\n      } finally {\n        try {\n          if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);\n        } finally {\n          if (e_11) throw e_11.error;\n        }\n      }\n\n      nextState.changed = batchChanged;\n      nextState.actions = batchedActions;\n\n      _this.update(nextState, toSCXMLEvent(events[events.length - 1]));\n    });\n  };\n  /**\r\n   * Returns a send function bound to this interpreter instance.\r\n   *\r\n   * @param event The event to be sent by the sender.\r\n   */\n\n\n  Interpreter.prototype.sender = function (event) {\n    return this.send.bind(this, event);\n  };\n  /**\r\n   * Returns the next state given the interpreter's current state and the event.\r\n   *\r\n   * This is a pure method that does _not_ update the interpreter's state.\r\n   *\r\n   * @param event The event to determine the next state\r\n   */\n\n\n  Interpreter.prototype.nextState = function (event) {\n    var _this = this;\n\n    var _event = toSCXMLEvent(event);\n\n    if (_event.name.indexOf(errorPlatform) === 0 && !this.state.nextEvents.some(function (nextEvent) {\n      return nextEvent.indexOf(errorPlatform) === 0;\n    })) {\n      throw _event.data.data;\n    }\n\n    var nextState = provide(this, function () {\n      return _this.machine.transition(_this.state, _event);\n    });\n    return nextState;\n  };\n\n  Interpreter.prototype.forward = function (event) {\n    var e_12, _a;\n\n    try {\n      for (var _b = __values(this.forwardTo), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var id = _c.value;\n        var child = this.children.get(id);\n\n        if (!child) {\n          throw new Error(\"Unable to forward event '\" + event + \"' from interpreter '\" + this.id + \"' to nonexistant child '\" + id + \"'.\");\n        }\n\n        child.send(event);\n      }\n    } catch (e_12_1) {\n      e_12 = {\n        error: e_12_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_12) throw e_12.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.defer = function (sendAction) {\n    var _this = this;\n\n    this.delayedEventsMap[sendAction.id] = this.clock.setTimeout(function () {\n      if (sendAction.to) {\n        _this.sendTo(sendAction._event, sendAction.to);\n      } else {\n        _this.send(sendAction._event);\n      }\n    }, sendAction.delay);\n  };\n\n  Interpreter.prototype.cancel = function (sendId) {\n    this.clock.clearTimeout(this.delayedEventsMap[sendId]);\n    delete this.delayedEventsMap[sendId];\n  };\n\n  Interpreter.prototype.exec = function (action, state, actionFunctionMap) {\n    if (actionFunctionMap === void 0) {\n      actionFunctionMap = this.machine.options.actions;\n    }\n\n    var context = state.context,\n        _event = state._event;\n    var actionOrExec = action.exec || getActionFunction(action.type, actionFunctionMap);\n    var exec = isFunction(actionOrExec) ? actionOrExec : actionOrExec ? actionOrExec.exec : action.exec;\n\n    if (exec) {\n      try {\n        return exec(context, _event.data, {\n          action: action,\n          state: this.state,\n          _event: _event\n        });\n      } catch (err) {\n        if (this.parent) {\n          this.parent.send({\n            type: 'xstate.error',\n            data: err\n          });\n        }\n\n        throw err;\n      }\n    }\n\n    switch (action.type) {\n      case send:\n        var sendAction = action;\n\n        if (typeof sendAction.delay === 'number') {\n          this.defer(sendAction);\n          return;\n        } else {\n          if (sendAction.to) {\n            this.sendTo(sendAction._event, sendAction.to);\n          } else {\n            this.send(sendAction._event);\n          }\n        }\n\n        break;\n\n      case cancel:\n        this.cancel(action.sendId);\n        break;\n\n      case start:\n        {\n          var activity = action.activity; // If the activity will be stopped right after it's started\n          // (such as in transient states)\n          // don't bother starting the activity.\n\n          if (!this.state.activities[activity.id || activity.type]) {\n            break;\n          } // Invoked services\n\n\n          if (activity.type === ActionTypes.Invoke) {\n            var invokeSource = toInvokeSource(activity.src);\n            var serviceCreator = this.machine.options.services ? this.machine.options.services[invokeSource.type] : undefined;\n            var id = activity.id,\n                data = activity.data;\n\n            if (!IS_PRODUCTION) {\n              warn(!('forward' in activity), // tslint:disable-next-line:max-line-length\n              \"`forward` property is deprecated (found in invocation of '\" + activity.src + \"' in in machine '\" + this.machine.id + \"'). \" + \"Please use `autoForward` instead.\");\n            }\n\n            var autoForward = 'autoForward' in activity ? activity.autoForward : !!activity.forward;\n\n            if (!serviceCreator) {\n              // tslint:disable-next-line:no-console\n              if (!IS_PRODUCTION) {\n                warn(false, \"No service found for invocation '\" + activity.src + \"' in machine '\" + this.machine.id + \"'.\");\n              }\n\n              return;\n            }\n\n            var resolvedData = data ? mapContext(data, context, _event) : undefined;\n            var source = isFunction(serviceCreator) ? serviceCreator(context, _event.data, {\n              data: resolvedData,\n              src: invokeSource\n            }) : serviceCreator;\n\n            if (isPromiseLike(source)) {\n              this.state.children[id] = this.spawnPromise(Promise.resolve(source), id);\n            } else if (isFunction(source)) {\n              this.state.children[id] = this.spawnCallback(source, id);\n            } else if (isObservable(source)) {\n              this.state.children[id] = this.spawnObservable(source, id);\n            } else if (isMachine(source)) {\n              // TODO: try/catch here\n              this.state.children[id] = this.spawnMachine(resolvedData ? source.withContext(resolvedData) : source, {\n                id: id,\n                autoForward: autoForward\n              });\n            }\n          } else {\n            this.spawnActivity(activity);\n          }\n\n          break;\n        }\n\n      case stop:\n        {\n          this.stopChild(action.activity.id);\n          break;\n        }\n\n      case log:\n        var label = action.label,\n            value = action.value;\n\n        if (label) {\n          this.logger(label, value);\n        } else {\n          this.logger(value);\n        }\n\n        break;\n\n      default:\n        if (!IS_PRODUCTION) {\n          warn(false, \"No implementation found for action type '\" + action.type + \"'\");\n        }\n\n        break;\n    }\n\n    return undefined;\n  };\n\n  Interpreter.prototype.removeChild = function (childId) {\n    this.children.delete(childId);\n    this.forwardTo.delete(childId);\n    delete this.state.children[childId];\n  };\n\n  Interpreter.prototype.stopChild = function (childId) {\n    var child = this.children.get(childId);\n\n    if (!child) {\n      return;\n    }\n\n    this.removeChild(childId);\n\n    if (isFunction(child.stop)) {\n      child.stop();\n    }\n  };\n\n  Interpreter.prototype.spawn = function (entity, name, options) {\n    if (isPromiseLike(entity)) {\n      return this.spawnPromise(Promise.resolve(entity), name);\n    } else if (isFunction(entity)) {\n      return this.spawnCallback(entity, name);\n    } else if (isActor(entity)) {\n      return this.spawnActor(entity);\n    } else if (isObservable(entity)) {\n      return this.spawnObservable(entity, name);\n    } else if (isMachine(entity)) {\n      return this.spawnMachine(entity, __assign(__assign({}, options), {\n        id: name\n      }));\n    } else {\n      throw new Error(\"Unable to spawn entity \\\"\" + name + \"\\\" of type \\\"\" + typeof entity + \"\\\".\");\n    }\n  };\n\n  Interpreter.prototype.spawnMachine = function (machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var childService = new Interpreter(machine, __assign(__assign({}, this.options), {\n      parent: this,\n      id: options.id || machine.id\n    }));\n\n    var resolvedOptions = __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), options);\n\n    if (resolvedOptions.sync) {\n      childService.onTransition(function (state) {\n        _this.send(update, {\n          state: state,\n          id: childService.id\n        });\n      });\n    }\n\n    var actor = childService;\n    this.children.set(childService.id, actor);\n\n    if (resolvedOptions.autoForward) {\n      this.forwardTo.add(childService.id);\n    }\n\n    childService.onDone(function (doneEvent) {\n      _this.removeChild(childService.id);\n\n      _this.send(toSCXMLEvent(doneEvent, {\n        origin: childService.id\n      }));\n    }).start();\n    return actor;\n  };\n\n  Interpreter.prototype.spawnPromise = function (promise, id) {\n    var _this = this;\n\n    var canceled = false;\n    promise.then(function (response) {\n      if (!canceled) {\n        _this.removeChild(id);\n\n        _this.send(toSCXMLEvent(doneInvoke(id, response), {\n          origin: id\n        }));\n      }\n    }, function (errorData) {\n      if (!canceled) {\n        _this.removeChild(id);\n\n        var errorEvent = error(id, errorData);\n\n        try {\n          // Send \"error.platform.id\" to this (parent).\n          _this.send(toSCXMLEvent(errorEvent, {\n            origin: id\n          }));\n        } catch (error) {\n          reportUnhandledExceptionOnInvocation(errorData, error, id);\n\n          if (_this.devTools) {\n            _this.devTools.send(errorEvent, _this.state);\n          }\n\n          if (_this.machine.strict) {\n            // it would be better to always stop the state machine if unhandled\n            // exception/promise rejection happens but because we don't want to\n            // break existing code so enforce it on strict mode only especially so\n            // because documentation says that onError is optional\n            _this.stop();\n          }\n        }\n      }\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        var unsubscribed = false;\n        promise.then(function (response) {\n          if (unsubscribed) {\n            return;\n          }\n\n          next && next(response);\n\n          if (unsubscribed) {\n            return;\n          }\n\n          complete && complete();\n        }, function (err) {\n          if (unsubscribed) {\n            return;\n          }\n\n          handleError(err);\n        });\n        return {\n          unsubscribe: function () {\n            return unsubscribed = true;\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnCallback = function (callback, id) {\n    var _this = this;\n\n    var canceled = false;\n    var receivers = new Set();\n    var listeners = new Set();\n\n    var receive = function (e) {\n      listeners.forEach(function (listener) {\n        return listener(e);\n      });\n\n      if (canceled) {\n        return;\n      }\n\n      _this.send(e);\n    };\n\n    var callbackStop;\n\n    try {\n      callbackStop = callback(receive, function (newListener) {\n        receivers.add(newListener);\n      });\n    } catch (err) {\n      this.send(error(id, err));\n    }\n\n    if (isPromiseLike(callbackStop)) {\n      // it turned out to be an async function, can't reliably check this before calling `callback`\n      // because transpiled async functions are not recognizable\n      return this.spawnPromise(callbackStop, id);\n    }\n\n    var actor = {\n      id: id,\n      send: function (event) {\n        return receivers.forEach(function (receiver) {\n          return receiver(event);\n        });\n      },\n      subscribe: function (next) {\n        listeners.add(next);\n        return {\n          unsubscribe: function () {\n            listeners.delete(next);\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n\n        if (isFunction(callbackStop)) {\n          callbackStop();\n        }\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnObservable = function (source, id) {\n    var _this = this;\n\n    var subscription = source.subscribe(function (value) {\n      _this.send(toSCXMLEvent(value, {\n        origin: id\n      }));\n    }, function (err) {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(error(id, err), {\n        origin: id\n      }));\n    }, function () {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(doneInvoke(id), {\n        origin: id\n      }));\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        return source.subscribe(next, handleError, complete);\n      },\n      stop: function () {\n        return subscription.unsubscribe();\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActor = function (actor) {\n    this.children.set(actor.id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActivity = function (activity) {\n    var implementation = this.machine.options && this.machine.options.activities ? this.machine.options.activities[activity.type] : undefined;\n\n    if (!implementation) {\n      if (!IS_PRODUCTION) {\n        warn(false, \"No implementation found for activity '\" + activity.type + \"'\");\n      } // tslint:disable-next-line:no-console\n\n\n      return;\n    } // Start implementation\n\n\n    var dispose = implementation(this.state.context, activity);\n    this.spawnEffect(activity.id, dispose);\n  };\n\n  Interpreter.prototype.spawnEffect = function (id, dispose) {\n    this.children.set(id, {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function () {\n        return {\n          unsubscribe: function () {\n            return void 0;\n          }\n        };\n      },\n      stop: dispose || undefined,\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    });\n  };\n\n  Interpreter.prototype.attachDev = function () {\n    if (this.options.devTools && typeof window !== 'undefined') {\n      if (window.__REDUX_DEVTOOLS_EXTENSION__) {\n        var devToolsOptions = typeof this.options.devTools === 'object' ? this.options.devTools : undefined;\n        this.devTools = window.__REDUX_DEVTOOLS_EXTENSION__.connect(__assign(__assign({\n          name: this.id,\n          autoPause: true,\n          stateSanitizer: function (state) {\n            return {\n              value: state.value,\n              context: state.context,\n              actions: state.actions\n            };\n          }\n        }, devToolsOptions), {\n          features: __assign({\n            jump: false,\n            skip: false\n          }, devToolsOptions ? devToolsOptions.features : undefined)\n        }), this.machine);\n        this.devTools.init(this.state);\n      } // add XState-specific dev tooling hook\n\n\n      registerService(this);\n    }\n  };\n\n  Interpreter.prototype.toJSON = function () {\n    return {\n      id: this.id\n    };\n  };\n\n  Interpreter.prototype[symbolObservable] = function () {\n    return this;\n  };\n  /**\r\n   * The default interpreter options:\r\n   *\r\n   * - `clock` uses the global `setTimeout` and `clearTimeout` functions\r\n   * - `logger` uses the global `console.log()` method\r\n   */\n\n\n  Interpreter.defaultOptions = /*#__PURE__*/function (global) {\n    return {\n      execute: true,\n      deferEvents: true,\n      clock: {\n        setTimeout: function (fn, ms) {\n          return global.setTimeout.call(null, fn, ms);\n        },\n        clearTimeout: function (id) {\n          return global.clearTimeout.call(null, id);\n        }\n      },\n      logger: global.console.log.bind(console),\n      devTools: false\n    };\n  }(typeof self !== 'undefined' ? self : global);\n\n  Interpreter.interpret = interpret;\n  return Interpreter;\n}();\n\nvar resolveSpawnOptions = function (nameOrOptions) {\n  if (isString(nameOrOptions)) {\n    return __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n      name: nameOrOptions\n    });\n  }\n\n  return __assign(__assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n    name: uniqueId()\n  }), nameOrOptions);\n};\n\nfunction spawn(entity, nameOrOptions) {\n  var resolvedOptions = resolveSpawnOptions(nameOrOptions);\n  return consume(function (service) {\n    if (!IS_PRODUCTION) {\n      var isLazyEntity = isMachine(entity) || isFunction(entity);\n      warn(!!service || isLazyEntity, \"Attempted to spawn an Actor (ID: \\\"\" + (isMachine(entity) ? entity.id : 'undefined') + \"\\\") outside of a service. This will have no effect.\");\n    }\n\n    if (service) {\n      return service.spawn(entity, resolvedOptions.name, resolvedOptions);\n    } else {\n      return createDeferredActor(entity, resolvedOptions.name);\n    }\n  });\n}\n/**\r\n * Creates a new Interpreter instance for the given machine with the provided options, if any.\r\n *\r\n * @param machine The machine to interpret\r\n * @param options Interpreter options\r\n */\n\n\nfunction interpret(machine, options) {\n  var interpreter = new Interpreter(machine, options);\n  return interpreter;\n}\n\nexport { Interpreter, interpret, spawn };","import { __values, __read } from './_virtual/_tslib.js';\nimport { State } from './State.js';\n\nfunction matchState(state, patterns, defaultValue) {\n  var e_1, _a;\n\n  var resolvedState = State.from(state, state instanceof State ? state.context : undefined);\n\n  try {\n    for (var patterns_1 = __values(patterns), patterns_1_1 = patterns_1.next(); !patterns_1_1.done; patterns_1_1 = patterns_1.next()) {\n      var _b = __read(patterns_1_1.value, 2),\n          stateValue = _b[0],\n          getValue = _b[1];\n\n      if (resolvedState.matches(stateValue)) {\n        return getValue(resolvedState);\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (patterns_1_1 && !patterns_1_1.done && (_a = patterns_1.return)) _a.call(patterns_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return defaultValue(resolvedState);\n}\n\nexport { matchState };","export { matchesState } from './utils.js';\nexport { mapState } from './mapState.js';\nexport { ActionTypes, SpecialTargets } from './types.js';\nimport { raise, send, sendParent, sendUpdate, log, cancel, start, stop, assign, after, done, respond, forwardTo, escalate, choose, pure } from './actions.js';\nexport { assign, doneInvoke, forwardTo, send, sendParent, sendUpdate } from './actions.js';\nexport { State } from './State.js';\nexport { StateNode } from './StateNode.js';\nexport { Machine, createMachine } from './Machine.js';\nexport { Interpreter, interpret, spawn } from './interpreter.js';\nexport { matchState } from './match.js';\nvar actions = {\n  raise: raise,\n  send: send,\n  sendParent: sendParent,\n  sendUpdate: sendUpdate,\n  log: log,\n  cancel: cancel,\n  start: start,\n  stop: stop,\n  assign: assign,\n  after: after,\n  done: done,\n  respond: respond,\n  forwardTo: forwardTo,\n  escalate: escalate,\n  choose: choose,\n  pure: pure\n};\nexport { actions };","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TARGETLESS_KEY = exports.DEFAULT_GUARD_TYPE = exports.EMPTY_ACTIVITY_MAP = exports.STATE_DELIMITER = void 0;\nexports.STATE_DELIMITER = '.';\nexports.EMPTY_ACTIVITY_MAP = {};\nexports.DEFAULT_GUARD_TYPE = 'xstate.guard';\nexports.TARGETLESS_KEY = '';\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IS_PRODUCTION = void 0;\nexports.IS_PRODUCTION = process.env.NODE_ENV === 'production';\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toInvokeSource = exports.evaluateGuard = exports.reportUnhandledExceptionOnInvocation = exports.normalizeTarget = exports.toTransitionConfigArray = exports.toSCXMLEvent = exports.toEventObject = exports.uniqueId = exports.isActor = exports.isMachine = exports.symbolObservable = exports.isObservable = exports.toGuard = exports.isString = exports.isFunction = exports.isArray = exports.warn = exports.updateContext = exports.updateHistoryValue = exports.updateHistoryStates = exports.partition = exports.isPromiseLike = exports.isBuiltInEvent = exports.mapContext = exports.toArray = exports.toArrayStrict = exports.flatten = exports.pathsToStateValue = exports.toStatePaths = exports.nestedPath = exports.path = exports.mapFilterValues = exports.mapValues = exports.pathToStateValue = exports.toStateValue = exports.isStateLike = exports.toStatePath = exports.getActionType = exports.getEventType = exports.matchesState = exports.keys = void 0;\nvar constants_1 = require(\"./constants\");\nvar environment_1 = require(\"./environment\");\nfunction keys(value) {\n    return Object.keys(value);\n}\nexports.keys = keys;\nfunction matchesState(parentStateId, childStateId, delimiter) {\n    if (delimiter === void 0) { delimiter = constants_1.STATE_DELIMITER; }\n    var parentStateValue = toStateValue(parentStateId, delimiter);\n    var childStateValue = toStateValue(childStateId, delimiter);\n    if (isString(childStateValue)) {\n        if (isString(parentStateValue)) {\n            return childStateValue === parentStateValue;\n        }\n        // Parent more specific than child\n        return false;\n    }\n    if (isString(parentStateValue)) {\n        return parentStateValue in childStateValue;\n    }\n    return keys(parentStateValue).every(function (key) {\n        if (!(key in childStateValue)) {\n            return false;\n        }\n        return matchesState(parentStateValue[key], childStateValue[key]);\n    });\n}\nexports.matchesState = matchesState;\nfunction getEventType(event) {\n    try {\n        return isString(event) || typeof event === 'number'\n            ? \"\" + event\n            : event.type;\n    }\n    catch (e) {\n        throw new Error('Events must be strings or objects with a string event.type property.');\n    }\n}\nexports.getEventType = getEventType;\nfunction getActionType(action) {\n    try {\n        return isString(action) || typeof action === 'number'\n            ? \"\" + action\n            : isFunction(action)\n                ? action.name\n                : action.type;\n    }\n    catch (e) {\n        throw new Error('Actions must be strings or objects with a string action.type property.');\n    }\n}\nexports.getActionType = getActionType;\nfunction toStatePath(stateId, delimiter) {\n    try {\n        if (isArray(stateId)) {\n            return stateId;\n        }\n        return stateId.toString().split(delimiter);\n    }\n    catch (e) {\n        throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n    }\n}\nexports.toStatePath = toStatePath;\nfunction isStateLike(state) {\n    return (typeof state === 'object' &&\n        'value' in state &&\n        'context' in state &&\n        'event' in state &&\n        '_event' in state);\n}\nexports.isStateLike = isStateLike;\nfunction toStateValue(stateValue, delimiter) {\n    if (isStateLike(stateValue)) {\n        return stateValue.value;\n    }\n    if (isArray(stateValue)) {\n        return pathToStateValue(stateValue);\n    }\n    if (typeof stateValue !== 'string') {\n        return stateValue;\n    }\n    var statePath = toStatePath(stateValue, delimiter);\n    return pathToStateValue(statePath);\n}\nexports.toStateValue = toStateValue;\nfunction pathToStateValue(statePath) {\n    if (statePath.length === 1) {\n        return statePath[0];\n    }\n    var value = {};\n    var marker = value;\n    for (var i = 0; i < statePath.length - 1; i++) {\n        if (i === statePath.length - 2) {\n            marker[statePath[i]] = statePath[i + 1];\n        }\n        else {\n            marker[statePath[i]] = {};\n            marker = marker[statePath[i]];\n        }\n    }\n    return value;\n}\nexports.pathToStateValue = pathToStateValue;\nfunction mapValues(collection, iteratee) {\n    var result = {};\n    var collectionKeys = keys(collection);\n    for (var i = 0; i < collectionKeys.length; i++) {\n        var key = collectionKeys[i];\n        result[key] = iteratee(collection[key], key, collection, i);\n    }\n    return result;\n}\nexports.mapValues = mapValues;\nfunction mapFilterValues(collection, iteratee, predicate) {\n    var e_1, _a;\n    var result = {};\n    try {\n        for (var _b = __values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var key = _c.value;\n            var item = collection[key];\n            if (!predicate(item)) {\n                continue;\n            }\n            result[key] = iteratee(item, key, collection);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return result;\n}\nexports.mapFilterValues = mapFilterValues;\n/**\n * Retrieves a value at the given path.\n * @param props The deep path to the prop of the desired value\n */\nexports.path = function (props) { return function (object) {\n    var e_2, _a;\n    var result = object;\n    try {\n        for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n            var prop = props_1_1.value;\n            result = result[prop];\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return result;\n}; };\n/**\n * Retrieves a value at the given path via the nested accessor prop.\n * @param props The deep path to the prop of the desired value\n */\nfunction nestedPath(props, accessorProp) {\n    return function (object) {\n        var e_3, _a;\n        var result = object;\n        try {\n            for (var props_2 = __values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n                var prop = props_2_1.value;\n                result = result[accessorProp][prop];\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n        return result;\n    };\n}\nexports.nestedPath = nestedPath;\nfunction toStatePaths(stateValue) {\n    if (!stateValue) {\n        return [[]];\n    }\n    if (isString(stateValue)) {\n        return [[stateValue]];\n    }\n    var result = flatten(keys(stateValue).map(function (key) {\n        var subStateValue = stateValue[key];\n        if (typeof subStateValue !== 'string' &&\n            (!subStateValue || !Object.keys(subStateValue).length)) {\n            return [[key]];\n        }\n        return toStatePaths(stateValue[key]).map(function (subPath) {\n            return [key].concat(subPath);\n        });\n    }));\n    return result;\n}\nexports.toStatePaths = toStatePaths;\nfunction pathsToStateValue(paths) {\n    var e_4, _a;\n    var result = {};\n    if (paths && paths.length === 1 && paths[0].length === 1) {\n        return paths[0][0];\n    }\n    try {\n        for (var paths_1 = __values(paths), paths_1_1 = paths_1.next(); !paths_1_1.done; paths_1_1 = paths_1.next()) {\n            var currentPath = paths_1_1.value;\n            var marker = result;\n            // tslint:disable-next-line:prefer-for-of\n            for (var i = 0; i < currentPath.length; i++) {\n                var subPath = currentPath[i];\n                if (i === currentPath.length - 2) {\n                    marker[subPath] = currentPath[i + 1];\n                    break;\n                }\n                marker[subPath] = marker[subPath] || {};\n                marker = marker[subPath];\n            }\n        }\n    }\n    catch (e_4_1) { e_4 = { error: e_4_1 }; }\n    finally {\n        try {\n            if (paths_1_1 && !paths_1_1.done && (_a = paths_1.return)) _a.call(paths_1);\n        }\n        finally { if (e_4) throw e_4.error; }\n    }\n    return result;\n}\nexports.pathsToStateValue = pathsToStateValue;\nfunction flatten(array) {\n    var _a;\n    return (_a = []).concat.apply(_a, __spread(array));\n}\nexports.flatten = flatten;\nfunction toArrayStrict(value) {\n    if (isArray(value)) {\n        return value;\n    }\n    return [value];\n}\nexports.toArrayStrict = toArrayStrict;\nfunction toArray(value) {\n    if (value === undefined) {\n        return [];\n    }\n    return toArrayStrict(value);\n}\nexports.toArray = toArray;\nfunction mapContext(mapper, context, _event) {\n    var e_5, _a;\n    if (isFunction(mapper)) {\n        return mapper(context, _event.data);\n    }\n    var result = {};\n    try {\n        for (var _b = __values(Object.keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var key = _c.value;\n            var subMapper = mapper[key];\n            if (isFunction(subMapper)) {\n                result[key] = subMapper(context, _event.data);\n            }\n            else {\n                result[key] = subMapper;\n            }\n        }\n    }\n    catch (e_5_1) { e_5 = { error: e_5_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_5) throw e_5.error; }\n    }\n    return result;\n}\nexports.mapContext = mapContext;\nfunction isBuiltInEvent(eventType) {\n    return /^(done|error)\\./.test(eventType);\n}\nexports.isBuiltInEvent = isBuiltInEvent;\nfunction isPromiseLike(value) {\n    if (value instanceof Promise) {\n        return true;\n    }\n    // Check if shape matches the Promise/A+ specification for a \"thenable\".\n    if (value !== null &&\n        (isFunction(value) || typeof value === 'object') &&\n        isFunction(value.then)) {\n        return true;\n    }\n    return false;\n}\nexports.isPromiseLike = isPromiseLike;\nfunction partition(items, predicate) {\n    var e_6, _a;\n    var _b = __read([[], []], 2), truthy = _b[0], falsy = _b[1];\n    try {\n        for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n            var item = items_1_1.value;\n            if (predicate(item)) {\n                truthy.push(item);\n            }\n            else {\n                falsy.push(item);\n            }\n        }\n    }\n    catch (e_6_1) { e_6 = { error: e_6_1 }; }\n    finally {\n        try {\n            if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n        }\n        finally { if (e_6) throw e_6.error; }\n    }\n    return [truthy, falsy];\n}\nexports.partition = partition;\nfunction updateHistoryStates(hist, stateValue) {\n    return mapValues(hist.states, function (subHist, key) {\n        if (!subHist) {\n            return undefined;\n        }\n        var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) ||\n            (subHist ? subHist.current : undefined);\n        if (!subStateValue) {\n            return undefined;\n        }\n        return {\n            current: subStateValue,\n            states: updateHistoryStates(subHist, subStateValue)\n        };\n    });\n}\nexports.updateHistoryStates = updateHistoryStates;\nfunction updateHistoryValue(hist, stateValue) {\n    return {\n        current: stateValue,\n        states: updateHistoryStates(hist, stateValue)\n    };\n}\nexports.updateHistoryValue = updateHistoryValue;\nfunction updateContext(context, _event, assignActions, state) {\n    if (!environment_1.IS_PRODUCTION) {\n        warn(!!context, 'Attempting to update undefined context');\n    }\n    var updatedContext = context\n        ? assignActions.reduce(function (acc, assignAction) {\n            var e_7, _a;\n            var assignment = assignAction.assignment;\n            var meta = {\n                state: state,\n                action: assignAction,\n                _event: _event\n            };\n            var partialUpdate = {};\n            if (isFunction(assignment)) {\n                partialUpdate = assignment(acc, _event.data, meta);\n            }\n            else {\n                try {\n                    for (var _b = __values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n                        var key = _c.value;\n                        var propAssignment = assignment[key];\n                        partialUpdate[key] = isFunction(propAssignment)\n                            ? propAssignment(acc, _event.data, meta)\n                            : propAssignment;\n                    }\n                }\n                catch (e_7_1) { e_7 = { error: e_7_1 }; }\n                finally {\n                    try {\n                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                    }\n                    finally { if (e_7) throw e_7.error; }\n                }\n            }\n            return Object.assign({}, acc, partialUpdate);\n        }, context)\n        : context;\n    return updatedContext;\n}\nexports.updateContext = updateContext;\n// tslint:disable-next-line:no-empty\nvar warn = function () { };\nexports.warn = warn;\nif (!environment_1.IS_PRODUCTION) {\n    exports.warn = warn = function (condition, message) {\n        var error = condition instanceof Error ? condition : undefined;\n        if (!error && condition) {\n            return;\n        }\n        if (console !== undefined) {\n            var args = [\"Warning: \" + message];\n            if (error) {\n                args.push(error);\n            }\n            // tslint:disable-next-line:no-console\n            console.warn.apply(console, args);\n        }\n    };\n}\nfunction isArray(value) {\n    return Array.isArray(value);\n}\nexports.isArray = isArray;\n// tslint:disable-next-line:ban-types\nfunction isFunction(value) {\n    return typeof value === 'function';\n}\nexports.isFunction = isFunction;\nfunction isString(value) {\n    return typeof value === 'string';\n}\nexports.isString = isString;\n// export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\nfunction toGuard(condition, guardMap) {\n    if (!condition) {\n        return undefined;\n    }\n    if (isString(condition)) {\n        return {\n            type: constants_1.DEFAULT_GUARD_TYPE,\n            name: condition,\n            predicate: guardMap ? guardMap[condition] : undefined\n        };\n    }\n    if (isFunction(condition)) {\n        return {\n            type: constants_1.DEFAULT_GUARD_TYPE,\n            name: condition.name,\n            predicate: condition\n        };\n    }\n    return condition;\n}\nexports.toGuard = toGuard;\nfunction isObservable(value) {\n    try {\n        return 'subscribe' in value && isFunction(value.subscribe);\n    }\n    catch (e) {\n        return false;\n    }\n}\nexports.isObservable = isObservable;\nexports.symbolObservable = (function () {\n    return (typeof Symbol === 'function' && Symbol.observable) || '@@observable';\n})();\nfunction isMachine(value) {\n    try {\n        return '__xstatenode' in value;\n    }\n    catch (e) {\n        return false;\n    }\n}\nexports.isMachine = isMachine;\nfunction isActor(value) {\n    return !!value && typeof value.send === 'function';\n}\nexports.isActor = isActor;\nexports.uniqueId = (function () {\n    var currentId = 0;\n    return function () {\n        currentId++;\n        return currentId.toString(16);\n    };\n})();\nfunction toEventObject(event, payload\n// id?: TEvent['type']\n) {\n    if (isString(event) || typeof event === 'number') {\n        return __assign({ type: event }, payload);\n    }\n    return event;\n}\nexports.toEventObject = toEventObject;\nfunction toSCXMLEvent(event, scxmlEvent) {\n    if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n        return event;\n    }\n    var eventObject = toEventObject(event);\n    return __assign({ name: eventObject.type, data: eventObject, $$type: 'scxml', type: 'external' }, scxmlEvent);\n}\nexports.toSCXMLEvent = toSCXMLEvent;\nfunction toTransitionConfigArray(event, configLike) {\n    var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n        if (typeof transitionLike === 'undefined' ||\n            typeof transitionLike === 'string' ||\n            isMachine(transitionLike)) {\n            return { target: transitionLike, event: event };\n        }\n        return __assign(__assign({}, transitionLike), { event: event });\n    });\n    return transitions;\n}\nexports.toTransitionConfigArray = toTransitionConfigArray;\nfunction normalizeTarget(target) {\n    if (target === undefined || target === constants_1.TARGETLESS_KEY) {\n        return undefined;\n    }\n    return toArray(target);\n}\nexports.normalizeTarget = normalizeTarget;\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n    if (!environment_1.IS_PRODUCTION) {\n        var originalStackTrace = originalError.stack\n            ? \" Stacktrace was '\" + originalError.stack + \"'\"\n            : '';\n        if (originalError === currentError) {\n            // tslint:disable-next-line:no-console\n            console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n        }\n        else {\n            var stackTrace = currentError.stack\n                ? \" Stacktrace was '\" + currentError.stack + \"'\"\n                : '';\n            // tslint:disable-next-line:no-console\n            console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" +\n                (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n        }\n    }\n}\nexports.reportUnhandledExceptionOnInvocation = reportUnhandledExceptionOnInvocation;\nfunction evaluateGuard(machine, guard, context, _event, state) {\n    var guards = machine.options.guards;\n    var guardMeta = {\n        state: state,\n        cond: guard,\n        _event: _event\n    };\n    // TODO: do not hardcode!\n    if (guard.type === constants_1.DEFAULT_GUARD_TYPE) {\n        return guard.predicate(context, _event.data, guardMeta);\n    }\n    var condFn = guards[guard.type];\n    if (!condFn) {\n        throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + machine.id + \"'.\");\n    }\n    return condFn(context, _event.data, guardMeta);\n}\nexports.evaluateGuard = evaluateGuard;\nfunction toInvokeSource(src) {\n    if (typeof src === 'string') {\n        return { type: src };\n    }\n    return src;\n}\nexports.toInvokeSource = toInvokeSource;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { createMachine, assign, interpret } from 'xstate';\nimport { toSCXMLEvent, toEventObject } from 'xstate/lib/utils';\nvar serviceMap = new Map();\nexport function createDevTools() {\n    var services = new Set();\n    var serviceListeners = new Set();\n    window.__xstate__ = {\n        services: services,\n        register: function (service) {\n            services.add(service);\n            serviceMap.set(service.sessionId, service);\n            serviceListeners.forEach(function (listener) { return listener(service); });\n            service.onStop(function () {\n                services.delete(service);\n                serviceMap.delete(service.sessionId);\n            });\n        },\n        unregister: function (service) {\n            services.delete(service);\n            serviceMap.delete(service.sessionId);\n        },\n        onRegister: function (listener) {\n            serviceListeners.add(listener);\n            services.forEach(function (service) { return listener(service); });\n            return {\n                unsubscribe: function () {\n                    serviceListeners.delete(listener);\n                }\n            };\n        }\n    };\n}\nexport var inspectMachine = createMachine({\n    initial: 'pendingConnection',\n    context: {\n        client: undefined\n    },\n    states: {\n        pendingConnection: {},\n        connected: {\n            on: {\n                'service.state': {\n                    actions: function (ctx, e) { return ctx.client.send(e); }\n                },\n                'service.event': {\n                    actions: function (ctx, e) { return ctx.client.send(e); }\n                },\n                'service.register': {\n                    actions: function (ctx, e) { return ctx.client.send(e); }\n                },\n                'service.stop': {\n                    actions: function (ctx, e) { return ctx.client.send(e); }\n                },\n                'xstate.event': {\n                    actions: function (_, e) {\n                        var event = e.event;\n                        var scxmlEventObject = JSON.parse(event);\n                        var service = serviceMap.get(scxmlEventObject.origin);\n                        service === null || service === void 0 ? void 0 : service.send(JSON.parse(event));\n                    }\n                },\n                unload: {\n                    actions: function (ctx) {\n                        ctx.client.send({ type: 'xstate.disconnect' });\n                    }\n                },\n                disconnect: 'pendingConnection'\n            }\n        }\n    },\n    on: {\n        'xstate.inspecting': {\n            target: '.connected',\n            actions: [\n                assign({ client: function (_, e) { return e.client; } }),\n                function (ctx) {\n                    globalThis.__xstate__.services.forEach(function (service) {\n                        ctx.client.send({\n                            type: 'service.register',\n                            machine: JSON.stringify(service.machine),\n                            state: JSON.stringify(service.state || service.initialState),\n                            sessionId: service.sessionId\n                        });\n                    });\n                }\n            ]\n        }\n    }\n});\nvar defaultInspectorOptions = {\n    url: 'https://statecharts.io/inspect',\n    iframe: function () { return document.querySelector('iframe[data-xstate]'); }\n};\nexport function inspect(options) {\n    createDevTools();\n    var _a = __assign(__assign({}, defaultInspectorOptions), options), iframe = _a.iframe, url = _a.url;\n    var resolvedIframe = typeof iframe === 'function' ? iframe() : iframe;\n    var targetWindow;\n    var inspectService = interpret(inspectMachine).start();\n    if (resolvedIframe === null) {\n        console.warn('No suitable <iframe> found to embed the inspector. Please pass an <iframe> element to `inspect(iframe)` or create an <iframe data-xstate></iframe> element.');\n        return { disconnect: function () { return void 0; } };\n    }\n    var client;\n    var messageHandler = function (event) {\n        if (typeof event.data === 'object' &&\n            event.data !== null &&\n            'type' in event.data) {\n            if (resolvedIframe && !targetWindow) {\n                targetWindow = resolvedIframe.contentWindow;\n            }\n            if (!client) {\n                client = {\n                    send: function (e) {\n                        targetWindow.postMessage(e, url);\n                    }\n                };\n            }\n            inspectService.send(__assign(__assign({}, event.data), { client: client }));\n        }\n    };\n    window.addEventListener('message', messageHandler);\n    window.addEventListener('unload', function () {\n        inspectService.send({ type: 'unload' });\n    });\n    if (resolvedIframe === false) {\n        targetWindow = window.open(url, 'xstateinspector');\n    }\n    globalThis.__xstate__.onRegister(function (service) {\n        var _a;\n        inspectService.send({\n            type: 'service.register',\n            machine: JSON.stringify(service.machine),\n            state: JSON.stringify(service.state || service.initialState),\n            sessionId: service.sessionId,\n            id: service.id,\n            parent: (_a = service.parent) === null || _a === void 0 ? void 0 : _a.sessionId\n        });\n        inspectService.send({\n            type: 'service.event',\n            event: JSON.stringify((service.state || service.initialState)._event),\n            sessionId: service.sessionId\n        });\n        // monkey-patch service.send so that we know when an event was sent\n        // to a service *before* it is processed, since other events might occur\n        // while the sent one is being processed, which throws the order off\n        var originalSend = service.send.bind(service);\n        service.send = function inspectSend(event, payload) {\n            inspectService.send({\n                type: 'service.event',\n                event: JSON.stringify(toSCXMLEvent(toEventObject(event, payload))),\n                sessionId: service.sessionId\n            });\n            return originalSend(event, payload);\n        };\n        service.subscribe(function (state) {\n            inspectService.send({\n                type: 'service.state',\n                state: JSON.stringify(state),\n                sessionId: service.sessionId\n            });\n        });\n        service.onStop(function () {\n            inspectService.send({\n                type: 'service.stop',\n                sessionId: service.sessionId\n            });\n        });\n    });\n    if (resolvedIframe) {\n        resolvedIframe.addEventListener('load', function () {\n            targetWindow = resolvedIframe.contentWindow;\n        });\n        resolvedIframe.setAttribute('src', url);\n    }\n    return {\n        disconnect: function () {\n            inspectService.send('disconnect');\n            window.removeEventListener('message', messageHandler);\n        }\n    };\n}\n","const errors = {\n\t0: \"Illegal state\",\n\t1: \"Immer drafts cannot have computed properties\",\n\t2: \"This object has been frozen and should not be mutated\",\n\t3(data: any) {\n\t\treturn (\n\t\t\t\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \" +\n\t\t\tdata\n\t\t)\n\t},\n\t4: \"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",\n\t5: \"Immer forbids circular references\",\n\t6: \"The first or second argument to `produce` must be a function\",\n\t7: \"The third argument to `produce` must be a function or undefined\",\n\t8: \"First argument to `createDraft` must be a plain object, an array, or an immerable object\",\n\t9: \"First argument to `finishDraft` must be a draft returned by `createDraft`\",\n\t10: \"The given draft is already finalized\",\n\t11: \"Object.defineProperty() cannot be used on an Immer draft\",\n\t12: \"Object.setPrototypeOf() cannot be used on an Immer draft\",\n\t13: \"Immer only supports deleting array indices\",\n\t14: \"Immer only supports setting array indices and the 'length' property\",\n\t15(path: string) {\n\t\treturn \"Cannot apply patch, path doesn't resolve: \" + path\n\t},\n\t16: 'Sets cannot have \"replace\" patches.',\n\t17(op: string) {\n\t\treturn \"Unsupported patch operation: \" + op\n\t},\n\t18(plugin: string) {\n\t\treturn `The plugin for '${plugin}' has not been loaded into Immer. To enable the plugin, import and call \\`enable${plugin}()\\` when initializing your application.`\n\t},\n\t19: \"plugin not loaded\",\n\t20: \"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\",\n\t21(thing: string) {\n\t\treturn `produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${thing}'`\n\t},\n\t22(thing: string) {\n\t\treturn `'current' expects a draft, got: ${thing}`\n\t},\n\t23(thing: string) {\n\t\treturn `'original' expects a draft, got: ${thing}`\n\t}\n} as const\n\nexport function die(error: keyof typeof errors, ...args: any[]): never {\n\tif (__DEV__) {\n\t\tconst e = errors[error]\n\t\tconst msg = !e\n\t\t\t? \"unknown error nr: \" + error\n\t\t\t: typeof e === \"function\"\n\t\t\t? e.apply(null, args as any)\n\t\t\t: e\n\t\tthrow new Error(`[Immer] ${msg}`)\n\t}\n\tthrow new Error(\n\t\t`[Immer] minified error nr: ${error}${\n\t\t\targs.length ? \" \" + args.join(\",\") : \"\"\n\t\t}. Find the full error at: https://bit.ly/3cXEKWf`\n\t)\n}\n","import {\n\tDRAFT_STATE,\n\tDRAFTABLE,\n\thasSet,\n\tObjectish,\n\tDrafted,\n\tAnyObject,\n\tAnyMap,\n\tAnySet,\n\tImmerState,\n\thasMap,\n\tArchtypeObject,\n\tArchtypeArray,\n\tArchtypeMap,\n\tArchtypeSet,\n\tdie\n} from \"../internal\"\n\n/** Returns true if the given value is an Immer draft */\n/*#__PURE__*/\nexport function isDraft(value: any): boolean {\n\treturn !!value && !!value[DRAFT_STATE]\n}\n\n/** Returns true if the given value can be drafted by Immer */\n/*#__PURE__*/\nexport function isDraftable(value: any): boolean {\n\tif (!value) return false\n\treturn (\n\t\tisPlainObject(value) ||\n\t\tArray.isArray(value) ||\n\t\t!!value[DRAFTABLE] ||\n\t\t!!value.constructor[DRAFTABLE] ||\n\t\tisMap(value) ||\n\t\tisSet(value)\n\t)\n}\n\n/*#__PURE__*/\nexport function isPlainObject(value: any): boolean {\n\tif (!value || typeof value !== \"object\") return false\n\tconst proto = Object.getPrototypeOf(value)\n\treturn !proto || proto === Object.prototype\n}\n\n/** Get the underlying object that is represented by the given draft */\n/*#__PURE__*/\nexport function original<T>(value: T): T | undefined\nexport function original(value: Drafted<any>): any {\n\tif (!isDraft(value)) die(23, value)\n\treturn value[DRAFT_STATE].base_\n}\n\n/*#__PURE__*/\nexport const ownKeys: (target: AnyObject) => PropertyKey[] =\n\ttypeof Reflect !== \"undefined\" && Reflect.ownKeys\n\t\t? Reflect.ownKeys\n\t\t: typeof Object.getOwnPropertySymbols !== \"undefined\"\n\t\t? obj =>\n\t\t\t\tObject.getOwnPropertyNames(obj).concat(\n\t\t\t\t\tObject.getOwnPropertySymbols(obj) as any\n\t\t\t\t)\n\t\t: /* istanbul ignore next */ Object.getOwnPropertyNames\n\nexport const getOwnPropertyDescriptors =\n\tObject.getOwnPropertyDescriptors ||\n\tfunction getOwnPropertyDescriptors(target: any) {\n\t\t// Polyfill needed for Hermes and IE, see https://github.com/facebook/hermes/issues/274\n\t\tconst res: any = {}\n\t\townKeys(target).forEach(key => {\n\t\t\tres[key] = Object.getOwnPropertyDescriptor(target, key)\n\t\t})\n\t\treturn res\n\t}\n\nexport function each<T extends Objectish>(\n\tobj: T,\n\titer: (key: string | number, value: any, source: T) => void,\n\tenumerableOnly?: boolean\n): void\nexport function each(obj: any, iter: any, enumerableOnly = false) {\n\tif (getArchtype(obj) === ArchtypeObject) {\n\t\t;(enumerableOnly ? Object.keys : ownKeys)(obj).forEach(key => {\n\t\t\tif (!enumerableOnly || typeof key !== \"symbol\") iter(key, obj[key], obj)\n\t\t})\n\t} else {\n\t\tobj.forEach((entry: any, index: any) => iter(index, entry, obj))\n\t}\n}\n\n/*#__PURE__*/\nexport function getArchtype(thing: any): 0 | 1 | 2 | 3 {\n\t/* istanbul ignore next */\n\tconst state: undefined | ImmerState = thing[DRAFT_STATE]\n\treturn state\n\t\t? state.type_ > 3\n\t\t\t? state.type_ - 4 // cause Object and Array map back from 4 and 5\n\t\t\t: (state.type_ as any) // others are the same\n\t\t: Array.isArray(thing)\n\t\t? ArchtypeArray\n\t\t: isMap(thing)\n\t\t? ArchtypeMap\n\t\t: isSet(thing)\n\t\t? ArchtypeSet\n\t\t: ArchtypeObject\n}\n\n/*#__PURE__*/\nexport function has(thing: any, prop: PropertyKey): boolean {\n\treturn getArchtype(thing) === ArchtypeMap\n\t\t? thing.has(prop)\n\t\t: Object.prototype.hasOwnProperty.call(thing, prop)\n}\n\n/*#__PURE__*/\nexport function get(thing: AnyMap | AnyObject, prop: PropertyKey): any {\n\t// @ts-ignore\n\treturn getArchtype(thing) === ArchtypeMap ? thing.get(prop) : thing[prop]\n}\n\n/*#__PURE__*/\nexport function set(thing: any, propOrOldValue: PropertyKey, value: any) {\n\tconst t = getArchtype(thing)\n\tif (t === ArchtypeMap) thing.set(propOrOldValue, value)\n\telse if (t === ArchtypeSet) {\n\t\tthing.delete(propOrOldValue)\n\t\tthing.add(value)\n\t} else thing[propOrOldValue] = value\n}\n\n/*#__PURE__*/\nexport function is(x: any, y: any): boolean {\n\t// From: https://github.com/facebook/fbjs/blob/c69904a511b900266935168223063dd8772dfc40/packages/fbjs/src/core/shallowEqual.js\n\tif (x === y) {\n\t\treturn x !== 0 || 1 / x === 1 / y\n\t} else {\n\t\treturn x !== x && y !== y\n\t}\n}\n\n/*#__PURE__*/\nexport function isMap(target: any): target is AnyMap {\n\treturn hasMap && target instanceof Map\n}\n\n/*#__PURE__*/\nexport function isSet(target: any): target is AnySet {\n\treturn hasSet && target instanceof Set\n}\n/*#__PURE__*/\nexport function latest(state: ImmerState): any {\n\treturn state.copy_ || state.base_\n}\n\n/*#__PURE__*/\nexport function shallowCopy(base: any) {\n\tif (Array.isArray(base)) return Array.prototype.slice.call(base)\n\tconst descriptors = getOwnPropertyDescriptors(base)\n\tdelete descriptors[DRAFT_STATE as any]\n\tlet keys = ownKeys(descriptors)\n\tfor (let i = 0; i < keys.length; i++) {\n\t\tconst key: any = keys[i]\n\t\tconst desc = descriptors[key]\n\t\tif (desc.writable === false) {\n\t\t\tdesc.writable = true\n\t\t\tdesc.configurable = true\n\t\t}\n\t\t// like object.assign, we will read any _own_, get/set accessors. This helps in dealing\n\t\t// with libraries that trap values, like mobx or vue\n\t\t// unlike object.assign, non-enumerables will be copied as well\n\t\tif (desc.get || desc.set)\n\t\t\tdescriptors[key] = {\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true, // could live with !!desc.set as well here...\n\t\t\t\tenumerable: desc.enumerable,\n\t\t\t\tvalue: base[key]\n\t\t\t}\n\t}\n\treturn Object.create(Object.getPrototypeOf(base), descriptors)\n}\n\nexport function freeze(obj: any, deep: boolean): void {\n\tif (isFrozen(obj) || isDraft(obj) || !isDraftable(obj)) return\n\tif (getArchtype(obj) > 1 /* Map or Set */) {\n\t\tobj.set = obj.add = obj.clear = obj.delete = dontMutateFrozenCollections as any\n\t}\n\tObject.freeze(obj)\n\tif (deep) each(obj, (key, value) => freeze(value, true), true)\n}\n\nfunction dontMutateFrozenCollections() {\n\tdie(2)\n}\n\nexport function isFrozen(obj: any): boolean {\n\tif (obj == null || typeof obj !== \"object\") return true\n\t// See #600, IE dies on non-objects in Object.isFrozen\n\treturn Object.isFrozen(obj)\n}\n","import {\n\tSetState,\n\tImmerScope,\n\tProxyObjectState,\n\tProxyArrayState,\n\tES5ObjectState,\n\tES5ArrayState,\n\tMapState,\n\tDRAFT_STATE\n} from \"../internal\"\n\nexport type Objectish = AnyObject | AnyArray | AnyMap | AnySet\nexport type ObjectishNoSet = AnyObject | AnyArray | AnyMap\n\nexport type AnyObject = {[key: string]: any}\nexport type AnyArray = Array<any>\nexport type AnySet = Set<any>\nexport type AnyMap = Map<any, any>\n\nexport const ArchtypeObject = 0\nexport const ArchtypeArray = 1\nexport const ArchtypeMap = 2\nexport const ArchtypeSet = 3\n\nexport const ProxyTypeProxyObject = 0\nexport const ProxyTypeProxyArray = 1\nexport const ProxyTypeES5Object = 4\nexport const ProxyTypeES5Array = 5\nexport const ProxyTypeMap = 2\nexport const ProxyTypeSet = 3\n\nexport interface ImmerBaseState {\n\tparent_?: ImmerState\n\tscope_: ImmerScope\n\tmodified_: boolean\n\tfinalized_: boolean\n\tisManual_: boolean\n}\n\nexport type ImmerState =\n\t| ProxyObjectState\n\t| ProxyArrayState\n\t| ES5ObjectState\n\t| ES5ArrayState\n\t| MapState\n\t| SetState\n\n// The _internal_ type used for drafts (not to be confused with Draft, which is public facing)\nexport type Drafted<Base = any, T extends ImmerState = ImmerState> = {\n\t[DRAFT_STATE]: T\n} & Base\n","import {\n\tImmerState,\n\tPatch,\n\tImmerScope,\n\tDrafted,\n\tAnyObject,\n\tImmerBaseState,\n\tAnyMap,\n\tAnySet,\n\tProxyTypeES5Array,\n\tProxyTypeES5Object,\n\tProxyTypeMap,\n\tProxyTypeSet,\n\tdie\n} from \"../internal\"\n\n/** Plugin utilities */\nconst plugins: {\n\tPatches?: {\n\t\tgeneratePatches_(\n\t\t\tstate: ImmerState,\n\t\t\tbasePath: PatchPath,\n\t\t\tpatches: Patch[],\n\t\t\tinversePatches: Patch[]\n\t\t): void\n\t\tgenerateReplacementPatches_(\n\t\t\trootState: ImmerState,\n\t\t\treplacement: any,\n\t\t\tpatches: Patch[],\n\t\t\tinversePatches: Patch[]\n\t\t): void\n\t\tapplyPatches_<T>(draft: T, patches: Patch[]): T\n\t}\n\tES5?: {\n\t\twillFinalizeES5_(scope: ImmerScope, result: any, isReplaced: boolean): void\n\t\tcreateES5Proxy_<T>(\n\t\t\tbase: T,\n\t\t\tparent?: ImmerState\n\t\t): Drafted<T, ES5ObjectState | ES5ArrayState>\n\t\thasChanges_(state: ES5ArrayState | ES5ObjectState): boolean\n\t}\n\tMapSet?: {\n\t\tproxyMap_<T extends AnyMap>(target: T, parent?: ImmerState): T\n\t\tproxySet_<T extends AnySet>(target: T, parent?: ImmerState): T\n\t}\n} = {}\n\ntype Plugins = typeof plugins\n\nexport function getPlugin<K extends keyof Plugins>(\n\tpluginKey: K\n): Exclude<Plugins[K], undefined> {\n\tconst plugin = plugins[pluginKey]\n\tif (!plugin) {\n\t\tdie(__DEV__ ? 18 : 19, pluginKey)\n\t}\n\t// @ts-ignore\n\treturn plugin\n}\n\nexport function loadPlugin<K extends keyof Plugins>(\n\tpluginKey: K,\n\timplementation: Plugins[K]\n): void {\n\tplugins[pluginKey] = implementation\n}\n\n/** ES5 Plugin */\n\ninterface ES5BaseState extends ImmerBaseState {\n\tassigned_: {[key: string]: any}\n\tparent_?: ImmerState\n\trevoked_: boolean\n}\n\nexport interface ES5ObjectState extends ES5BaseState {\n\ttype_: typeof ProxyTypeES5Object\n\tdraft_: Drafted<AnyObject, ES5ObjectState>\n\tbase_: AnyObject\n\tcopy_: AnyObject | null\n}\n\nexport interface ES5ArrayState extends ES5BaseState {\n\ttype_: typeof ProxyTypeES5Array\n\tdraft_: Drafted<AnyObject, ES5ArrayState>\n\tbase_: any\n\tcopy_: any\n}\n\n/** Map / Set plugin */\n\nexport interface MapState extends ImmerBaseState {\n\ttype_: typeof ProxyTypeMap\n\tcopy_: AnyMap | undefined\n\tassigned_: Map<any, boolean> | undefined\n\tbase_: AnyMap\n\trevoked_: boolean\n\tdraft_: Drafted<AnyMap, MapState>\n}\n\nexport interface SetState extends ImmerBaseState {\n\ttype_: typeof ProxyTypeSet\n\tcopy_: AnySet | undefined\n\tbase_: AnySet\n\tdrafts_: Map<any, Drafted> // maps the original value to the draft value in the new set\n\trevoked_: boolean\n\tdraft_: Drafted<AnySet, SetState>\n}\n\n/** Patches plugin */\n\nexport type PatchPath = (string | number)[]\n","import {\n\tPatch,\n\tPatchListener,\n\tDrafted,\n\tImmer,\n\tDRAFT_STATE,\n\tImmerState,\n\tProxyTypeProxyObject,\n\tProxyTypeProxyArray,\n\tgetPlugin\n} from \"../internal\"\nimport {die} from \"../utils/errors\"\n\n/** Each scope represents a `produce` call. */\n\nexport interface ImmerScope {\n\tpatches_?: Patch[]\n\tinversePatches_?: Patch[]\n\tcanAutoFreeze_: boolean\n\tdrafts_: any[]\n\tparent_?: ImmerScope\n\tpatchListener_?: PatchListener\n\timmer_: Immer\n\tunfinalizedDrafts_: number\n}\n\nlet currentScope: ImmerScope | undefined\n\nexport function getCurrentScope() {\n\tif (__DEV__ && !currentScope) die(0)\n\treturn currentScope!\n}\n\nfunction createScope(\n\tparent_: ImmerScope | undefined,\n\timmer_: Immer\n): ImmerScope {\n\treturn {\n\t\tdrafts_: [],\n\t\tparent_,\n\t\timmer_,\n\t\t// Whenever the modified draft contains a draft from another scope, we\n\t\t// need to prevent auto-freezing so the unowned draft can be finalized.\n\t\tcanAutoFreeze_: true,\n\t\tunfinalizedDrafts_: 0\n\t}\n}\n\nexport function usePatchesInScope(\n\tscope: ImmerScope,\n\tpatchListener?: PatchListener\n) {\n\tif (patchListener) {\n\t\tgetPlugin(\"Patches\") // assert we have the plugin\n\t\tscope.patches_ = []\n\t\tscope.inversePatches_ = []\n\t\tscope.patchListener_ = patchListener\n\t}\n}\n\nexport function revokeScope(scope: ImmerScope) {\n\tleaveScope(scope)\n\tscope.drafts_.forEach(revokeDraft)\n\t// @ts-ignore\n\tscope.drafts_ = null\n}\n\nexport function leaveScope(scope: ImmerScope) {\n\tif (scope === currentScope) {\n\t\tcurrentScope = scope.parent_\n\t}\n}\n\nexport function enterScope(immer: Immer) {\n\treturn (currentScope = createScope(currentScope, immer))\n}\n\nfunction revokeDraft(draft: Drafted) {\n\tconst state: ImmerState = draft[DRAFT_STATE]\n\tif (\n\t\tstate.type_ === ProxyTypeProxyObject ||\n\t\tstate.type_ === ProxyTypeProxyArray\n\t)\n\t\tstate.revoke_()\n\telse state.revoked_ = true\n}\n","import {\n\tImmerScope,\n\tDRAFT_STATE,\n\tisDraftable,\n\tNOTHING,\n\tPatchPath,\n\teach,\n\thas,\n\tfreeze,\n\tImmerState,\n\tisDraft,\n\tSetState,\n\tset,\n\tProxyTypeES5Object,\n\tProxyTypeES5Array,\n\tProxyTypeSet,\n\tgetPlugin,\n\tdie,\n\trevokeScope,\n\tisFrozen,\n\tshallowCopy\n} from \"../internal\"\n\nexport function processResult(result: any, scope: ImmerScope) {\n\tscope.unfinalizedDrafts_ = scope.drafts_.length\n\tconst baseDraft = scope.drafts_![0]\n\tconst isReplaced = result !== undefined && result !== baseDraft\n\tif (!scope.immer_.useProxies_)\n\t\tgetPlugin(\"ES5\").willFinalizeES5_(scope, result, isReplaced)\n\tif (isReplaced) {\n\t\tif (baseDraft[DRAFT_STATE].modified_) {\n\t\t\trevokeScope(scope)\n\t\t\tdie(4)\n\t\t}\n\t\tif (isDraftable(result)) {\n\t\t\t// Finalize the result in case it contains (or is) a subset of the draft.\n\t\t\tresult = finalize(scope, result)\n\t\t\tif (!scope.parent_) maybeFreeze(scope, result)\n\t\t}\n\t\tif (scope.patches_) {\n\t\t\tgetPlugin(\"Patches\").generateReplacementPatches_(\n\t\t\t\tbaseDraft[DRAFT_STATE],\n\t\t\t\tresult,\n\t\t\t\tscope.patches_,\n\t\t\t\tscope.inversePatches_!\n\t\t\t)\n\t\t}\n\t} else {\n\t\t// Finalize the base draft.\n\t\tresult = finalize(scope, baseDraft, [])\n\t}\n\trevokeScope(scope)\n\tif (scope.patches_) {\n\t\tscope.patchListener_!(scope.patches_, scope.inversePatches_!)\n\t}\n\treturn result !== NOTHING ? result : undefined\n}\n\nfunction finalize(rootScope: ImmerScope, value: any, path?: PatchPath) {\n\t// Don't recurse in tho recursive data structures\n\tif (isFrozen(value)) return value\n\n\tconst state: ImmerState = value[DRAFT_STATE]\n\t// A plain object, might need freezing, might contain drafts\n\tif (!state) {\n\t\teach(\n\t\t\tvalue,\n\t\t\t(key, childValue) =>\n\t\t\t\tfinalizeProperty(rootScope, state, value, key, childValue, path),\n\t\t\ttrue // See #590, don't recurse into non-enumarable of non drafted objects\n\t\t)\n\t\treturn value\n\t}\n\t// Never finalize drafts owned by another scope.\n\tif (state.scope_ !== rootScope) return value\n\t// Unmodified draft, return the (frozen) original\n\tif (!state.modified_) {\n\t\tmaybeFreeze(rootScope, state.base_, true)\n\t\treturn state.base_\n\t}\n\t// Not finalized yet, let's do that now\n\tif (!state.finalized_) {\n\t\tstate.finalized_ = true\n\t\tstate.scope_.unfinalizedDrafts_--\n\t\tconst result =\n\t\t\t// For ES5, create a good copy from the draft first, with added keys and without deleted keys.\n\t\t\tstate.type_ === ProxyTypeES5Object || state.type_ === ProxyTypeES5Array\n\t\t\t\t? (state.copy_ = shallowCopy(state.draft_))\n\t\t\t\t: state.copy_\n\t\t// Finalize all children of the copy\n\t\t// For sets we clone before iterating, otherwise we can get in endless loop due to modifying during iteration, see #628\n\t\t// Although the original test case doesn't seem valid anyway, so if this in the way we can turn the next line\n\t\t// back to each(result, ....)\n\t\teach(\n\t\t\tstate.type_ === ProxyTypeSet ? new Set(result) : result,\n\t\t\t(key, childValue) =>\n\t\t\t\tfinalizeProperty(rootScope, state, result, key, childValue, path)\n\t\t)\n\t\t// everything inside is frozen, we can freeze here\n\t\tmaybeFreeze(rootScope, result, false)\n\t\t// first time finalizing, let's create those patches\n\t\tif (path && rootScope.patches_) {\n\t\t\tgetPlugin(\"Patches\").generatePatches_(\n\t\t\t\tstate,\n\t\t\t\tpath,\n\t\t\t\trootScope.patches_,\n\t\t\t\trootScope.inversePatches_!\n\t\t\t)\n\t\t}\n\t}\n\treturn state.copy_\n}\n\nfunction finalizeProperty(\n\trootScope: ImmerScope,\n\tparentState: undefined | ImmerState,\n\ttargetObject: any,\n\tprop: string | number,\n\tchildValue: any,\n\trootPath?: PatchPath\n) {\n\tif (__DEV__ && childValue === targetObject) die(5)\n\tif (isDraft(childValue)) {\n\t\tconst path =\n\t\t\trootPath &&\n\t\t\tparentState &&\n\t\t\tparentState!.type_ !== ProxyTypeSet && // Set objects are atomic since they have no keys.\n\t\t\t!has((parentState as Exclude<ImmerState, SetState>).assigned_!, prop) // Skip deep patches for assigned keys.\n\t\t\t\t? rootPath!.concat(prop)\n\t\t\t\t: undefined\n\t\t// Drafts owned by `scope` are finalized here.\n\t\tconst res = finalize(rootScope, childValue, path)\n\t\tset(targetObject, prop, res)\n\t\t// Drafts from another scope must prevented to be frozen\n\t\t// if we got a draft back from finalize, we're in a nested produce and shouldn't freeze\n\t\tif (isDraft(res)) {\n\t\t\trootScope.canAutoFreeze_ = false\n\t\t} else return\n\t}\n\t// Search new objects for unfinalized drafts. Frozen objects should never contain drafts.\n\tif (isDraftable(childValue) && !isFrozen(childValue)) {\n\t\tif (!rootScope.immer_.autoFreeze_ && rootScope.unfinalizedDrafts_ < 1) {\n\t\t\t// optimization: if an object is not a draft, and we don't have to\n\t\t\t// deepfreeze everything, and we are sure that no drafts are left in the remaining object\n\t\t\t// cause we saw and finalized all drafts already; we can stop visiting the rest of the tree.\n\t\t\t// This benefits especially adding large data tree's without further processing.\n\t\t\t// See add-data.js perf test\n\t\t\treturn\n\t\t}\n\t\tfinalize(rootScope, childValue)\n\t\t// immer deep freezes plain objects, so if there is no parent state, we freeze as well\n\t\tif (!parentState || !parentState.scope_.parent_)\n\t\t\tmaybeFreeze(rootScope, childValue)\n\t}\n}\n\nfunction maybeFreeze(scope: ImmerScope, value: any, deep = false) {\n\tif (scope.immer_.autoFreeze_ && scope.canAutoFreeze_) {\n\t\tfreeze(value, deep)\n\t}\n}\n","import {\n\teach,\n\thas,\n\tis,\n\tisDraftable,\n\tshallowCopy,\n\tlatest,\n\tImmerBaseState,\n\tImmerState,\n\tDrafted,\n\tAnyObject,\n\tAnyArray,\n\tObjectish,\n\tgetCurrentScope,\n\tDRAFT_STATE,\n\tdie,\n\tcreateProxy,\n\tProxyTypeProxyObject,\n\tProxyTypeProxyArray\n} from \"../internal\"\n\ninterface ProxyBaseState extends ImmerBaseState {\n\tassigned_: {\n\t\t[property: string]: boolean\n\t}\n\tparent_?: ImmerState\n\trevoke_(): void\n}\n\nexport interface ProxyObjectState extends ProxyBaseState {\n\ttype_: typeof ProxyTypeProxyObject\n\tbase_: any\n\tcopy_: any\n\tdraft_: Drafted<AnyObject, ProxyObjectState>\n}\n\nexport interface ProxyArrayState extends ProxyBaseState {\n\ttype_: typeof ProxyTypeProxyArray\n\tbase_: AnyArray\n\tcopy_: AnyArray | null\n\tdraft_: Drafted<AnyArray, ProxyArrayState>\n}\n\ntype ProxyState = ProxyObjectState | ProxyArrayState\n\n/**\n * Returns a new draft of the `base` object.\n *\n * The second argument is the parent draft-state (used internally).\n */\nexport function createProxyProxy<T extends Objectish>(\n\tbase: T,\n\tparent?: ImmerState\n): Drafted<T, ProxyState> {\n\tconst isArray = Array.isArray(base)\n\tconst state: ProxyState = {\n\t\ttype_: isArray ? ProxyTypeProxyArray : (ProxyTypeProxyObject as any),\n\t\t// Track which produce call this is associated with.\n\t\tscope_: parent ? parent.scope_ : getCurrentScope()!,\n\t\t// True for both shallow and deep changes.\n\t\tmodified_: false,\n\t\t// Used during finalization.\n\t\tfinalized_: false,\n\t\t// Track which properties have been assigned (true) or deleted (false).\n\t\tassigned_: {},\n\t\t// The parent draft state.\n\t\tparent_: parent,\n\t\t// The base state.\n\t\tbase_: base,\n\t\t// The base proxy.\n\t\tdraft_: null as any, // set below\n\t\t// The base copy with any updated values.\n\t\tcopy_: null,\n\t\t// Called by the `produce` function.\n\t\trevoke_: null as any,\n\t\tisManual_: false\n\t}\n\n\t// the traps must target something, a bit like the 'real' base.\n\t// but also, we need to be able to determine from the target what the relevant state is\n\t// (to avoid creating traps per instance to capture the state in closure,\n\t// and to avoid creating weird hidden properties as well)\n\t// So the trick is to use 'state' as the actual 'target'! (and make sure we intercept everything)\n\t// Note that in the case of an array, we put the state in an array to have better Reflect defaults ootb\n\tlet target: T = state as any\n\tlet traps: ProxyHandler<object | Array<any>> = objectTraps\n\tif (isArray) {\n\t\ttarget = [state] as any\n\t\ttraps = arrayTraps\n\t}\n\n\tconst {revoke, proxy} = Proxy.revocable(target, traps)\n\tstate.draft_ = proxy as any\n\tstate.revoke_ = revoke\n\treturn proxy as any\n}\n\n/**\n * Object drafts\n */\nexport const objectTraps: ProxyHandler<ProxyState> = {\n\tget(state, prop) {\n\t\tif (prop === DRAFT_STATE) return state\n\n\t\tconst source = latest(state)\n\t\tif (!has(source, prop)) {\n\t\t\t// non-existing or non-own property...\n\t\t\treturn readPropFromProto(state, source, prop)\n\t\t}\n\t\tconst value = source[prop]\n\t\tif (state.finalized_ || !isDraftable(value)) {\n\t\t\treturn value\n\t\t}\n\t\t// Check for existing draft in modified state.\n\t\t// Assigned values are never drafted. This catches any drafts we created, too.\n\t\tif (value === peek(state.base_, prop)) {\n\t\t\tprepareCopy(state)\n\t\t\treturn (state.copy_![prop as any] = createProxy(\n\t\t\t\tstate.scope_.immer_,\n\t\t\t\tvalue,\n\t\t\t\tstate\n\t\t\t))\n\t\t}\n\t\treturn value\n\t},\n\thas(state, prop) {\n\t\treturn prop in latest(state)\n\t},\n\townKeys(state) {\n\t\treturn Reflect.ownKeys(latest(state))\n\t},\n\tset(state, prop: string /* strictly not, but helps TS */, value) {\n\t\tconst desc = getDescriptorFromProto(latest(state), prop)\n\t\tif (desc?.set) {\n\t\t\t// special case: if this write is captured by a setter, we have\n\t\t\t// to trigger it with the correct context\n\t\t\tdesc.set.call(state.draft_, value)\n\t\t\treturn true\n\t\t}\n\t\tstate.assigned_[prop] = true\n\t\tif (!state.modified_) {\n\t\t\t// the last check is because we need to be able to distinguish setting a non-existig to undefined (which is a change)\n\t\t\t// from setting an existing property with value undefined to undefined (which is not a change)\n\t\t\tif (\n\t\t\t\tis(value, peek(latest(state), prop)) &&\n\t\t\t\t(value !== undefined || has(state.base_, prop))\n\t\t\t)\n\t\t\t\treturn true\n\t\t\tprepareCopy(state)\n\t\t\tmarkChanged(state)\n\t\t}\n\t\t// @ts-ignore\n\t\tstate.copy_![prop] = value\n\t\treturn true\n\t},\n\tdeleteProperty(state, prop: string) {\n\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\tif (peek(state.base_, prop) !== undefined || prop in state.base_) {\n\t\t\tstate.assigned_[prop] = false\n\t\t\tprepareCopy(state)\n\t\t\tmarkChanged(state)\n\t\t} else {\n\t\t\t// if an originally not assigned property was deleted\n\t\t\tdelete state.assigned_[prop]\n\t\t}\n\t\t// @ts-ignore\n\t\tif (state.copy_) delete state.copy_[prop]\n\t\treturn true\n\t},\n\t// Note: We never coerce `desc.value` into an Immer draft, because we can't make\n\t// the same guarantee in ES5 mode.\n\tgetOwnPropertyDescriptor(state, prop) {\n\t\tconst owner = latest(state)\n\t\tconst desc = Reflect.getOwnPropertyDescriptor(owner, prop)\n\t\tif (!desc) return desc\n\t\treturn {\n\t\t\twritable: true,\n\t\t\tconfigurable: state.type_ !== ProxyTypeProxyArray || prop !== \"length\",\n\t\t\tenumerable: desc.enumerable,\n\t\t\tvalue: owner[prop]\n\t\t}\n\t},\n\tdefineProperty() {\n\t\tdie(11)\n\t},\n\tgetPrototypeOf(state) {\n\t\treturn Object.getPrototypeOf(state.base_)\n\t},\n\tsetPrototypeOf() {\n\t\tdie(12)\n\t}\n}\n\n/**\n * Array drafts\n */\n\nconst arrayTraps: ProxyHandler<[ProxyArrayState]> = {}\neach(objectTraps, (key, fn) => {\n\t// @ts-ignore\n\tarrayTraps[key] = function() {\n\t\targuments[0] = arguments[0][0]\n\t\treturn fn.apply(this, arguments)\n\t}\n})\narrayTraps.deleteProperty = function(state, prop) {\n\tif (__DEV__ && isNaN(parseInt(prop as any))) die(13)\n\treturn objectTraps.deleteProperty!.call(this, state[0], prop)\n}\narrayTraps.set = function(state, prop, value) {\n\tif (__DEV__ && prop !== \"length\" && isNaN(parseInt(prop as any))) die(14)\n\treturn objectTraps.set!.call(this, state[0], prop, value, state[0])\n}\n\n// Access a property without creating an Immer draft.\nfunction peek(draft: Drafted, prop: PropertyKey) {\n\tconst state = draft[DRAFT_STATE]\n\tconst source = state ? latest(state) : draft\n\treturn source[prop]\n}\n\nfunction readPropFromProto(state: ImmerState, source: any, prop: PropertyKey) {\n\tconst desc = getDescriptorFromProto(source, prop)\n\treturn desc\n\t\t? `value` in desc\n\t\t\t? desc.value\n\t\t\t: // This is a very special case, if the prop is a getter defined by the\n\t\t\t  // prototype, we should invoke it with the draft as context!\n\t\t\t  desc.get?.call(state.draft_)\n\t\t: undefined\n}\n\nfunction getDescriptorFromProto(\n\tsource: any,\n\tprop: PropertyKey\n): PropertyDescriptor | undefined {\n\t// 'in' checks proto!\n\tif (!(prop in source)) return undefined\n\tlet proto = Object.getPrototypeOf(source)\n\twhile (proto) {\n\t\tconst desc = Object.getOwnPropertyDescriptor(proto, prop)\n\t\tif (desc) return desc\n\t\tproto = Object.getPrototypeOf(proto)\n\t}\n\treturn undefined\n}\n\nexport function markChanged(state: ImmerState) {\n\tif (!state.modified_) {\n\t\tstate.modified_ = true\n\t\tif (state.parent_) {\n\t\t\tmarkChanged(state.parent_)\n\t\t}\n\t}\n}\n\nexport function prepareCopy(state: {base_: any; copy_: any}) {\n\tif (!state.copy_) {\n\t\tstate.copy_ = shallowCopy(state.base_)\n\t}\n}\n","import {\n\tIProduceWithPatches,\n\tIProduce,\n\tImmerState,\n\tDrafted,\n\tisDraftable,\n\tprocessResult,\n\tPatch,\n\tObjectish,\n\tDRAFT_STATE,\n\tDraft,\n\tPatchListener,\n\tisDraft,\n\tisMap,\n\tisSet,\n\tcreateProxyProxy,\n\tgetPlugin,\n\tdie,\n\thasProxies,\n\tisMinified,\n\tenterScope,\n\trevokeScope,\n\tleaveScope,\n\tusePatchesInScope,\n\tgetCurrentScope,\n\tNOTHING,\n\tfreeze,\n\tcurrent\n} from \"../internal\"\n\ninterface ProducersFns {\n\tproduce: IProduce\n\tproduceWithPatches: IProduceWithPatches\n}\n\nexport class Immer implements ProducersFns {\n\tuseProxies_: boolean = hasProxies\n\n\tautoFreeze_: boolean = __DEV__ ? true /* istanbul ignore next */ : !isMinified\n\n\tconstructor(config?: {useProxies?: boolean; autoFreeze?: boolean}) {\n\t\tif (typeof config?.useProxies === \"boolean\")\n\t\t\tthis.setUseProxies(config!.useProxies)\n\t\tif (typeof config?.autoFreeze === \"boolean\")\n\t\t\tthis.setAutoFreeze(config!.autoFreeze)\n\t\tthis.produce = this.produce.bind(this)\n\t\tthis.produceWithPatches = this.produceWithPatches.bind(this)\n\t}\n\n\t/**\n\t * The `produce` function takes a value and a \"recipe function\" (whose\n\t * return value often depends on the base state). The recipe function is\n\t * free to mutate its first argument however it wants. All mutations are\n\t * only ever applied to a __copy__ of the base state.\n\t *\n\t * Pass only a function to create a \"curried producer\" which relieves you\n\t * from passing the recipe function every time.\n\t *\n\t * Only plain objects and arrays are made mutable. All other objects are\n\t * considered uncopyable.\n\t *\n\t * Note: This function is __bound__ to its `Immer` instance.\n\t *\n\t * @param {any} base - the initial state\n\t * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\n\t * @param {Function} patchListener - optional function that will be called with all the patches produced here\n\t * @returns {any} a new state, or the initial state if nothing was modified\n\t */\n\tproduce(base: any, recipe?: any, patchListener?: any) {\n\t\t// curried invocation\n\t\tif (typeof base === \"function\" && typeof recipe !== \"function\") {\n\t\t\tconst defaultBase = recipe\n\t\t\trecipe = base\n\n\t\t\tconst self = this\n\t\t\treturn function curriedProduce(\n\t\t\t\tthis: any,\n\t\t\t\tbase = defaultBase,\n\t\t\t\t...args: any[]\n\t\t\t) {\n\t\t\t\treturn self.produce(base, (draft: Drafted) => recipe.call(this, draft, ...args)) // prettier-ignore\n\t\t\t}\n\t\t}\n\n\t\tif (typeof recipe !== \"function\") die(6)\n\t\tif (patchListener !== undefined && typeof patchListener !== \"function\")\n\t\t\tdie(7)\n\n\t\tlet result\n\n\t\t// Only plain objects, arrays, and \"immerable classes\" are drafted.\n\t\tif (isDraftable(base)) {\n\t\t\tconst scope = enterScope(this)\n\t\t\tconst proxy = createProxy(this, base, undefined)\n\t\t\tlet hasError = true\n\t\t\ttry {\n\t\t\t\tresult = recipe(proxy)\n\t\t\t\thasError = false\n\t\t\t} finally {\n\t\t\t\t// finally instead of catch + rethrow better preserves original stack\n\t\t\t\tif (hasError) revokeScope(scope)\n\t\t\t\telse leaveScope(scope)\n\t\t\t}\n\t\t\tif (typeof Promise !== \"undefined\" && result instanceof Promise) {\n\t\t\t\treturn result.then(\n\t\t\t\t\tresult => {\n\t\t\t\t\t\tusePatchesInScope(scope, patchListener)\n\t\t\t\t\t\treturn processResult(result, scope)\n\t\t\t\t\t},\n\t\t\t\t\terror => {\n\t\t\t\t\t\trevokeScope(scope)\n\t\t\t\t\t\tthrow error\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t}\n\t\t\tusePatchesInScope(scope, patchListener)\n\t\t\treturn processResult(result, scope)\n\t\t} else if (!base || typeof base !== \"object\") {\n\t\t\tresult = recipe(base)\n\t\t\tif (result === NOTHING) return undefined\n\t\t\tif (result === undefined) result = base\n\t\t\tif (this.autoFreeze_) freeze(result, true)\n\t\t\treturn result\n\t\t} else die(21, base)\n\t}\n\n\tproduceWithPatches(arg1: any, arg2?: any, arg3?: any): any {\n\t\tif (typeof arg1 === \"function\") {\n\t\t\treturn (state: any, ...args: any[]) =>\n\t\t\t\tthis.produceWithPatches(state, (draft: any) => arg1(draft, ...args))\n\t\t}\n\n\t\tlet patches: Patch[], inversePatches: Patch[]\n\t\tconst nextState = this.produce(arg1, arg2, (p: Patch[], ip: Patch[]) => {\n\t\t\tpatches = p\n\t\t\tinversePatches = ip\n\t\t})\n\t\treturn [nextState, patches!, inversePatches!]\n\t}\n\n\tcreateDraft<T extends Objectish>(base: T): Draft<T> {\n\t\tif (!isDraftable(base)) die(8)\n\t\tif (isDraft(base)) base = current(base)\n\t\tconst scope = enterScope(this)\n\t\tconst proxy = createProxy(this, base, undefined)\n\t\tproxy[DRAFT_STATE].isManual_ = true\n\t\tleaveScope(scope)\n\t\treturn proxy as any\n\t}\n\n\tfinishDraft<D extends Draft<any>>(\n\t\tdraft: D,\n\t\tpatchListener?: PatchListener\n\t): D extends Draft<infer T> ? T : never {\n\t\tconst state: ImmerState = draft && (draft as any)[DRAFT_STATE]\n\t\tif (__DEV__) {\n\t\t\tif (!state || !state.isManual_) die(9)\n\t\t\tif (state.finalized_) die(10)\n\t\t}\n\t\tconst {scope_: scope} = state\n\t\tusePatchesInScope(scope, patchListener)\n\t\treturn processResult(undefined, scope)\n\t}\n\n\t/**\n\t * Pass true to automatically freeze all copies created by Immer.\n\t *\n\t * By default, auto-freezing is disabled in production.\n\t */\n\tsetAutoFreeze(value: boolean) {\n\t\tthis.autoFreeze_ = value\n\t}\n\n\t/**\n\t * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\n\t * always faster than using ES5 proxies.\n\t *\n\t * By default, feature detection is used, so calling this is rarely necessary.\n\t */\n\tsetUseProxies(value: boolean) {\n\t\tif (value && !hasProxies) {\n\t\t\tdie(20)\n\t\t}\n\t\tthis.useProxies_ = value\n\t}\n\n\tapplyPatches(base: Objectish, patches: Patch[]) {\n\t\t// If a patch replaces the entire state, take that replacement as base\n\t\t// before applying patches\n\t\tlet i: number\n\t\tfor (i = patches.length - 1; i >= 0; i--) {\n\t\t\tconst patch = patches[i]\n\t\t\tif (patch.path.length === 0 && patch.op === \"replace\") {\n\t\t\t\tbase = patch.value\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tconst applyPatchesImpl = getPlugin(\"Patches\").applyPatches_\n\t\tif (isDraft(base)) {\n\t\t\t// N.B: never hits if some patch a replacement, patches are never drafts\n\t\t\treturn applyPatchesImpl(base, patches)\n\t\t}\n\t\t// Otherwise, produce a copy of the base state.\n\t\treturn this.produce(base, (draft: Drafted) =>\n\t\t\tapplyPatchesImpl(draft, patches.slice(i + 1))\n\t\t)\n\t}\n}\n\nexport function createProxy<T extends Objectish>(\n\timmer: Immer,\n\tvalue: T,\n\tparent?: ImmerState\n): Drafted<T, ImmerState> {\n\t// precondition: createProxy should be guarded by isDraftable, so we know we can safely draft\n\tconst draft: Drafted = isMap(value)\n\t\t? getPlugin(\"MapSet\").proxyMap_(value, parent)\n\t\t: isSet(value)\n\t\t? getPlugin(\"MapSet\").proxySet_(value, parent)\n\t\t: immer.useProxies_\n\t\t? createProxyProxy(value, parent)\n\t\t: getPlugin(\"ES5\").createES5Proxy_(value, parent)\n\n\tconst scope = parent ? parent.scope_ : getCurrentScope()\n\tscope.drafts_.push(draft)\n\treturn draft\n}\n","import {\n\tdie,\n\tisDraft,\n\tshallowCopy,\n\teach,\n\tDRAFT_STATE,\n\tget,\n\tset,\n\tImmerState,\n\tisDraftable,\n\tArchtypeMap,\n\tArchtypeSet,\n\tgetArchtype,\n\tgetPlugin\n} from \"../internal\"\n\n/** Takes a snapshot of the current state of a draft and finalizes it (but without freezing). This is a great utility to print the current state during debugging (no Proxies in the way). The output of current can also be safely leaked outside the producer. */\nexport function current<T>(value: T): T\nexport function current(value: any): any {\n\tif (!isDraft(value)) die(22, value)\n\treturn currentImpl(value)\n}\n\nfunction currentImpl(value: any): any {\n\tif (!isDraftable(value)) return value\n\tconst state: ImmerState | undefined = value[DRAFT_STATE]\n\tlet copy: any\n\tconst archType = getArchtype(value)\n\tif (state) {\n\t\tif (\n\t\t\t!state.modified_ &&\n\t\t\t(state.type_ < 4 || !getPlugin(\"ES5\").hasChanges_(state as any))\n\t\t)\n\t\t\treturn state.base_\n\t\t// Optimization: avoid generating new drafts during copying\n\t\tstate.finalized_ = true\n\t\tcopy = copyHelper(value, archType)\n\t\tstate.finalized_ = false\n\t} else {\n\t\tcopy = copyHelper(value, archType)\n\t}\n\n\teach(copy, (key, childValue) => {\n\t\tif (state && get(state.base_, key) === childValue) return // no need to copy or search in something that didn't change\n\t\tset(copy, key, currentImpl(childValue))\n\t})\n\t// In the future, we might consider freezing here, based on the current settings\n\treturn archType === ArchtypeSet ? new Set(copy) : copy\n}\n\nfunction copyHelper(value: any, archType: number): any {\n\t// creates a shallow copy, even if it is a map or set\n\tswitch (archType) {\n\t\tcase ArchtypeMap:\n\t\t\treturn new Map(value)\n\t\tcase ArchtypeSet:\n\t\t\t// Set will be cloned as array temporarily, so that we can replace individual items\n\t\t\treturn Array.from(value)\n\t}\n\treturn shallowCopy(value)\n}\n","import {\n\tImmerState,\n\tDrafted,\n\tES5ArrayState,\n\tES5ObjectState,\n\teach,\n\thas,\n\tisDraft,\n\tlatest,\n\tDRAFT_STATE,\n\tis,\n\tloadPlugin,\n\tImmerScope,\n\tProxyTypeES5Array,\n\tProxyTypeES5Object,\n\tgetCurrentScope,\n\tdie,\n\tmarkChanged,\n\tobjectTraps,\n\townKeys,\n\tgetOwnPropertyDescriptors\n} from \"../internal\"\n\ntype ES5State = ES5ArrayState | ES5ObjectState\n\nexport function enableES5() {\n\tfunction willFinalizeES5_(\n\t\tscope: ImmerScope,\n\t\tresult: any,\n\t\tisReplaced: boolean\n\t) {\n\t\tif (!isReplaced) {\n\t\t\tif (scope.patches_) {\n\t\t\t\tmarkChangesRecursively(scope.drafts_![0])\n\t\t\t}\n\t\t\t// This is faster when we don't care about which attributes changed.\n\t\t\tmarkChangesSweep(scope.drafts_)\n\t\t}\n\t\t// When a child draft is returned, look for changes.\n\t\telse if (\n\t\t\tisDraft(result) &&\n\t\t\t(result[DRAFT_STATE] as ES5State).scope_ === scope\n\t\t) {\n\t\t\tmarkChangesSweep(scope.drafts_)\n\t\t}\n\t}\n\n\tfunction createES5Draft(isArray: boolean, base: any) {\n\t\tif (isArray) {\n\t\t\tconst draft = new Array(base.length)\n\t\t\tfor (let i = 0; i < base.length; i++)\n\t\t\t\tObject.defineProperty(draft, \"\" + i, proxyProperty(i, true))\n\t\t\treturn draft\n\t\t} else {\n\t\t\tconst descriptors = getOwnPropertyDescriptors(base)\n\t\t\tdelete descriptors[DRAFT_STATE as any]\n\t\t\tconst keys = ownKeys(descriptors)\n\t\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\t\tconst key: any = keys[i]\n\t\t\t\tdescriptors[key] = proxyProperty(\n\t\t\t\t\tkey,\n\t\t\t\t\tisArray || !!descriptors[key].enumerable\n\t\t\t\t)\n\t\t\t}\n\t\t\treturn Object.create(Object.getPrototypeOf(base), descriptors)\n\t\t}\n\t}\n\n\tfunction createES5Proxy_<T>(\n\t\tbase: T,\n\t\tparent?: ImmerState\n\t): Drafted<T, ES5ObjectState | ES5ArrayState> {\n\t\tconst isArray = Array.isArray(base)\n\t\tconst draft = createES5Draft(isArray, base)\n\n\t\tconst state: ES5ObjectState | ES5ArrayState = {\n\t\t\ttype_: isArray ? ProxyTypeES5Array : (ProxyTypeES5Object as any),\n\t\t\tscope_: parent ? parent.scope_ : getCurrentScope(),\n\t\t\tmodified_: false,\n\t\t\tfinalized_: false,\n\t\t\tassigned_: {},\n\t\t\tparent_: parent,\n\t\t\t// base is the object we are drafting\n\t\t\tbase_: base,\n\t\t\t// draft is the draft object itself, that traps all reads and reads from either the base (if unmodified) or copy (if modified)\n\t\t\tdraft_: draft,\n\t\t\tcopy_: null,\n\t\t\trevoked_: false,\n\t\t\tisManual_: false\n\t\t}\n\n\t\tObject.defineProperty(draft, DRAFT_STATE, {\n\t\t\tvalue: state,\n\t\t\t// enumerable: false <- the default\n\t\t\twritable: true\n\t\t})\n\t\treturn draft\n\t}\n\n\t// property descriptors are recycled to make sure we don't create a get and set closure per property,\n\t// but share them all instead\n\tconst descriptors: {[prop: string]: PropertyDescriptor} = {}\n\n\tfunction proxyProperty(\n\t\tprop: string | number,\n\t\tenumerable: boolean\n\t): PropertyDescriptor {\n\t\tlet desc = descriptors[prop]\n\t\tif (desc) {\n\t\t\tdesc.enumerable = enumerable\n\t\t} else {\n\t\t\tdescriptors[prop] = desc = {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable,\n\t\t\t\tget(this: any) {\n\t\t\t\t\tconst state = this[DRAFT_STATE]\n\t\t\t\t\tif (__DEV__) assertUnrevoked(state)\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\treturn objectTraps.get(state, prop)\n\t\t\t\t},\n\t\t\t\tset(this: any, value) {\n\t\t\t\t\tconst state = this[DRAFT_STATE]\n\t\t\t\t\tif (__DEV__) assertUnrevoked(state)\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tobjectTraps.set(state, prop, value)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn desc\n\t}\n\n\t// This looks expensive, but only proxies are visited, and only objects without known changes are scanned.\n\tfunction markChangesSweep(drafts: Drafted<any, ImmerState>[]) {\n\t\t// The natural order of drafts in the `scope` array is based on when they\n\t\t// were accessed. By processing drafts in reverse natural order, we have a\n\t\t// better chance of processing leaf nodes first. When a leaf node is known to\n\t\t// have changed, we can avoid any traversal of its ancestor nodes.\n\t\tfor (let i = drafts.length - 1; i >= 0; i--) {\n\t\t\tconst state: ES5State = drafts[i][DRAFT_STATE]\n\t\t\tif (!state.modified_) {\n\t\t\t\tswitch (state.type_) {\n\t\t\t\t\tcase ProxyTypeES5Array:\n\t\t\t\t\t\tif (hasArrayChanges(state)) markChanged(state)\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase ProxyTypeES5Object:\n\t\t\t\t\t\tif (hasObjectChanges(state)) markChanged(state)\n\t\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction markChangesRecursively(object: any) {\n\t\tif (!object || typeof object !== \"object\") return\n\t\tconst state: ES5State | undefined = object[DRAFT_STATE]\n\t\tif (!state) return\n\t\tconst {base_, draft_, assigned_, type_} = state\n\t\tif (type_ === ProxyTypeES5Object) {\n\t\t\t// Look for added keys.\n\t\t\t// probably there is a faster way to detect changes, as sweep + recurse seems to do some\n\t\t\t// unnecessary work.\n\t\t\t// also: probably we can store the information we detect here, to speed up tree finalization!\n\t\t\teach(draft_, key => {\n\t\t\t\tif ((key as any) === DRAFT_STATE) return\n\t\t\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\t\t\tif ((base_ as any)[key] === undefined && !has(base_, key)) {\n\t\t\t\t\tassigned_[key] = true\n\t\t\t\t\tmarkChanged(state)\n\t\t\t\t} else if (!assigned_[key]) {\n\t\t\t\t\t// Only untouched properties trigger recursion.\n\t\t\t\t\tmarkChangesRecursively(draft_[key])\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Look for removed keys.\n\t\t\teach(base_, key => {\n\t\t\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\t\t\tif (draft_[key] === undefined && !has(draft_, key)) {\n\t\t\t\t\tassigned_[key] = false\n\t\t\t\t\tmarkChanged(state)\n\t\t\t\t}\n\t\t\t})\n\t\t} else if (type_ === ProxyTypeES5Array) {\n\t\t\tif (hasArrayChanges(state as ES5ArrayState)) {\n\t\t\t\tmarkChanged(state)\n\t\t\t\tassigned_.length = true\n\t\t\t}\n\n\t\t\tif (draft_.length < base_.length) {\n\t\t\t\tfor (let i = draft_.length; i < base_.length; i++) assigned_[i] = false\n\t\t\t} else {\n\t\t\t\tfor (let i = base_.length; i < draft_.length; i++) assigned_[i] = true\n\t\t\t}\n\n\t\t\t// Minimum count is enough, the other parts has been processed.\n\t\t\tconst min = Math.min(draft_.length, base_.length)\n\n\t\t\tfor (let i = 0; i < min; i++) {\n\t\t\t\t// Only untouched indices trigger recursion.\n\t\t\t\tif (assigned_[i] === undefined) markChangesRecursively(draft_[i])\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction hasObjectChanges(state: ES5ObjectState) {\n\t\tconst {base_, draft_} = state\n\n\t\t// Search for added keys and changed keys. Start at the back, because\n\t\t// non-numeric keys are ordered by time of definition on the object.\n\t\tconst keys = ownKeys(draft_)\n\t\tfor (let i = keys.length - 1; i >= 0; i--) {\n\t\t\tconst key: any = keys[i]\n\t\t\tif (key === DRAFT_STATE) continue\n\t\t\tconst baseValue = base_[key]\n\t\t\t// The `undefined` check is a fast path for pre-existing keys.\n\t\t\tif (baseValue === undefined && !has(base_, key)) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\t// Once a base key is deleted, future changes go undetected, because its\n\t\t\t// descriptor is erased. This branch detects any missed changes.\n\t\t\telse {\n\t\t\t\tconst value = draft_[key]\n\t\t\t\tconst state: ImmerState = value && value[DRAFT_STATE]\n\t\t\t\tif (state ? state.base_ !== baseValue : !is(value, baseValue)) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// At this point, no keys were added or changed.\n\t\t// Compare key count to determine if keys were deleted.\n\t\tconst baseIsDraft = !!base_[DRAFT_STATE as any]\n\t\treturn keys.length !== ownKeys(base_).length + (baseIsDraft ? 0 : 1) // + 1 to correct for DRAFT_STATE\n\t}\n\n\tfunction hasArrayChanges(state: ES5ArrayState) {\n\t\tconst {draft_} = state\n\t\tif (draft_.length !== state.base_.length) return true\n\t\t// See #116\n\t\t// If we first shorten the length, our array interceptors will be removed.\n\t\t// If after that new items are added, result in the same original length,\n\t\t// those last items will have no intercepting property.\n\t\t// So if there is no own descriptor on the last position, we know that items were removed and added\n\t\t// N.B.: splice, unshift, etc only shift values around, but not prop descriptors, so we only have to check\n\t\t// the last one\n\t\tconst descriptor = Object.getOwnPropertyDescriptor(\n\t\t\tdraft_,\n\t\t\tdraft_.length - 1\n\t\t)\n\t\t// descriptor can be null, but only for newly created sparse arrays, eg. new Array(10)\n\t\tif (descriptor && !descriptor.get) return true\n\t\t// For all other cases, we don't have to compare, as they would have been picked up by the index setters\n\t\treturn false\n\t}\n\n\tfunction hasChanges_(state: ES5State) {\n\t\treturn state.type_ === ProxyTypeES5Object\n\t\t\t? hasObjectChanges(state)\n\t\t\t: hasArrayChanges(state)\n\t}\n\n\tfunction assertUnrevoked(state: any /*ES5State | MapState | SetState*/) {\n\t\tif (state.revoked_) die(3, JSON.stringify(latest(state)))\n\t}\n\n\tloadPlugin(\"ES5\", {\n\t\tcreateES5Proxy_,\n\t\twillFinalizeES5_,\n\t\thasChanges_\n\t})\n}\n","import {\n\tImmerState,\n\tPatch,\n\tSetState,\n\tES5ArrayState,\n\tProxyArrayState,\n\tMapState,\n\tES5ObjectState,\n\tProxyObjectState,\n\tPatchPath,\n\tget,\n\teach,\n\thas,\n\tgetArchtype,\n\tisSet,\n\tisMap,\n\tloadPlugin,\n\tProxyTypeProxyObject,\n\tProxyTypeES5Object,\n\tProxyTypeMap,\n\tProxyTypeES5Array,\n\tProxyTypeProxyArray,\n\tProxyTypeSet,\n\tArchtypeMap,\n\tArchtypeSet,\n\tArchtypeArray,\n\tdie,\n\tisDraft\n} from \"../internal\"\n\nexport function enablePatches() {\n\tconst REPLACE = \"replace\"\n\tconst ADD = \"add\"\n\tconst REMOVE = \"remove\"\n\n\tfunction generatePatches_(\n\t\tstate: ImmerState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t): void {\n\t\tswitch (state.type_) {\n\t\t\tcase ProxyTypeProxyObject:\n\t\t\tcase ProxyTypeES5Object:\n\t\t\tcase ProxyTypeMap:\n\t\t\t\treturn generatePatchesFromAssigned(\n\t\t\t\t\tstate,\n\t\t\t\t\tbasePath,\n\t\t\t\t\tpatches,\n\t\t\t\t\tinversePatches\n\t\t\t\t)\n\t\t\tcase ProxyTypeES5Array:\n\t\t\tcase ProxyTypeProxyArray:\n\t\t\t\treturn generateArrayPatches(state, basePath, patches, inversePatches)\n\t\t\tcase ProxyTypeSet:\n\t\t\t\treturn generateSetPatches(\n\t\t\t\t\t(state as any) as SetState,\n\t\t\t\t\tbasePath,\n\t\t\t\t\tpatches,\n\t\t\t\t\tinversePatches\n\t\t\t\t)\n\t\t}\n\t}\n\n\tfunction generateArrayPatches(\n\t\tstate: ES5ArrayState | ProxyArrayState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t) {\n\t\tlet {base_, assigned_} = state\n\t\tlet copy_ = state.copy_!\n\n\t\t// Reduce complexity by ensuring `base` is never longer.\n\t\tif (copy_.length < base_.length) {\n\t\t\t// @ts-ignore\n\t\t\t;[base_, copy_] = [copy_, base_]\n\t\t\t;[patches, inversePatches] = [inversePatches, patches]\n\t\t}\n\n\t\t// Process replaced indices.\n\t\tfor (let i = 0; i < base_.length; i++) {\n\t\t\tif (assigned_[i] && copy_[i] !== base_[i]) {\n\t\t\t\tconst path = basePath.concat([i])\n\t\t\t\tpatches.push({\n\t\t\t\t\top: REPLACE,\n\t\t\t\t\tpath,\n\t\t\t\t\t// Need to maybe clone it, as it can in fact be the original value\n\t\t\t\t\t// due to the base/copy inversion at the start of this function\n\t\t\t\t\tvalue: clonePatchValueIfNeeded(copy_[i])\n\t\t\t\t})\n\t\t\t\tinversePatches.push({\n\t\t\t\t\top: REPLACE,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue: clonePatchValueIfNeeded(base_[i])\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\t// Process added indices.\n\t\tfor (let i = base_.length; i < copy_.length; i++) {\n\t\t\tconst path = basePath.concat([i])\n\t\t\tpatches.push({\n\t\t\t\top: ADD,\n\t\t\t\tpath,\n\t\t\t\t// Need to maybe clone it, as it can in fact be the original value\n\t\t\t\t// due to the base/copy inversion at the start of this function\n\t\t\t\tvalue: clonePatchValueIfNeeded(copy_[i])\n\t\t\t})\n\t\t}\n\t\tif (base_.length < copy_.length) {\n\t\t\tinversePatches.push({\n\t\t\t\top: REPLACE,\n\t\t\t\tpath: basePath.concat([\"length\"]),\n\t\t\t\tvalue: base_.length\n\t\t\t})\n\t\t}\n\t}\n\n\t// This is used for both Map objects and normal objects.\n\tfunction generatePatchesFromAssigned(\n\t\tstate: MapState | ES5ObjectState | ProxyObjectState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t) {\n\t\tconst {base_, copy_} = state\n\t\teach(state.assigned_!, (key, assignedValue) => {\n\t\t\tconst origValue = get(base_, key)\n\t\t\tconst value = get(copy_!, key)\n\t\t\tconst op = !assignedValue ? REMOVE : has(base_, key) ? REPLACE : ADD\n\t\t\tif (origValue === value && op === REPLACE) return\n\t\t\tconst path = basePath.concat(key as any)\n\t\t\tpatches.push(op === REMOVE ? {op, path} : {op, path, value})\n\t\t\tinversePatches.push(\n\t\t\t\top === ADD\n\t\t\t\t\t? {op: REMOVE, path}\n\t\t\t\t\t: op === REMOVE\n\t\t\t\t\t? {op: ADD, path, value: clonePatchValueIfNeeded(origValue)}\n\t\t\t\t\t: {op: REPLACE, path, value: clonePatchValueIfNeeded(origValue)}\n\t\t\t)\n\t\t})\n\t}\n\n\tfunction generateSetPatches(\n\t\tstate: SetState,\n\t\tbasePath: PatchPath,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t) {\n\t\tlet {base_, copy_} = state\n\n\t\tlet i = 0\n\t\tbase_.forEach((value: any) => {\n\t\t\tif (!copy_!.has(value)) {\n\t\t\t\tconst path = basePath.concat([i])\n\t\t\t\tpatches.push({\n\t\t\t\t\top: REMOVE,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t\tinversePatches.unshift({\n\t\t\t\t\top: ADD,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t}\n\t\t\ti++\n\t\t})\n\t\ti = 0\n\t\tcopy_!.forEach((value: any) => {\n\t\t\tif (!base_.has(value)) {\n\t\t\t\tconst path = basePath.concat([i])\n\t\t\t\tpatches.push({\n\t\t\t\t\top: ADD,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t\tinversePatches.unshift({\n\t\t\t\t\top: REMOVE,\n\t\t\t\t\tpath,\n\t\t\t\t\tvalue\n\t\t\t\t})\n\t\t\t}\n\t\t\ti++\n\t\t})\n\t}\n\n\tfunction generateReplacementPatches_(\n\t\trootState: ImmerState,\n\t\treplacement: any,\n\t\tpatches: Patch[],\n\t\tinversePatches: Patch[]\n\t): void {\n\t\tpatches.push({\n\t\t\top: REPLACE,\n\t\t\tpath: [],\n\t\t\tvalue: replacement\n\t\t})\n\t\tinversePatches.push({\n\t\t\top: REPLACE,\n\t\t\tpath: [],\n\t\t\tvalue: rootState.base_\n\t\t})\n\t}\n\n\tfunction applyPatches_<T>(draft: T, patches: Patch[]): T {\n\t\tpatches.forEach(patch => {\n\t\t\tconst {path, op} = patch\n\n\t\t\tlet base: any = draft\n\t\t\tfor (let i = 0; i < path.length - 1; i++) {\n\t\t\t\tbase = get(base, path[i])\n\t\t\t\tif (typeof base !== \"object\") die(15, path.join(\"/\"))\n\t\t\t}\n\n\t\t\tconst type = getArchtype(base)\n\t\t\tconst value = deepClonePatchValue(patch.value) // used to clone patch to ensure original patch is not modified, see #411\n\t\t\tconst key = path[path.length - 1]\n\t\t\tswitch (op) {\n\t\t\t\tcase REPLACE:\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase ArchtypeMap:\n\t\t\t\t\t\t\treturn base.set(key, value)\n\t\t\t\t\t\t/* istanbul ignore next */\n\t\t\t\t\t\tcase ArchtypeSet:\n\t\t\t\t\t\t\tdie(16)\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t// if value is an object, then it's assigned by reference\n\t\t\t\t\t\t\t// in the following add or remove ops, the value field inside the patch will also be modifyed\n\t\t\t\t\t\t\t// so we use value from the cloned patch\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\treturn (base[key] = value)\n\t\t\t\t\t}\n\t\t\t\tcase ADD:\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase ArchtypeArray:\n\t\t\t\t\t\t\treturn base.splice(key as any, 0, value)\n\t\t\t\t\t\tcase ArchtypeMap:\n\t\t\t\t\t\t\treturn base.set(key, value)\n\t\t\t\t\t\tcase ArchtypeSet:\n\t\t\t\t\t\t\treturn base.add(value)\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn (base[key] = value)\n\t\t\t\t\t}\n\t\t\t\tcase REMOVE:\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase ArchtypeArray:\n\t\t\t\t\t\t\treturn base.splice(key as any, 1)\n\t\t\t\t\t\tcase ArchtypeMap:\n\t\t\t\t\t\t\treturn base.delete(key)\n\t\t\t\t\t\tcase ArchtypeSet:\n\t\t\t\t\t\t\treturn base.delete(patch.value)\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn delete base[key]\n\t\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tdie(17, op)\n\t\t\t}\n\t\t})\n\n\t\treturn draft\n\t}\n\n\t// optimize: this is quite a performance hit, can we detect intelligently when it is needed?\n\t// E.g. auto-draft when new objects from outside are assigned and modified?\n\t// (See failing test when deepClone just returns obj)\n\tfunction deepClonePatchValue<T>(obj: T): T\n\tfunction deepClonePatchValue(obj: any) {\n\t\tif (!obj || typeof obj !== \"object\") return obj\n\t\tif (Array.isArray(obj)) return obj.map(deepClonePatchValue)\n\t\tif (isMap(obj))\n\t\t\treturn new Map(\n\t\t\t\tArray.from(obj.entries()).map(([k, v]) => [k, deepClonePatchValue(v)])\n\t\t\t)\n\t\tif (isSet(obj)) return new Set(Array.from(obj).map(deepClonePatchValue))\n\t\tconst cloned = Object.create(Object.getPrototypeOf(obj))\n\t\tfor (const key in obj) cloned[key] = deepClonePatchValue(obj[key])\n\t\treturn cloned\n\t}\n\n\tfunction clonePatchValueIfNeeded<T>(obj: T): T {\n\t\tif (isDraft(obj)) {\n\t\t\treturn deepClonePatchValue(obj)\n\t\t} else return obj\n\t}\n\n\tloadPlugin(\"Patches\", {\n\t\tapplyPatches_,\n\t\tgeneratePatches_,\n\t\tgenerateReplacementPatches_\n\t})\n}\n","// types only!\nimport {\n\tImmerState,\n\tAnyMap,\n\tAnySet,\n\tMapState,\n\tSetState,\n\tDRAFT_STATE,\n\tgetCurrentScope,\n\tlatest,\n\titeratorSymbol,\n\tisDraftable,\n\tcreateProxy,\n\tloadPlugin,\n\tmarkChanged,\n\tProxyTypeMap,\n\tProxyTypeSet,\n\tdie,\n\teach\n} from \"../internal\"\n\nexport function enableMapSet() {\n\t/* istanbul ignore next */\n\tvar extendStatics = function(d: any, b: any): any {\n\t\textendStatics =\n\t\t\tObject.setPrototypeOf ||\n\t\t\t({__proto__: []} instanceof Array &&\n\t\t\t\tfunction(d, b) {\n\t\t\t\t\td.__proto__ = b\n\t\t\t\t}) ||\n\t\t\tfunction(d, b) {\n\t\t\t\tfor (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]\n\t\t\t}\n\t\treturn extendStatics(d, b)\n\t}\n\n\t// Ugly hack to resolve #502 and inherit built in Map / Set\n\tfunction __extends(d: any, b: any): any {\n\t\textendStatics(d, b)\n\t\tfunction __(this: any): any {\n\t\t\tthis.constructor = d\n\t\t}\n\t\td.prototype =\n\t\t\t// @ts-ignore\n\t\t\t((__.prototype = b.prototype), new __())\n\t}\n\n\tconst DraftMap = (function(_super) {\n\t\t__extends(DraftMap, _super)\n\t\t// Create class manually, cause #502\n\t\tfunction DraftMap(this: any, target: AnyMap, parent?: ImmerState): any {\n\t\t\tthis[DRAFT_STATE] = {\n\t\t\t\ttype_: ProxyTypeMap,\n\t\t\t\tparent_: parent,\n\t\t\t\tscope_: parent ? parent.scope_ : getCurrentScope()!,\n\t\t\t\tmodified_: false,\n\t\t\t\tfinalized_: false,\n\t\t\t\tcopy_: undefined,\n\t\t\t\tassigned_: undefined,\n\t\t\t\tbase_: target,\n\t\t\t\tdraft_: this as any,\n\t\t\t\tisManual_: false,\n\t\t\t\trevoked_: false\n\t\t\t} as MapState\n\t\t\treturn this\n\t\t}\n\t\tconst p = DraftMap.prototype\n\n\t\tObject.defineProperty(p, \"size\", {\n\t\t\tget: function() {\n\t\t\t\treturn latest(this[DRAFT_STATE]).size\n\t\t\t}\n\t\t\t// enumerable: false,\n\t\t\t// configurable: true\n\t\t})\n\n\t\tp.has = function(key: any): boolean {\n\t\t\treturn latest(this[DRAFT_STATE]).has(key)\n\t\t}\n\n\t\tp.set = function(key: any, value: any) {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tif (!latest(state).has(key) || latest(state).get(key) !== value) {\n\t\t\t\tprepareMapCopy(state)\n\t\t\t\tmarkChanged(state)\n\t\t\t\tstate.assigned_!.set(key, true)\n\t\t\t\tstate.copy_!.set(key, value)\n\t\t\t\tstate.assigned_!.set(key, true)\n\t\t\t}\n\t\t\treturn this\n\t\t}\n\n\t\tp.delete = function(key: any): boolean {\n\t\t\tif (!this.has(key)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareMapCopy(state)\n\t\t\tmarkChanged(state)\n\t\t\tstate.assigned_!.set(key, false)\n\t\t\tstate.copy_!.delete(key)\n\t\t\treturn true\n\t\t}\n\n\t\tp.clear = function() {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareMapCopy(state)\n\t\t\tmarkChanged(state)\n\t\t\tstate.assigned_ = new Map()\n\t\t\teach(state.base_, key => {\n\t\t\t\tstate.assigned_!.set(key, false)\n\t\t\t})\n\t\t\treturn state.copy_!.clear()\n\t\t}\n\n\t\tp.forEach = function(\n\t\t\tcb: (value: any, key: any, self: any) => void,\n\t\t\tthisArg?: any\n\t\t) {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tlatest(state).forEach((_value: any, key: any, _map: any) => {\n\t\t\t\tcb.call(thisArg, this.get(key), key, this)\n\t\t\t})\n\t\t}\n\n\t\tp.get = function(key: any): any {\n\t\t\tconst state: MapState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tconst value = latest(state).get(key)\n\t\t\tif (state.finalized_ || !isDraftable(value)) {\n\t\t\t\treturn value\n\t\t\t}\n\t\t\tif (value !== state.base_.get(key)) {\n\t\t\t\treturn value // either already drafted or reassigned\n\t\t\t}\n\t\t\t// despite what it looks, this creates a draft only once, see above condition\n\t\t\tconst draft = createProxy(state.scope_.immer_, value, state)\n\t\t\tprepareMapCopy(state)\n\t\t\tstate.copy_!.set(key, draft)\n\t\t\treturn draft\n\t\t}\n\n\t\tp.keys = function(): IterableIterator<any> {\n\t\t\treturn latest(this[DRAFT_STATE]).keys()\n\t\t}\n\n\t\tp.values = function(): IterableIterator<any> {\n\t\t\tconst iterator = this.keys()\n\t\t\treturn {\n\t\t\t\t[iteratorSymbol]: () => this.values(),\n\t\t\t\tnext: () => {\n\t\t\t\t\tconst r = iterator.next()\n\t\t\t\t\t/* istanbul ignore next */\n\t\t\t\t\tif (r.done) return r\n\t\t\t\t\tconst value = this.get(r.value)\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdone: false,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} as any\n\t\t}\n\n\t\tp.entries = function(): IterableIterator<[any, any]> {\n\t\t\tconst iterator = this.keys()\n\t\t\treturn {\n\t\t\t\t[iteratorSymbol]: () => this.entries(),\n\t\t\t\tnext: () => {\n\t\t\t\t\tconst r = iterator.next()\n\t\t\t\t\t/* istanbul ignore next */\n\t\t\t\t\tif (r.done) return r\n\t\t\t\t\tconst value = this.get(r.value)\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdone: false,\n\t\t\t\t\t\tvalue: [r.value, value]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} as any\n\t\t}\n\n\t\tp[iteratorSymbol] = function() {\n\t\t\treturn this.entries()\n\t\t}\n\n\t\treturn DraftMap\n\t})(Map)\n\n\tfunction proxyMap_<T extends AnyMap>(target: T, parent?: ImmerState): T {\n\t\t// @ts-ignore\n\t\treturn new DraftMap(target, parent)\n\t}\n\n\tfunction prepareMapCopy(state: MapState) {\n\t\tif (!state.copy_) {\n\t\t\tstate.assigned_ = new Map()\n\t\t\tstate.copy_ = new Map(state.base_)\n\t\t}\n\t}\n\n\tconst DraftSet = (function(_super) {\n\t\t__extends(DraftSet, _super)\n\t\t// Create class manually, cause #502\n\t\tfunction DraftSet(this: any, target: AnySet, parent?: ImmerState) {\n\t\t\tthis[DRAFT_STATE] = {\n\t\t\t\ttype_: ProxyTypeSet,\n\t\t\t\tparent_: parent,\n\t\t\t\tscope_: parent ? parent.scope_ : getCurrentScope()!,\n\t\t\t\tmodified_: false,\n\t\t\t\tfinalized_: false,\n\t\t\t\tcopy_: undefined,\n\t\t\t\tbase_: target,\n\t\t\t\tdraft_: this,\n\t\t\t\tdrafts_: new Map(),\n\t\t\t\trevoked_: false,\n\t\t\t\tisManual_: false\n\t\t\t} as SetState\n\t\t\treturn this\n\t\t}\n\t\tconst p = DraftSet.prototype\n\n\t\tObject.defineProperty(p, \"size\", {\n\t\t\tget: function() {\n\t\t\t\treturn latest(this[DRAFT_STATE]).size\n\t\t\t}\n\t\t\t// enumerable: true,\n\t\t})\n\n\t\tp.has = function(value: any): boolean {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\t// bit of trickery here, to be able to recognize both the value, and the draft of its value\n\t\t\tif (!state.copy_) {\n\t\t\t\treturn state.base_.has(value)\n\t\t\t}\n\t\t\tif (state.copy_.has(value)) return true\n\t\t\tif (state.drafts_.has(value) && state.copy_.has(state.drafts_.get(value)))\n\t\t\t\treturn true\n\t\t\treturn false\n\t\t}\n\n\t\tp.add = function(value: any): any {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tif (!this.has(value)) {\n\t\t\t\tprepareSetCopy(state)\n\t\t\t\tmarkChanged(state)\n\t\t\t\tstate.copy_!.add(value)\n\t\t\t}\n\t\t\treturn this\n\t\t}\n\n\t\tp.delete = function(value: any): any {\n\t\t\tif (!this.has(value)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareSetCopy(state)\n\t\t\tmarkChanged(state)\n\t\t\treturn (\n\t\t\t\tstate.copy_!.delete(value) ||\n\t\t\t\t(state.drafts_.has(value)\n\t\t\t\t\t? state.copy_!.delete(state.drafts_.get(value))\n\t\t\t\t\t: /* istanbul ignore next */ false)\n\t\t\t)\n\t\t}\n\n\t\tp.clear = function() {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareSetCopy(state)\n\t\t\tmarkChanged(state)\n\t\t\treturn state.copy_!.clear()\n\t\t}\n\n\t\tp.values = function(): IterableIterator<any> {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareSetCopy(state)\n\t\t\treturn state.copy_!.values()\n\t\t}\n\n\t\tp.entries = function entries(): IterableIterator<[any, any]> {\n\t\t\tconst state: SetState = this[DRAFT_STATE]\n\t\t\tassertUnrevoked(state)\n\t\t\tprepareSetCopy(state)\n\t\t\treturn state.copy_!.entries()\n\t\t}\n\n\t\tp.keys = function(): IterableIterator<any> {\n\t\t\treturn this.values()\n\t\t}\n\n\t\tp[iteratorSymbol] = function() {\n\t\t\treturn this.values()\n\t\t}\n\n\t\tp.forEach = function forEach(cb: any, thisArg?: any) {\n\t\t\tconst iterator = this.values()\n\t\t\tlet result = iterator.next()\n\t\t\twhile (!result.done) {\n\t\t\t\tcb.call(thisArg, result.value, result.value, this)\n\t\t\t\tresult = iterator.next()\n\t\t\t}\n\t\t}\n\n\t\treturn DraftSet\n\t})(Set)\n\n\tfunction proxySet_<T extends AnySet>(target: T, parent?: ImmerState): T {\n\t\t// @ts-ignore\n\t\treturn new DraftSet(target, parent)\n\t}\n\n\tfunction prepareSetCopy(state: SetState) {\n\t\tif (!state.copy_) {\n\t\t\t// create drafts for all entries to preserve insertion order\n\t\t\tstate.copy_ = new Set()\n\t\t\tstate.base_.forEach(value => {\n\t\t\t\tif (isDraftable(value)) {\n\t\t\t\t\tconst draft = createProxy(state.scope_.immer_, value, state)\n\t\t\t\t\tstate.drafts_.set(value, draft)\n\t\t\t\t\tstate.copy_!.add(draft)\n\t\t\t\t} else {\n\t\t\t\t\tstate.copy_!.add(value)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tfunction assertUnrevoked(state: any /*ES5State | MapState | SetState*/) {\n\t\tif (state.revoked_) die(3, JSON.stringify(latest(state)))\n\t}\n\n\tloadPlugin(\"MapSet\", {proxyMap_, proxySet_})\n}\n","import {enableES5} from \"./es5\"\nimport {enableMapSet} from \"./mapset\"\nimport {enablePatches} from \"./patches\"\n\nexport function enableAllPlugins() {\n\tenableES5()\n\tenableMapSet()\n\tenablePatches()\n}\n","import {\n\tIProduce,\n\tIProduceWithPatches,\n\tImmer,\n\tDraft,\n\tImmutable\n} from \"./internal\"\n\nexport {\n\tDraft,\n\tImmutable,\n\tPatch,\n\tPatchListener,\n\toriginal,\n\tcurrent,\n\tisDraft,\n\tisDraftable,\n\tNOTHING as nothing,\n\tDRAFTABLE as immerable\n} from \"./internal\"\n\nconst immer = new Immer()\n\n/**\n * The `produce` function takes a value and a \"recipe function\" (whose\n * return value often depends on the base state). The recipe function is\n * free to mutate its first argument however it wants. All mutations are\n * only ever applied to a __copy__ of the base state.\n *\n * Pass only a function to create a \"curried producer\" which relieves you\n * from passing the recipe function every time.\n *\n * Only plain objects and arrays are made mutable. All other objects are\n * considered uncopyable.\n *\n * Note: This function is __bound__ to its `Immer` instance.\n *\n * @param {any} base - the initial state\n * @param {Function} producer - function that receives a proxy of the base state as first argument and which can be freely modified\n * @param {Function} patchListener - optional function that will be called with all the patches produced here\n * @returns {any} a new state, or the initial state if nothing was modified\n */\nexport const produce: IProduce = immer.produce\nexport default produce\n\n/**\n * Like `produce`, but `produceWithPatches` always returns a tuple\n * [nextState, patches, inversePatches] (instead of just the next state)\n */\nexport const produceWithPatches: IProduceWithPatches = immer.produceWithPatches.bind(\n\timmer\n)\n\n/**\n * Pass true to automatically freeze all copies created by Immer.\n *\n * By default, auto-freezing is disabled in production.\n */\nexport const setAutoFreeze = immer.setAutoFreeze.bind(immer)\n\n/**\n * Pass true to use the ES2015 `Proxy` class when creating drafts, which is\n * always faster than using ES5 proxies.\n *\n * By default, feature detection is used, so calling this is rarely necessary.\n */\nexport const setUseProxies = immer.setUseProxies.bind(immer)\n\n/**\n * Apply an array of Immer patches to the first argument.\n *\n * This function is a producer, which means copy-on-write is in effect.\n */\nexport const applyPatches = immer.applyPatches.bind(immer)\n\n/**\n * Create an Immer draft from the given base state, which may be a draft itself.\n * The draft can be modified until you finalize it with the `finishDraft` function.\n */\nexport const createDraft = immer.createDraft.bind(immer)\n\n/**\n * Finalize an Immer draft from a `createDraft` call, returning the base state\n * (if no changes were made) or a modified copy. The draft must *not* be\n * mutated afterwards.\n *\n * Pass a function as the 2nd argument to generate Immer patches based on the\n * changes that were made.\n */\nexport const finishDraft = immer.finishDraft.bind(immer)\n\n/**\n * This function is actually a no-op, but can be used to cast an immutable type\n * to an draft type and make TypeScript happy\n *\n * @param value\n */\nexport function castDraft<T>(value: T): Draft<T> {\n\treturn value as any\n}\n\n/**\n * This function is actually a no-op, but can be used to cast a mutable type\n * to an immutable type and make TypeScript happy\n * @param value\n */\nexport function castImmutable<T>(value: T): Immutable<T> {\n\treturn value as any\n}\n\nexport {Immer}\n\nexport {enableES5} from \"./plugins/es5\"\nexport {enablePatches} from \"./plugins/patches\"\nexport {enableMapSet} from \"./plugins/mapset\"\nexport {enableAllPlugins} from \"./plugins/all\"\n","// Should be no imports here!\n\n// Some things that should be evaluated before all else...\n\n// We only want to know if non-polyfilled symbols are available\nconst hasSymbol =\n\ttypeof Symbol !== \"undefined\" && typeof Symbol(\"x\") === \"symbol\"\nexport const hasMap = typeof Map !== \"undefined\"\nexport const hasSet = typeof Set !== \"undefined\"\nexport const hasProxies =\n\ttypeof Proxy !== \"undefined\" &&\n\ttypeof Proxy.revocable !== \"undefined\" &&\n\ttypeof Reflect !== \"undefined\"\n\n/* istanbul ignore next */\nfunction mini() {}\nexport const isMinified = mini.name !== \"mini\"\n\n/**\n * The sentinel value returned by producers to replace the draft with undefined.\n */\nexport const NOTHING: Nothing = hasSymbol\n\t? Symbol.for(\"immer-nothing\")\n\t: ({[\"immer-nothing\"]: true} as any)\n\n/**\n * To let Immer treat your class instances as plain immutable objects\n * (albeit with a custom prototype), you must define either an instance property\n * or a static property on each of your custom classes.\n *\n * Otherwise, your class instance will never be drafted, which means it won't be\n * safe to mutate in a produce callback.\n */\nexport const DRAFTABLE: unique symbol = hasSymbol\n\t? Symbol.for(\"immer-draftable\")\n\t: (\"__$immer_draftable\" as any)\n\nexport const DRAFT_STATE: unique symbol = hasSymbol\n\t? Symbol.for(\"immer-state\")\n\t: (\"__$immer_state\" as any)\n\n// Even a polyfilled Symbol might provide Symbol.iterator\nexport const iteratorSymbol: typeof Symbol.iterator =\n\t(typeof Symbol != \"undefined\" && Symbol.iterator) || (\"@@iterator\" as any)\n\n/** Use a class type for `nothing` so its type is unique */\nexport class Nothing {\n\t// This lets us do `Exclude<T, Nothing>`\n\t// @ts-ignore\n\tprivate _!: unique symbol\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar xstate_1 = require(\"xstate\");\nvar immer_1 = require(\"immer\");\nfunction immerAssign(recipe) {\n    return xstate_1.assign(function (context, event, meta) {\n        return immer_1.produce(context, function (draft) { return void recipe(draft, event, meta); });\n    });\n}\nexports.assign = immerAssign;\nfunction createUpdater(type, recipe) {\n    var update = function (input) {\n        return {\n            type: type,\n            input: input\n        };\n    };\n    return {\n        update: update,\n        action: immerAssign(function (ctx, event, meta) {\n            recipe(ctx, event, meta);\n        }),\n        type: type\n    };\n}\nexports.createUpdater = createUpdater;\n","export interface TimerContext {\n\toffSet: number;\n\telapsed: number;\n\tduration: number;\n\tinterval: number;\n\tstartTime: number;\n}\n\nexport enum TimerStatus {\n\tIdle = 'idle',\n\tRunning = 'running',\n\tPaused = 'paused',\n}\n\nexport type TimerEvent =\n\t| {\n\t\t\ttype: 'START';\n\t  }\n\t| {\n\t\t\ttype: 'DURATION.UPDATE';\n\t\t\tvalue: number;\n\t  }\n\t| {\n\t\t\ttype: 'TICK';\n\t  }\n\t| {\n\t\t\ttype: 'RESET';\n\t  }\n\t| {\n\t\t\ttype: 'PAUSE';\n\t  }\n\t| {\n\t\t\ttype: 'UNPAUSE';\n\t  };\n\nexport type TimerState =\n\t| {\n\t\t\tvalue: TimerStatus.Running;\n\t\t\tcontext: TimerContext & { elapsed: number; duration: number };\n\t  }\n\t| {\n\t\t\tvalue: TimerStatus.Paused;\n\t\t\tcontext: TimerContext & {\n\t\t\t\telapsed: number;\n\t\t\t\tduration: number;\n\t\t\t\tinterval: number;\n\t\t\t};\n\t  }\n\t| {\n\t\t\tvalue: TimerStatus.Idle;\n\t\t\tcontext: TimerContext;\n\t  };\n\nexport type CreateTimerServiceOptions = {\n\tduration: number;\n\tinterval?: number;\n\tonTick: () => any;\n\tonFinish: () => any;\n};\n","import {\n\tcreateMachine,\n\tMachineConfig,\n\tMachineOptions,\n\tServiceConfig,\n\tStateMachine,\n\tinterpret,\n} from 'xstate';\nimport { assign } from '@xstate/immer';\nimport {\n\tCreateTimerServiceOptions,\n\tTimerContext,\n\tTimerEvent,\n\tTimerState,\n\tTimerStatus,\n} from './types';\n\nconst { Running, Idle, Paused } = TimerStatus;\n\nconst timerMachineConfig: MachineConfig<\n\tTimerContext,\n\tTimerState,\n\tTimerEvent\n> = {\n\tstates: {\n\t\t[Running]: {\n\t\t\tentry: 'enterRunning',\n\t\t\talways: {\n\t\t\t\ttarget: Idle,\n\t\t\t\tcond: 'checkExpired',\n\t\t\t},\n\t\t\tinvoke: {\n\t\t\t\tsrc: 'ticker',\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tPAUSE: {\n\t\t\t\t\ttarget: 'paused',\n\t\t\t\t},\n\t\t\t\tTICK: {\n\t\t\t\t\tactions: 'onTick',\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t[Paused]: {\n\t\t\tentry: 'onPause',\n\t\t\ton: {\n\t\t\t\tUNPAUSE: {\n\t\t\t\t\ttarget: Running,\n\t\t\t\t\tactions: 'onUnpause',\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t[Idle]: {\n\t\t\talways: {\n\t\t\t\ttarget: Running,\n\t\t\t\tcond: 'checkDuration',\n\t\t\t},\n\t\t},\n\t},\n\ton: {\n\t\tRESET: {\n\t\t\ttarget: Running,\n\t\t\tactions: assign(context => {\n\t\t\t\tcontext.elapsed = 0;\n\t\t\t\tcontext.offSet = 0;\n\t\t\t}),\n\t\t},\n\t\t// \t{\n\t\t// \t\telapsed: _ => 0,\n\t\t// \t\toffSet: _ => 0,\n\t\t// \t}),\n\t\t// },\n\t\t'DURATION.UPDATE': {\n\t\t\tactions: 'onDurationUpdate',\n\t\t},\n\t},\n};\n\nconst checkExpired = (context: TimerContext) =>\n\tcontext.elapsed >= context.duration;\n\nconst checkDuration = (context: TimerContext) =>\n\tcontext.elapsed < context.duration;\n\nconst ticker = (context: TimerContext) => (cb: (message: string) => void) => {\n\tconst interval = setInterval(() => {\n\t\tcb('TICK');\n\t}, 1000 * context.interval);\n\n\treturn () => {\n\t\tclearInterval(interval);\n\t};\n};\n\nconst onTick = assign<TimerContext, TimerEvent>(context => {\n\tconst elapsed = Math.min(\n\t\t(Date.now() - context.startTime) / 1000 + context.offSet,\n\t\tcontext.duration,\n\t);\n\tcontext.elapsed = +elapsed.toFixed(2);\n});\n// {\n// elapsed: context => {\n// \tconst elapsed = Math.min(\n// \t\t((Date.now() - context.startTime) / 1000) + context.offSet,\n// \t\tcontext.duration,\n// \t);\n// \treturn +elapsed.toFixed(2);\n// },\n// }\n// );\n\n// const onPause = assign<TimerContext, TimerEvent>({\n// \telapsed: context => {\n// \t\tconst { startTime, offSet } = context;\n// \t\tconst el = (Date.now() - startTime + offSet) / 1000;\n// \t\treturn +el.toFixed(2);\n// \t},\n// \toffSet: context => {\n// \t\treturn context.offSet + Date.now() - context.startTime;\n// \t},\n// });\n\nconst onExpire = assign<TimerContext, TimerEvent>(context => {\n\tcontext.elapsed = context.duration;\n\tcontext.offSet = 0;\n});\n\n// \t{\n// \telapsed: context => context.duration,\n// \toffSet: _ => 0,\n// });\n\nconst enterRunning = assign<TimerContext, TimerEvent>(context => {\n\tcontext.startTime = Date.now();\n});\n// {\n// \tstartTime: _ => Date.now(),\n// });\n\n// const onDurationUpdate = assign<TimerContext, TimerEvent>({\n// \tduration: (context, event) => {\n// \t\tif (event.type === 'DURATION.UPDATE') {\n// \t\t\treturn context.duration + event?.value;\n// \t\t}\n// \t\treturn context.duration;\n// \t},\n// \toffSet: context => context.duration,\n// });\n\nconst timerOptions: MachineOptions<TimerContext, TimerEvent> = {\n\tactions: {\n\t\tonTick,\n\t\t// onPause,\n\t\tenterRunning,\n\t\tonExpire,\n\t\t// onDurationUpdate,\n\t},\n\tguards: {\n\t\tcheckExpired,\n\t\tcheckDuration,\n\t},\n\tactivities: {},\n\tdelays: {},\n\tservices: {\n\t\tticker,\n\t},\n};\n\nexport const createTimerMachine = (\n\toptions: CreateTimerServiceOptions,\n): StateMachine<TimerContext, TimerState, TimerEvent> => {\n\tconst context: TimerContext = {\n\t\tinterval: 0.1,\n\t\t...options,\n\t\toffSet: 0,\n\t\telapsed: 0,\n\t\tstartTime: Date.now(),\n\t};\n\n\treturn createMachine<TimerContext, TimerEvent>(\n\t\t{\n\t\t\t...timerMachineConfig,\n\t\t\tinitial: Running,\n\t\t\tcontext,\n\t\t},\n\t\ttimerOptions,\n\t);\n};\n\nexport const createTimerService = (options: CreateTimerServiceOptions) => {\n\tconst machine = createTimerMachine(options);\n\tconst service = interpret(machine, { devTools: true });\n\treturn service;\n};\n","import { interpret, Interpreter, State, StateMachine } from 'xstate';\nimport { createTimerService } from './TimerMachine';\nimport { TimerStatus, TimerContext, TimerEvent, TimerState } from './types';\nconst { Paused, Idle } = TimerStatus;\nconst TICK_INTERVAL = 500; // TODO: optionally pass this in\n\nclass Timer {\n\tpublic secondsRemaining: number;\n\tpublic tickCounter: number;\n\tpublic get paused() {\n\t\treturn this._service.state.value === Paused;\n\t}\n\n\tprivate _service: Interpreter<TimerContext, TimerState, TimerEvent>;\n\n\tconstructor(\n\t\tprivate _targetSeconds: number,\n\t\tprivate _onTick: () => void,\n\t\tprivate _onFinish: () => void,\n\t) {\n\t\tthis.secondsRemaining = this._targetSeconds;\n\t\tconst options = {\n\t\t\tduration: this._targetSeconds,\n\t\t\tinterval: 0.5,\n\t\t\tonTick: this._onTick,\n\t\t\tonFinish: this._onFinish,\n\t\t};\n\t\tthis.tickCounter = 0;\n\t\tthis._service = createTimerService(options).onTransition(\n\t\t\tthis._onTimerUpdate,\n\t\t);\n\t\tthis._service.start();\n\t}\n\tpublic pause = () => {\n\t\tthis._service.send('PAUSE');\n\t};\n\n\tpublic unpause = () => {\n\t\tthis._service.send('UNPAUSE');\n\t};\n\n\tpublic extend = (value: number) => {\n\t\tconst event: TimerEvent = {\n\t\t\ttype: 'DURATION.UPDATE',\n\t\t\tvalue,\n\t\t};\n\t\tthis._service.send(event);\n\t};\n\n\tpublic kill = () => this._service.stop();\n\n\tprivate _onTimerUpdate = (state: State<TimerContext, TimerEvent>) => {\n\t\tconsole.log(state.event.type), state;\n\n\t\tif (state.value === Idle) {\n\t\t\tthis._onFinish();\n\t\t}\n\n\t\tif (state.event.type === 'TICK') {\n\t\t\tthis.tickCounter++;\n\t\t\t// Would be nice if timer kept track of tickCounter and it auto adjusted based on time\n\t\t\t// would be nice if there was a secondsRemaining prop on the timer.context\n\t\t\tthis.secondsRemaining =\n\t\t\t\tstate.context.duration - state.context.elapsed;\n\t\t\tthis._onTick();\n\t\t}\n\t};\n}\nexport { Timer };\n","import { inspect } from '@xstate/inspect';\nimport { Timer } from './XStateTimer'\ninspect({\n  // options\n  // url: 'https://statecharts.io/inspect', // (default)\n  iframe: false // open in new window\n});\n\nconst onTick = ()=>console.log('tick')\nconst onFinish = ()=>console.log('finish')\nconst timer = new Timer(10, onTick, onFinish)\n\n\n// old package.json scripts:\n// \"scripts\": {\n//     \"start:build\": \"tsc -w\",\n//     \"start:run\": \"nodemon build/index.js\",\n//     \"start\": \"concurrently npm:start:*\"\n//   },\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}